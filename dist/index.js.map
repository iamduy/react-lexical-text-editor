{"version":3,"sources":["../src/App.tsx","../src/context/SettingsContext.tsx","../src/appSettings.ts","../src/context/ToolbarContext.tsx","../src/ReactLexicalEditor.tsx","../src/plugins/DragDropPlugin.tsx","../src/plugins/ImagesPlugin/index.tsx","../src/utils/joinClasses.ts","../src/ui/Button.tsx","../src/ui/Dialog.tsx","../src/ui/FileInput.tsx","../src/ui/TextInput.tsx","../src/plugins/FloatingLinkEditorPlugin/index.tsx","../src/utils/getSelectedNode.ts","../src/utils/setFloatingElemPositionForLinkEditor.ts","../src/utils/url.ts","../src/plugins/InitialValuePlugin.tsx","../src/utils/htmlSerializer.ts","../src/plugins/TableActionMenuPlugin/index.tsx","../src/ui/DropDown.tsx","../src/utils/focusUtils.ts","../src/hooks/useModal.tsx","../src/ui/Modal.tsx","../src/ui/ColorPicker.tsx","../src/plugins/TableCellResizer/index.tsx","../src/plugins/ToolbarPlugin/index.tsx","../src/ui/DropdownColorPicker.tsx","../src/plugins/LayoutPlugin/InsertLayoutDialog.tsx","../src/plugins/LayoutPlugin/LayoutPlugin.tsx","../src/nodes/LayoutContainerNode.tsx","../src/nodes/LayoutItemNode.ts","../src/plugins/TablePlugin.tsx","../src/plugins/ToolbarPlugin/fontSize.tsx","../node_modules/@lexical/code/LexicalCode.node.mjs","../src/plugins/ToolbarPlugin/utils.ts","../src/ui/LoadingLayer.tsx","../src/nodes/PlaygroundNodes.ts","../node_modules/@lexical/mark/LexicalMark.node.mjs","../node_modules/@lexical/overflow/LexicalOverflow.node.mjs","../src/themes/PlaygroundEditorTheme.ts"],"sourcesContent":["import './App.css';\n\nimport { LexicalCollaboration } from '@lexical/react/LexicalCollaborationContext';\nimport { LexicalComposer } from '@lexical/react/LexicalComposer';\nimport { SettingsContext } from './context/SettingsContext';\nimport { SharedHistoryContext } from './context/SharedHistoryContext';\nimport { ToolbarContext } from './context/ToolbarContext';\nimport Editor from './ReactLexicalEditor';\nimport PlaygroundNodes from './nodes/PlaygroundNodes';\nimport { TableContext } from './plugins/TablePlugin';\nimport PlaygroundEditorTheme from './themes/PlaygroundEditorTheme';\nimport { ReactLexicalEditorProps } from './types';\n\nexport default function App(props: ReactLexicalEditorProps) {\n  const { disabled = false, ...rest } = props;\n\n  const initialConfig = {\n    namespace: 'ReactLexicalEditor',\n    theme: PlaygroundEditorTheme,\n    onError: (error: Error) => {\n      console.error(error);\n    },\n    nodes: PlaygroundNodes,\n    editable: !disabled,\n  };\n  return (\n    <LexicalCollaboration>\n      <SharedHistoryContext>\n        <SettingsContext>\n          <TableContext>\n            <ToolbarContext>\n              <LexicalComposer initialConfig={initialConfig}>\n                <Editor {...rest} />\n              </LexicalComposer>\n            </ToolbarContext>\n          </TableContext>\n        </SettingsContext>\n      </SharedHistoryContext>\n    </LexicalCollaboration>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport * as React from \"react\";\nimport { createContext, ReactNode, useCallback, useContext, useMemo, useState } from \"react\";\n\nimport { DEFAULT_SETTINGS, INITIAL_SETTINGS, SettingName } from \"../appSettings\";\n\ntype SettingsContextShape = {\n  setOption: (name: SettingName, value: boolean) => void;\n  settings: Record<SettingName, boolean>;\n};\n\nconst Context: React.Context<SettingsContextShape> = createContext({\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  setOption: (setting: SettingName, value: boolean) => {\n    return;\n  },\n  settings: INITIAL_SETTINGS,\n});\n\nexport const SettingsContext = ({ children }: { children: ReactNode }): JSX.Element => {\n  const [settings, setSettings] = useState<Record<SettingName, boolean>>(INITIAL_SETTINGS);\n\n  const setOption = useCallback((setting: SettingName, value: boolean) => {\n    setSettings((options) => ({\n      ...options,\n      [setting]: value,\n    }));\n    setURLParam(setting, value);\n  }, []);\n\n  const contextValue = useMemo(() => {\n    return { setOption, settings };\n  }, [setOption, settings]);\n\n  return <Context.Provider value={contextValue}>{children}</Context.Provider>;\n};\n\nexport const useSettings = (): SettingsContextShape => {\n  return useContext(Context);\n};\n\nfunction setURLParam(param: SettingName, value: null | boolean) {\n  const url = new URL(window.location.href);\n  const params = new URLSearchParams(url.search);\n  if (value !== DEFAULT_SETTINGS[param]) {\n    params.set(param, String(value));\n  } else {\n    params.delete(param);\n  }\n  url.search = params.toString();\n  window.history.pushState(null, \"\", url.toString());\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nexport const DEFAULT_SETTINGS = {\n  disableBeforeInput: false,\n  emptyEditor: false,\n  hasLinkAttributes: false,\n  hasNestedTables: false,\n  isAutocomplete: false,\n  isCharLimit: false,\n  isCharLimitUtf8: false,\n  isCodeHighlighted: true,\n  isCodeShiki: false,\n  isCollab: false,\n  isMaxLength: false,\n  isRichText: true,\n  listStrictIndent: false,\n  measureTypingPerf: false,\n  selectionAlwaysOnDisplay: false,\n  shouldAllowHighlightingWithBrackets: false,\n  shouldPreserveNewLinesInMarkdown: false,\n  shouldUseLexicalContextMenu: false,\n  showNestedEditorTreeView: false,\n  showTableOfContents: false,\n  showTreeView: true,\n  tableCellBackgroundColor: true,\n  tableCellMerge: true,\n  tableHorizontalScroll: true,\n  useCollabV2: false,\n} as const;\n\n// These are mutated in setupEnv\nexport const INITIAL_SETTINGS: Record<SettingName, boolean> = {\n  ...DEFAULT_SETTINGS,\n};\n\nexport type SettingName = keyof typeof DEFAULT_SETTINGS;\n\nexport type Settings = typeof INITIAL_SETTINGS;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport { ElementFormatType } from \"lexical\";\nimport React, {\n  createContext,\n  ReactNode,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from \"react\";\n\nexport const MIN_ALLOWED_FONT_SIZE = 8;\nexport const MAX_ALLOWED_FONT_SIZE = 72;\nexport const DEFAULT_FONT_SIZE = 15;\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst rootTypeToRootName = {\n  root: \"Root\",\n  table: \"Table\",\n};\n\nexport const blockTypeToBlockName = {\n  bullet: \"Bulleted List\",\n  check: \"Check List\",\n  code: \"Code Block\",\n  h1: \"Heading 1\",\n  h2: \"Heading 2\",\n  h3: \"Heading 3\",\n  h4: \"Heading 4\",\n  h5: \"Heading 5\",\n  h6: \"Heading 6\",\n  number: \"Numbered List\",\n  paragraph: \"Normal\",\n  quote: \"Quote\",\n};\n\nconst INITIAL_TOOLBAR_STATE = {\n  bgColor: \"#fff\",\n  blockType: \"paragraph\" as keyof typeof blockTypeToBlockName,\n  canRedo: false,\n  canUndo: false,\n  codeLanguage: \"\",\n  codeTheme: \"\",\n  elementFormat: \"left\" as ElementFormatType,\n  fontColor: \"#000\",\n  fontFamily: \"Arial\",\n  // Current font size in px\n  fontSize: `${DEFAULT_FONT_SIZE}px`,\n  // Font size input value - for controlled input\n  fontSizeInputValue: `${DEFAULT_FONT_SIZE}`,\n  isBold: false,\n  isCode: false,\n  isHighlight: false,\n  isImageCaption: false,\n  isItalic: false,\n  isLink: false,\n  isRTL: false,\n  isStrikethrough: false,\n  isSubscript: false,\n  isSuperscript: false,\n  isUnderline: false,\n  isLowercase: false,\n  isUppercase: false,\n  isCapitalize: false,\n  rootType: \"root\" as keyof typeof rootTypeToRootName,\n  listStartNumber: null as number | null,\n};\n\ntype ToolbarState = typeof INITIAL_TOOLBAR_STATE;\n\n// Utility type to get keys and infer value types\ntype ToolbarStateKey = keyof ToolbarState;\ntype ToolbarStateValue<Key extends ToolbarStateKey> = ToolbarState[Key];\n\ntype ContextShape = {\n  toolbarState: ToolbarState;\n  updateToolbarState<Key extends ToolbarStateKey>(key: Key, value: ToolbarStateValue<Key>): void;\n};\n\nconst Context = createContext<ContextShape | undefined>(undefined);\n\nexport const ToolbarContext = ({ children }: { children: ReactNode }): JSX.Element => {\n  const [toolbarState, setToolbarState] = useState(INITIAL_TOOLBAR_STATE);\n  const selectionFontSize = toolbarState.fontSize;\n\n  const updateToolbarState = useCallback(\n    <Key extends ToolbarStateKey>(key: Key, value: ToolbarStateValue<Key>) => {\n      setToolbarState((prev) => ({\n        ...prev,\n        [key]: value,\n      }));\n    },\n    []\n  );\n\n  useEffect(() => {\n    updateToolbarState(\"fontSizeInputValue\", selectionFontSize.slice(0, -2));\n  }, [selectionFontSize, updateToolbarState]);\n\n  const contextValue = useMemo(() => {\n    return {\n      toolbarState,\n      updateToolbarState,\n    };\n  }, [toolbarState, updateToolbarState]);\n\n  return <Context.Provider value={contextValue}>{children}</Context.Provider>;\n};\n\nexport const useToolbarState = () => {\n  const context = useContext(Context);\n\n  if (context === undefined) {\n    throw new Error(\"useToolbarState must be used within a ToolbarProvider\");\n  }\n\n  return context;\n};\n","'use client';\n\nimport { LexicalErrorBoundary } from '@lexical/react/LexicalErrorBoundary';\nimport { HistoryPlugin } from '@lexical/react/LexicalHistoryPlugin';\nimport { LinkPlugin } from '@lexical/react/LexicalLinkPlugin';\nimport { ListPlugin } from '@lexical/react/LexicalListPlugin';\nimport { OnChangePlugin } from '@lexical/react/LexicalOnChangePlugin';\nimport { RichTextPlugin } from '@lexical/react/LexicalRichTextPlugin';\nimport { TablePlugin } from '@lexical/react/LexicalTablePlugin';\nimport { memo, useState } from 'react';\n\nimport { useSettings } from './context/SettingsContext';\nimport { useSharedHistoryContext } from './context/SharedHistoryContext';\nimport DragDropPlugin from './plugins/DragDropPlugin';\nimport FloatingLinkEditorPlugin from './plugins/FloatingLinkEditorPlugin';\nimport ImagesPlugin from './plugins/ImagesPlugin';\nimport InitialValuePlugin from './plugins/InitialValuePlugin';\nimport TableActionMenuPlugin from './plugins/TableActionMenuPlugin';\nimport TableCellResizer from './plugins/TableCellResizer';\nimport ToolbarPlugin from './plugins/ToolbarPlugin';\nimport ContentEditable from './ui/ContentEditable';\nimport LoadingLayer from './ui/LoadingLayer';\nimport { lexicalToHtml } from './utils/htmlSerializer';\nimport { ReactLexicalEditorProps } from './types';\n\nconst Editor = ({\n  value,\n  onChange,\n  onUpload,\n  placeholder,\n  className,\n  loading,\n  style,\n}: ReactLexicalEditorProps) => {\n  const {\n    settings: { isRichText },\n  } = useSettings();\n  const { historyState } = useSharedHistoryContext();\n  const [floatingAnchorElem, setFloatingAnchorElem] =\n    useState<HTMLDivElement | null>(null);\n\n  const [isLinkEditMode, setIsLinkEditMode] = useState<boolean>(false);\n  const onRef = (_floatingAnchorElem: HTMLDivElement) => {\n    if (_floatingAnchorElem !== null) {\n      setFloatingAnchorElem(_floatingAnchorElem);\n    }\n  };\n\n  return (\n    <div className={`editor-shell ${className}`}>\n      {/* Loading overlay */}\n      {loading && <LoadingLayer />}\n\n      {isRichText && (\n        <ToolbarPlugin\n          setIsLinkEditMode={setIsLinkEditMode}\n          onUpload={onUpload}\n        />\n      )}\n      <div className='editor-container'>\n        <RichTextPlugin\n          contentEditable={\n            <div className='editor-scroller'>\n              <div className='editor' ref={onRef}>\n                <ContentEditable\n                  style={style}\n                  placeholder={placeholder || 'Enter text...'}\n                />\n              </div>\n            </div>\n          }\n          ErrorBoundary={LexicalErrorBoundary}\n        />\n        <HistoryPlugin externalHistoryState={historyState} />\n        <ListPlugin />\n        <LinkPlugin />\n        <TablePlugin />\n        <TableCellResizer />\n        {floatingAnchorElem && (\n          <>\n            <FloatingLinkEditorPlugin\n              anchorElem={floatingAnchorElem}\n              isLinkEditMode={isLinkEditMode}\n              setIsLinkEditMode={setIsLinkEditMode}\n            />\n            <TableActionMenuPlugin\n              anchorElem={floatingAnchorElem}\n              cellMerge={true}\n            />\n          </>\n        )}\n        <ImagesPlugin />\n        <DragDropPlugin onUpload={onUpload} />\n        <InitialValuePlugin value={value} />\n        <OnChangePlugin\n          onChange={(editorState, editor) => {\n            const html = lexicalToHtml(editor, editorState);\n            onChange?.(html);\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default memo(Editor);\n","import { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { COMMAND_PRIORITY_LOW, DRAGOVER_COMMAND, DROP_COMMAND } from \"lexical\";\nimport { JSX, useEffect } from \"react\";\nimport { INSERT_IMAGE_COMMAND } from \"./ImagesPlugin\";\n\nexport default function DragDropPastePlugin({\n  onUpload,\n}: {\n  onUpload?: (file: File) => Promise<string | undefined>;\n}): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    return editor.registerCommand(\n      DRAGOVER_COMMAND,\n      (event) => {\n        event.preventDefault();\n        return true;\n      },\n      COMMAND_PRIORITY_LOW\n    );\n  }, [editor]);\n\n  useEffect(() => {\n    return editor.registerCommand(\n      DROP_COMMAND,\n      (event) => {\n        event.preventDefault();\n        const files = event.dataTransfer?.files;\n        if (files && files.length > 0) {\n          const file = files[0];\n          if (file.type.startsWith(\"image/\")) {\n            onUpload?.(file).then((url) => {\n              if (url) {\n                editor.dispatchCommand(INSERT_IMAGE_COMMAND, {\n                  altText: file.name,\n                  src: url,\n                });\n              }\n            });\n          }\n        }\n        return true;\n      },\n      COMMAND_PRIORITY_LOW\n    );\n  }, [editor, onUpload]);\n\n  useEffect(() => {\n    const handlePaste = (event: ClipboardEvent) => {\n      const items = event.clipboardData?.items;\n      if (items) {\n        for (let i = 0; i < items.length; i++) {\n          if (items[i].type.indexOf(\"image\") !== -1) {\n            const file = items[i].getAsFile();\n            if (file) {\n              onUpload?.(file).then((url) => {\n                if (url) {\n                  editor.dispatchCommand(INSERT_IMAGE_COMMAND, {\n                    altText: file.name,\n                    src: url,\n                  });\n                }\n              });\n            }\n          }\n        }\n      }\n    };\n\n    return editor.registerRootListener((rootElement, prevRootElement) => {\n      if (prevRootElement) {\n        prevRootElement.removeEventListener(\"paste\", handlePaste);\n      }\n      if (rootElement) {\n        rootElement.addEventListener(\"paste\", handlePaste);\n      }\n    });\n  }, [editor, onUpload]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport { $isAutoLinkNode, $isLinkNode, LinkNode, TOGGLE_LINK_COMMAND } from \"@lexical/link\";\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { $findMatchingParent, $wrapNodeInElement, mergeRegister } from \"@lexical/utils\";\nimport {\n  $createParagraphNode,\n  $createRangeSelection,\n  $getSelection,\n  $insertNodes,\n  $isNodeSelection,\n  $isRootOrShadowRoot,\n  $setSelection,\n  COMMAND_PRIORITY_EDITOR,\n  COMMAND_PRIORITY_HIGH,\n  COMMAND_PRIORITY_LOW,\n  createCommand,\n  DRAGOVER_COMMAND,\n  DRAGSTART_COMMAND,\n  DROP_COMMAND,\n  getDOMSelectionFromTarget,\n  isHTMLElement,\n  LexicalCommand,\n  LexicalEditor,\n} from \"lexical\";\nimport { useEffect, useRef, useState } from \"react\";\nimport * as React from \"react\";\n\nimport { $createImageNode, $isImageNode, ImageNode, ImagePayload } from \"../../nodes/ImageNode\";\nimport Button from \"../../ui/Button\";\nimport { DialogActions, DialogButtonsList } from \"../../ui/Dialog\";\nimport FileInput from \"../../ui/FileInput\";\nimport TextInput from \"../../ui/TextInput\";\n\nexport type InsertImagePayload = Readonly<ImagePayload>;\n\nexport const INSERT_IMAGE_COMMAND: LexicalCommand<InsertImagePayload> =\n  createCommand(\"INSERT_IMAGE_COMMAND\");\n\nexport function InsertImageUriDialogBody({\n  onClick,\n}: {\n  onClick: (payload: InsertImagePayload) => void;\n}) {\n  const [src, setSrc] = useState(\"\");\n  const [altText, setAltText] = useState(\"\");\n\n  const isDisabled = src === \"\";\n\n  return (\n    <>\n      <TextInput\n        label=\"Image URL\"\n        placeholder=\"i.e. https://source.unsplash.com/random\"\n        onChange={setSrc}\n        value={src}\n        data-test-id=\"image-modal-url-input\"\n      />\n      <TextInput\n        label=\"Alt Text\"\n        placeholder=\"Random unsplash image\"\n        onChange={setAltText}\n        value={altText}\n        data-test-id=\"image-modal-alt-text-input\"\n      />\n      <DialogActions>\n        <Button\n          data-test-id=\"image-modal-confirm-btn\"\n          disabled={isDisabled}\n          onClick={() => onClick({ altText, src })}\n        >\n          Confirm\n        </Button>\n      </DialogActions>\n    </>\n  );\n}\n\nexport function InsertImageUploadedDialogBody({\n  onClick,\n  onUpload,\n}: {\n  onClick: (payload: InsertImagePayload) => void;\n  onUpload?: (file: File) => Promise<string | undefined>;\n}) {\n  const [src, setSrc] = useState(\"\");\n  const [altText, setAltText] = useState(\"\");\n  const [isUploading, setIsUploading] = useState(false);\n\n  const isDisabled = src === \"\" || isUploading;\n\n  const loadImage = (files: FileList | null) => {\n    if (files !== null && files.length > 0) {\n      setIsUploading(true);\n      onUpload?.(files[0])\n        .then((url) => {\n          if (url) {\n            setSrc(url);\n          }\n          setIsUploading(false);\n        })\n        .catch(() => {\n          setIsUploading(false);\n        });\n    }\n  };\n\n  return (\n    <>\n      <FileInput\n        label=\"Image Upload\"\n        onChange={loadImage}\n        accept=\"image/*\"\n        data-test-id=\"image-modal-file-upload\"\n        disabled={isUploading}\n      />\n      <TextInput\n        label=\"Alt Text\"\n        placeholder=\"Descriptive alternative text\"\n        onChange={setAltText}\n        value={altText}\n        data-test-id=\"image-modal-alt-text-input\"\n        disabled={isUploading}\n      />\n      <DialogActions>\n        <Button\n          data-test-id=\"image-modal-file-upload-btn\"\n          disabled={isDisabled}\n          onClick={() => {\n            onClick({ altText, src });\n          }}\n        >\n          Confirm\n        </Button>\n      </DialogActions>\n    </>\n  );\n}\n\nexport function InsertImageDialog({\n  activeEditor,\n  onClose,\n  onUpload,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n  onUpload?: (file: File) => Promise<string | undefined>;\n}): JSX.Element {\n  const [mode, setMode] = useState<null | \"url\" | \"file\">(null);\n  const hasModifier = useRef(false);\n\n  useEffect(() => {\n    hasModifier.current = false;\n    const handler = (e: KeyboardEvent) => {\n      hasModifier.current = e.altKey;\n    };\n    document.addEventListener(\"keydown\", handler);\n    return () => {\n      document.removeEventListener(\"keydown\", handler);\n    };\n  }, [activeEditor]);\n\n  const onClick = (payload: InsertImagePayload) => {\n    activeEditor.dispatchCommand(INSERT_IMAGE_COMMAND, payload);\n    onClose();\n  };\n\n  return (\n    <>\n      {!mode && (\n        <DialogButtonsList>\n          <Button data-test-id=\"image-modal-option-url\" onClick={() => setMode(\"url\")}>\n            URL\n          </Button>\n          <Button data-test-id=\"image-modal-option-file\" onClick={() => setMode(\"file\")}>\n            File\n          </Button>\n        </DialogButtonsList>\n      )}\n      {mode === \"url\" && <InsertImageUriDialogBody onClick={onClick} />}\n      {mode === \"file\" && <InsertImageUploadedDialogBody onClick={onClick} onUpload={onUpload} />}\n    </>\n  );\n}\n\nexport default function ImagesPlugin({\n  captionsEnabled,\n}: {\n  captionsEnabled?: boolean;\n}): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    if (!editor.hasNodes([ImageNode])) {\n      throw new Error(\"ImagesPlugin: ImageNode not registered on editor\");\n    }\n\n    return mergeRegister(\n      editor.registerCommand<InsertImagePayload>(\n        INSERT_IMAGE_COMMAND,\n        (payload) => {\n          const imageNode = $createImageNode(payload);\n          $insertNodes([imageNode]);\n          if ($isRootOrShadowRoot(imageNode.getParentOrThrow())) {\n            $wrapNodeInElement(imageNode, $createParagraphNode).selectEnd();\n          }\n\n          return true;\n        },\n        COMMAND_PRIORITY_EDITOR\n      ),\n      editor.registerCommand<DragEvent>(\n        DRAGSTART_COMMAND,\n        (event) => {\n          return $onDragStart(event);\n        },\n        COMMAND_PRIORITY_HIGH\n      ),\n      editor.registerCommand<DragEvent>(\n        DRAGOVER_COMMAND,\n        (event) => {\n          return $onDragover(event);\n        },\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand<DragEvent>(\n        DROP_COMMAND,\n        (event) => {\n          return $onDrop(event, editor);\n        },\n        COMMAND_PRIORITY_HIGH\n      )\n    );\n  }, [captionsEnabled, editor]);\n\n  return null;\n}\n\nconst TRANSPARENT_IMAGE =\n  \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";\n\nfunction $onDragStart(event: DragEvent): boolean {\n  const node = $getImageNodeInSelection();\n  if (!node) {\n    return false;\n  }\n  const dataTransfer = event.dataTransfer;\n  if (!dataTransfer) {\n    return false;\n  }\n  dataTransfer.setData(\"text/plain\", \"_\");\n  const img = document.createElement(\"img\");\n  img.src = TRANSPARENT_IMAGE;\n  dataTransfer.setDragImage(img, 0, 0);\n  dataTransfer.setData(\n    \"application/x-lexical-drag\",\n    JSON.stringify({\n      data: {\n        altText: node.__altText,\n        caption: node.__caption,\n        height: node.__height,\n        key: node.getKey(),\n        maxWidth: node.__maxWidth,\n        showCaption: node.__showCaption,\n        src: node.__src,\n        width: node.__width,\n      },\n      type: \"image\",\n    })\n  );\n\n  return true;\n}\n\nfunction $onDragover(event: DragEvent): boolean {\n  const node = $getImageNodeInSelection();\n  if (!node) {\n    return false;\n  }\n  if (!canDropImage(event)) {\n    event.preventDefault();\n  }\n  return false;\n}\n\nfunction $onDrop(event: DragEvent, editor: LexicalEditor): boolean {\n  const node = $getImageNodeInSelection();\n  if (!node) {\n    return false;\n  }\n  const data = getDragImageData(event);\n  if (!data) {\n    return false;\n  }\n  const existingLink = $findMatchingParent(\n    node,\n    (parent): parent is LinkNode => !$isAutoLinkNode(parent) && $isLinkNode(parent)\n  );\n  event.preventDefault();\n  if (canDropImage(event)) {\n    const range = getDragSelection(event);\n    node.remove();\n    const rangeSelection = $createRangeSelection();\n    if (range !== null && range !== undefined) {\n      rangeSelection.applyDOMRange(range);\n    }\n    $setSelection(rangeSelection);\n    editor.dispatchCommand(INSERT_IMAGE_COMMAND, data);\n    if (existingLink) {\n      editor.dispatchCommand(TOGGLE_LINK_COMMAND, existingLink.getURL());\n    }\n  }\n  return true;\n}\n\nfunction $getImageNodeInSelection(): ImageNode | null {\n  const selection = $getSelection();\n  if (!$isNodeSelection(selection)) {\n    return null;\n  }\n  const nodes = selection.getNodes();\n  const node = nodes[0];\n  return $isImageNode(node) ? node : null;\n}\n\nfunction getDragImageData(event: DragEvent): null | InsertImagePayload {\n  const dragData = event.dataTransfer?.getData(\"application/x-lexical-drag\");\n  if (!dragData) {\n    return null;\n  }\n  const { type, data } = JSON.parse(dragData);\n  if (type !== \"image\") {\n    return null;\n  }\n\n  return data;\n}\n\ndeclare global {\n  interface DragEvent {\n    rangeOffset?: number;\n    rangeParent?: Node;\n  }\n}\n\nfunction canDropImage(event: DragEvent): boolean {\n  const target = event.target;\n  return !!(\n    isHTMLElement(target) &&\n    !target.closest(\"code, span.editor-image\") &&\n    isHTMLElement(target.parentElement) &&\n    target.parentElement.closest(\"div.ContentEditable__root\")\n  );\n}\n\nfunction getDragSelection(event: DragEvent): Range | null | undefined {\n  let range;\n  const domSelection = getDOMSelectionFromTarget(event.target);\n  if (document.caretRangeFromPoint) {\n    range = document.caretRangeFromPoint(event.clientX, event.clientY);\n  } else if (event.rangeParent && domSelection !== null) {\n    domSelection.collapse(event.rangeParent, event.rangeOffset || 0);\n    range = domSelection.getRangeAt(0);\n  } else {\n    throw Error(`Cannot get the selection when dragging`);\n  }\n\n  return range;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nexport default function joinClasses(...args: Array<string | boolean | null | undefined>) {\n  return args.filter(Boolean).join(\" \");\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport \"./Button.css\";\n\nimport * as React from \"react\";\nimport { ReactNode } from \"react\";\n\nimport joinClasses from \"../utils/joinClasses\";\n\nexport default function Button({\n  \"data-test-id\": dataTestId,\n  children,\n  className,\n  onClick,\n  disabled,\n  small,\n  title,\n}: {\n  \"data-test-id\"?: string;\n  children: ReactNode;\n  className?: string;\n  disabled?: boolean;\n  onClick: () => void;\n  small?: boolean;\n  title?: string;\n}): JSX.Element {\n  return (\n    <button\n      disabled={disabled}\n      className={joinClasses(\n        \"Button__root\",\n        disabled && \"Button__disabled\",\n        small && \"Button__small\",\n        className\n      )}\n      onClick={onClick}\n      title={title}\n      aria-label={title}\n      {...(dataTestId && { \"data-test-id\": dataTestId })}\n    >\n      {children}\n    </button>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport \"./Dialog.css\";\n\nimport * as React from \"react\";\nimport { ReactNode } from \"react\";\n\ntype Props = Readonly<{\n  \"data-test-id\"?: string;\n  children: ReactNode;\n}>;\n\nexport function DialogButtonsList({ children }: Props): JSX.Element {\n  return <div className=\"DialogButtonsList\">{children}</div>;\n}\n\nexport function DialogActions({ \"data-test-id\": dataTestId, children }: Props): JSX.Element {\n  return (\n    <div className=\"DialogActions\" data-test-id={dataTestId}>\n      {children}\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport \"./Input.css\";\n\nimport * as React from \"react\";\n\ntype Props = Readonly<{\n  \"data-test-id\"?: string;\n  accept?: string;\n  label: string;\n  onChange: (files: FileList | null) => void;\n  disabled?: boolean;\n}>;\n\nexport default function FileInput({\n  accept,\n  label,\n  onChange,\n  \"data-test-id\": dataTestId,\n  disabled,\n}: Props): JSX.Element {\n  return (\n    <div className=\"Input__wrapper\">\n      <label className=\"Input__label\">{label}</label>\n      <input\n        type=\"file\"\n        accept={accept}\n        className=\"Input__input\"\n        onChange={(e) => onChange(e.target.files)}\n        data-test-id={dataTestId}\n        disabled={disabled}\n      />\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport \"./Input.css\";\n\nimport * as React from \"react\";\nimport { HTMLInputTypeAttribute } from \"react\";\n\ntype Props = Readonly<{\n  \"data-test-id\"?: string;\n  label: string;\n  onChange: (val: string) => void;\n  placeholder?: string;\n  value: string;\n  type?: HTMLInputTypeAttribute;\n  disabled?: boolean;\n}>;\n\nexport default function TextInput({\n  label,\n  value,\n  onChange,\n  placeholder = \"\",\n  \"data-test-id\": dataTestId,\n  type = \"text\",\n  disabled,\n}: Props): JSX.Element {\n  return (\n    <div className=\"Input__wrapper\">\n      <label className=\"Input__label\">{label}</label>\n      <input\n        type={type}\n        className=\"Input__input\"\n        placeholder={placeholder}\n        value={value}\n        onChange={(e) => {\n          onChange(e.target.value);\n        }}\n        data-test-id={dataTestId}\n        disabled={disabled}\n      />\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport type { JSX } from \"react\";\n\nimport \"./index.css\";\n\nimport { $createLinkNode, $isAutoLinkNode, $isLinkNode, TOGGLE_LINK_COMMAND } from \"@lexical/link\";\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { $findMatchingParent, mergeRegister } from \"@lexical/utils\";\nimport {\n  $getSelection,\n  $isLineBreakNode,\n  $isNodeSelection,\n  $isRangeSelection,\n  BaseSelection,\n  CLICK_COMMAND,\n  COMMAND_PRIORITY_CRITICAL,\n  COMMAND_PRIORITY_HIGH,\n  COMMAND_PRIORITY_LOW,\n  getDOMSelection,\n  KEY_ESCAPE_COMMAND,\n  LexicalEditor,\n  SELECTION_CHANGE_COMMAND,\n} from \"lexical\";\nimport { Dispatch, useCallback, useEffect, useRef, useState } from \"react\";\nimport * as React from \"react\";\nimport { createPortal } from \"react-dom\";\n\nimport { getSelectedNode } from \"../../utils/getSelectedNode\";\nimport { setFloatingElemPositionForLinkEditor } from \"../../utils/setFloatingElemPositionForLinkEditor\";\nimport { sanitizeUrl } from \"../../utils/url\";\n\nfunction preventDefault(\n  event: React.KeyboardEvent<HTMLInputElement> | React.MouseEvent<HTMLElement>\n): void {\n  event.preventDefault();\n}\n\nfunction FloatingLinkEditor({\n  editor,\n  isLink,\n  setIsLink,\n  anchorElem,\n  isLinkEditMode,\n  setIsLinkEditMode,\n}: {\n  editor: LexicalEditor;\n  isLink: boolean;\n  setIsLink: Dispatch<boolean>;\n  anchorElem: HTMLElement;\n  isLinkEditMode: boolean;\n  setIsLinkEditMode: Dispatch<boolean>;\n}): JSX.Element {\n  const editorRef = useRef<HTMLDivElement | null>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const [linkUrl, setLinkUrl] = useState(\"\");\n  const [editedLinkUrl, setEditedLinkUrl] = useState(\"https://\");\n  const [lastSelection, setLastSelection] = useState<BaseSelection | null>(null);\n\n  const $updateLinkEditor = useCallback(() => {\n    const selection = $getSelection();\n    if ($isRangeSelection(selection)) {\n      const node = getSelectedNode(selection);\n      const linkParent = $findMatchingParent(node, $isLinkNode);\n\n      if (linkParent) {\n        setLinkUrl(linkParent.getURL());\n      } else if ($isLinkNode(node)) {\n        setLinkUrl(node.getURL());\n      } else {\n        setLinkUrl(\"\");\n      }\n      if (isLinkEditMode) {\n        setEditedLinkUrl(linkUrl);\n      }\n    } else if ($isNodeSelection(selection)) {\n      const nodes = selection.getNodes();\n      if (nodes.length > 0) {\n        const node = nodes[0];\n        const parent = node.getParent();\n        if ($isLinkNode(parent)) {\n          setLinkUrl(parent.getURL());\n        } else if ($isLinkNode(node)) {\n          setLinkUrl(node.getURL());\n        } else {\n          setLinkUrl(\"\");\n        }\n        if (isLinkEditMode) {\n          setEditedLinkUrl(linkUrl);\n        }\n      }\n    }\n\n    const editorElem = editorRef.current;\n    const nativeSelection = getDOMSelection(editor._window);\n    const activeElement = document.activeElement;\n\n    if (editorElem === null) {\n      return;\n    }\n\n    const rootElement = editor.getRootElement();\n\n    if (selection !== null && rootElement !== null && editor.isEditable()) {\n      let domRect: DOMRect | undefined;\n\n      if ($isNodeSelection(selection)) {\n        const nodes = selection.getNodes();\n        if (nodes.length > 0) {\n          const element = editor.getElementByKey(nodes[0].getKey());\n          if (element) {\n            domRect = element.getBoundingClientRect();\n          }\n        }\n      } else if (nativeSelection !== null && rootElement.contains(nativeSelection.anchorNode)) {\n        domRect = nativeSelection.focusNode?.parentElement?.getBoundingClientRect();\n      }\n\n      if (domRect) {\n        domRect.y += 40;\n        setFloatingElemPositionForLinkEditor(domRect, editorElem, anchorElem);\n      }\n      setLastSelection(selection);\n    } else if (!activeElement || activeElement.className !== \"link-input\") {\n      if (rootElement !== null) {\n        setFloatingElemPositionForLinkEditor(null, editorElem, anchorElem);\n      }\n      setLastSelection(null);\n      setIsLinkEditMode(false);\n      setLinkUrl(\"\");\n    }\n\n    return true;\n  }, [anchorElem, editor, setIsLinkEditMode, isLinkEditMode, linkUrl]);\n\n  useEffect(() => {\n    const scrollerElem = anchorElem.parentElement;\n\n    const update = () => {\n      editor.getEditorState().read(() => {\n        $updateLinkEditor();\n      });\n    };\n\n    window.addEventListener(\"resize\", update);\n\n    if (scrollerElem) {\n      scrollerElem.addEventListener(\"scroll\", update);\n    }\n\n    return () => {\n      window.removeEventListener(\"resize\", update);\n\n      if (scrollerElem) {\n        scrollerElem.removeEventListener(\"scroll\", update);\n      }\n    };\n  }, [anchorElem.parentElement, editor, $updateLinkEditor]);\n\n  useEffect(() => {\n    return mergeRegister(\n      editor.registerUpdateListener(({ editorState }) => {\n        editorState.read(() => {\n          $updateLinkEditor();\n        });\n      }),\n\n      editor.registerCommand(\n        SELECTION_CHANGE_COMMAND,\n        () => {\n          $updateLinkEditor();\n          return true;\n        },\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand(\n        KEY_ESCAPE_COMMAND,\n        () => {\n          if (isLink) {\n            setIsLink(false);\n            return true;\n          }\n          return false;\n        },\n        COMMAND_PRIORITY_HIGH\n      )\n    );\n  }, [editor, $updateLinkEditor, setIsLink, isLink]);\n\n  useEffect(() => {\n    editor.getEditorState().read(() => {\n      $updateLinkEditor();\n    });\n  }, [editor, $updateLinkEditor]);\n\n  useEffect(() => {\n    if (isLinkEditMode && inputRef.current) {\n      inputRef.current.focus();\n    }\n  }, [isLinkEditMode, isLink]);\n\n  useEffect(() => {\n    const editorElement = editorRef.current;\n    if (editorElement === null) {\n      return;\n    }\n    const handleBlur = (event: FocusEvent) => {\n      if (!editorElement.contains(event.relatedTarget as Element) && isLink) {\n        setIsLink(false);\n        setIsLinkEditMode(false);\n      }\n    };\n    editorElement.addEventListener(\"focusout\", handleBlur);\n    return () => {\n      editorElement.removeEventListener(\"focusout\", handleBlur);\n    };\n  }, [editorRef, setIsLink, setIsLinkEditMode, isLink]);\n\n  const monitorInputInteraction = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.key === \"Enter\") {\n      handleLinkSubmission(event);\n    } else if (event.key === \"Escape\") {\n      event.preventDefault();\n      setIsLinkEditMode(false);\n    }\n  };\n\n  const handleLinkSubmission = (\n    event: React.KeyboardEvent<HTMLInputElement> | React.MouseEvent<HTMLElement>\n  ) => {\n    event.preventDefault();\n    if (lastSelection !== null) {\n      if (linkUrl !== \"\") {\n        editor.update(() => {\n          editor.dispatchCommand(TOGGLE_LINK_COMMAND, sanitizeUrl(editedLinkUrl));\n          const selection = $getSelection();\n          if ($isRangeSelection(selection)) {\n            const parent = getSelectedNode(selection).getParent();\n            if ($isAutoLinkNode(parent)) {\n              const linkNode = $createLinkNode(parent.getURL(), {\n                rel: parent.__rel,\n                target: parent.__target,\n                title: parent.__title,\n              });\n              parent.replace(linkNode, true);\n            }\n          }\n        });\n      }\n      setEditedLinkUrl(\"https://\");\n      setIsLinkEditMode(false);\n    }\n  };\n\n  return (\n    <div ref={editorRef} className=\"link-editor\">\n      {!isLink ? null : isLinkEditMode ? (\n        <>\n          <input\n            ref={inputRef}\n            className=\"link-input\"\n            value={editedLinkUrl}\n            onChange={(event) => {\n              setEditedLinkUrl(event.target.value);\n            }}\n            onKeyDown={(event) => {\n              monitorInputInteraction(event);\n            }}\n          />\n          <div>\n            <div\n              className=\"link-cancel\"\n              role=\"button\"\n              tabIndex={0}\n              onMouseDown={preventDefault}\n              onClick={() => {\n                setIsLinkEditMode(false);\n              }}\n            />\n\n            <div\n              className=\"link-confirm\"\n              role=\"button\"\n              tabIndex={0}\n              onMouseDown={preventDefault}\n              onClick={handleLinkSubmission}\n            />\n          </div>\n        </>\n      ) : (\n        <div className=\"link-view\">\n          <a href={sanitizeUrl(linkUrl)} target=\"_blank\" rel=\"noopener noreferrer\">\n            {linkUrl}\n          </a>\n          <div\n            className=\"link-edit\"\n            role=\"button\"\n            tabIndex={0}\n            onMouseDown={preventDefault}\n            onClick={(event) => {\n              event.preventDefault();\n              setEditedLinkUrl(linkUrl);\n              setIsLinkEditMode(true);\n            }}\n          />\n          <div\n            className=\"link-trash\"\n            role=\"button\"\n            tabIndex={0}\n            onMouseDown={preventDefault}\n            onClick={() => {\n              editor.dispatchCommand(TOGGLE_LINK_COMMAND, null);\n            }}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction useFloatingLinkEditorToolbar(\n  editor: LexicalEditor,\n  anchorElem: HTMLElement,\n  isLinkEditMode: boolean,\n  setIsLinkEditMode: Dispatch<boolean>\n): JSX.Element | null {\n  const [activeEditor, setActiveEditor] = useState(editor);\n  const [isLink, setIsLink] = useState(false);\n\n  useEffect(() => {\n    function $updateToolbar() {\n      const selection = $getSelection();\n      if ($isRangeSelection(selection)) {\n        const focusNode = getSelectedNode(selection);\n        const focusLinkNode = $findMatchingParent(focusNode, $isLinkNode);\n        const focusAutoLinkNode = $findMatchingParent(focusNode, $isAutoLinkNode);\n        if (!(focusLinkNode || focusAutoLinkNode)) {\n          setIsLink(false);\n          return;\n        }\n        const badNode = selection\n          .getNodes()\n          .filter((node) => !$isLineBreakNode(node))\n          .find((node) => {\n            const linkNode = $findMatchingParent(node, $isLinkNode);\n            const autoLinkNode = $findMatchingParent(node, $isAutoLinkNode);\n            return (\n              (focusLinkNode && !focusLinkNode.is(linkNode)) ||\n              (linkNode && !linkNode.is(focusLinkNode)) ||\n              (focusAutoLinkNode && !focusAutoLinkNode.is(autoLinkNode)) ||\n              (autoLinkNode &&\n                (!autoLinkNode.is(focusAutoLinkNode) || autoLinkNode.getIsUnlinked()))\n            );\n          });\n        if (!badNode) {\n          setIsLink(true);\n        } else {\n          setIsLink(false);\n        }\n      } else if ($isNodeSelection(selection)) {\n        const nodes = selection.getNodes();\n        if (nodes.length === 0) {\n          setIsLink(false);\n          return;\n        }\n        const node = nodes[0];\n        const parent = node.getParent();\n        if ($isLinkNode(parent) || $isLinkNode(node)) {\n          setIsLink(true);\n        } else {\n          setIsLink(false);\n        }\n      }\n    }\n    return mergeRegister(\n      editor.registerUpdateListener(({ editorState }) => {\n        editorState.read(() => {\n          $updateToolbar();\n        });\n      }),\n      editor.registerCommand(\n        SELECTION_CHANGE_COMMAND,\n        (_payload, newEditor) => {\n          $updateToolbar();\n          setActiveEditor(newEditor);\n          return false;\n        },\n        COMMAND_PRIORITY_CRITICAL\n      ),\n      editor.registerCommand(\n        CLICK_COMMAND,\n        (payload) => {\n          const selection = $getSelection();\n          if ($isRangeSelection(selection)) {\n            const node = getSelectedNode(selection);\n            const linkNode = $findMatchingParent(node, $isLinkNode);\n            if ($isLinkNode(linkNode) && (payload.metaKey || payload.ctrlKey)) {\n              window.open(linkNode.getURL(), \"_blank\");\n              return true;\n            }\n          }\n          return false;\n        },\n        COMMAND_PRIORITY_LOW\n      )\n    );\n  }, [editor]);\n\n  return createPortal(\n    <FloatingLinkEditor\n      editor={activeEditor}\n      isLink={isLink}\n      anchorElem={anchorElem}\n      setIsLink={setIsLink}\n      isLinkEditMode={isLinkEditMode}\n      setIsLinkEditMode={setIsLinkEditMode}\n    />,\n    anchorElem\n  );\n}\n\nexport default function FloatingLinkEditorPlugin({\n  anchorElem = document.body,\n  isLinkEditMode,\n  setIsLinkEditMode,\n}: {\n  anchorElem?: HTMLElement;\n  isLinkEditMode: boolean;\n  setIsLinkEditMode: Dispatch<boolean>;\n}): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n  return useFloatingLinkEditorToolbar(editor, anchorElem, isLinkEditMode, setIsLinkEditMode);\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport { $isAtNodeEnd } from \"@lexical/selection\";\nimport { ElementNode, RangeSelection, TextNode } from \"lexical\";\n\nexport function getSelectedNode(selection: RangeSelection): TextNode | ElementNode {\n  const anchor = selection.anchor;\n  const focus = selection.focus;\n  const anchorNode = selection.anchor.getNode();\n  const focusNode = selection.focus.getNode();\n  if (anchorNode === focusNode) {\n    return anchorNode;\n  }\n  const isBackward = selection.isBackward();\n  if (isBackward) {\n    return $isAtNodeEnd(focus) ? anchorNode : focusNode;\n  } else {\n    return $isAtNodeEnd(anchor) ? anchorNode : focusNode;\n  }\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nconst VERTICAL_GAP = 10;\nconst HORIZONTAL_OFFSET = 5;\n\nexport function setFloatingElemPositionForLinkEditor(\n  targetRect: DOMRect | null,\n  floatingElem: HTMLElement,\n  anchorElem: HTMLElement,\n  verticalGap: number = VERTICAL_GAP,\n  horizontalOffset: number = HORIZONTAL_OFFSET\n): void {\n  const scrollerElem = anchorElem.parentElement;\n\n  if (targetRect === null || !scrollerElem) {\n    floatingElem.style.opacity = \"0\";\n    floatingElem.style.transform = \"translate(-10000px, -10000px)\";\n    return;\n  }\n\n  const floatingElemRect = floatingElem.getBoundingClientRect();\n  const anchorElementRect = anchorElem.getBoundingClientRect();\n  const editorScrollerRect = scrollerElem.getBoundingClientRect();\n\n  let top = targetRect.top - verticalGap;\n  let left = targetRect.left - horizontalOffset;\n\n  if (top < editorScrollerRect.top) {\n    top += floatingElemRect.height + targetRect.height + verticalGap * 2;\n  }\n\n  if (left + floatingElemRect.width > editorScrollerRect.right) {\n    left = editorScrollerRect.right - floatingElemRect.width - horizontalOffset;\n  }\n\n  top -= anchorElementRect.top;\n  left -= anchorElementRect.left;\n\n  floatingElem.style.opacity = \"1\";\n  floatingElem.style.transform = `translate(${left}px, ${top}px)`;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nconst SUPPORTED_URL_PROTOCOLS = new Set([\"http:\", \"https:\", \"mailto:\", \"sms:\", \"tel:\"]);\n\nexport function sanitizeUrl(url: string): string {\n  try {\n    const parsedUrl = new URL(url);\n\n    if (!SUPPORTED_URL_PROTOCOLS.has(parsedUrl.protocol)) {\n      return \"about:blank\";\n    }\n  } catch {\n    return url;\n  }\n  return url;\n}\n\n// Source: https://stackoverflow.com/a/8234912/2013580\nconst urlRegExp = new RegExp(\n  /((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[-;:&=+$,\\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=+$,\\w]+@)[A-Za-z0-9.-]+)((?:\\/[+~%/.\\w-_]*)?\\??(?:[-+=&;%@.\\w_]*)#?(?:[\\w]*))?)/\n);\nexport function validateUrl(url: string): boolean {\n  // TODO Fix UI for link insertion; it should never default to an invalid URL such as https://.\n  // Maybe show a dialog where they user can type the URL before inserting it.\n  return url === \"https://\" || urlRegExp.test(url);\n}\n","import { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { useEffect, useState } from \"react\";\nimport { htmlToLexical } from \"../utils\";\n\n// Plugin để đồng bộ value từ ngoài vào editor (Initial load)\nexport default function InitialValuePlugin({ value }: { value?: string }) {\n  const [editor] = useLexicalComposerContext();\n  const [isFirstRender, setIsFirstRender] = useState(true);\n\n  useEffect(() => {\n    if (isFirstRender && value) {\n      htmlToLexical(editor, value);\n      setIsFirstRender(false);\n    }\n  }, [editor, value, isFirstRender]);\n\n  return null;\n}\n","import { $generateHtmlFromNodes, $generateNodesFromDOM } from \"@lexical/html\";\nimport { $getRoot, type EditorState, type LexicalEditor } from \"lexical\";\n\n/**\n * Chuyển đổi Lexical Editor State sang HTML string\n */\nexport const lexicalToHtml = (editor: LexicalEditor, editorState: EditorState): string => {\n  let html = \"\";\n  editorState.read(() => {\n    html = $generateHtmlFromNodes(editor, null);\n  });\n\n  // Xử lý trường hợp empty content để đồng nhất với Quill (<p><br></p>)\n  if (\n    html === '<p class=\"editor-paragraph\"><br></p>' ||\n    html === '<p class=\"editor-paragraph\"></p>'\n  ) {\n    return \"\";\n  }\n\n  return html;\n};\n\n/**\n * Chuyển đổi HTML string sang Lexical nodes và chèn vào editor\n */\nexport const htmlToLexical = (editor: LexicalEditor, html: string) => {\n  editor.update(() => {\n    const parser = new DOMParser();\n    const dom = parser.parseFromString(html || \"\", \"text/html\");\n    const nodes = $generateNodesFromDOM(editor, dom);\n\n    const root = $getRoot();\n    root.clear();\n    root.append(...nodes);\n  });\n};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { ElementNode, LexicalEditor } from \"lexical\";\nimport type { JSX } from \"react\";\n\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { useLexicalEditable } from \"@lexical/react/useLexicalEditable\";\nimport {\n  $computeTableMapSkipCellCheck,\n  $deleteTableColumnAtSelection,\n  $deleteTableRowAtSelection,\n  $getNodeTriplet,\n  $getTableCellNodeFromLexicalNode,\n  $getTableColumnIndexFromTableCellNode,\n  $getTableNodeFromLexicalNodeOrThrow,\n  $getTableRowIndexFromTableCellNode,\n  $insertTableColumnAtSelection,\n  $insertTableRowAtSelection,\n  $isTableCellNode,\n  $isTableSelection,\n  $mergeCells,\n  $unmergeCell,\n  getTableElement,\n  getTableObserverFromTableElement,\n  TableCellHeaderStates,\n  TableCellNode,\n  TableObserver,\n  TableSelection,\n} from \"@lexical/table\";\nimport { mergeRegister } from \"@lexical/utils\";\nimport {\n  $getSelection,\n  $isElementNode,\n  $isRangeSelection,\n  $isTextNode,\n  $setSelection,\n  COMMAND_PRIORITY_CRITICAL,\n  getDOMSelection,\n  isDOMNode,\n  SELECTION_CHANGE_COMMAND,\n} from \"lexical\";\nimport * as React from \"react\";\nimport { ReactPortal, useCallback, useEffect, useRef, useState } from \"react\";\nimport { createPortal } from \"react-dom\";\n\nimport DropDown, { DropDownItem } from \"../../ui/DropDown\";\nimport useModal from \"../../hooks/useModal\";\nimport ColorPicker from \"../../ui/ColorPicker\";\n\nfunction computeSelectionCount(selection: TableSelection): {\n  columns: number;\n  rows: number;\n} {\n  const selectionShape = selection.getShape();\n  return {\n    columns: selectionShape.toX - selectionShape.fromX + 1,\n    rows: selectionShape.toY - selectionShape.fromY + 1,\n  };\n}\n\nfunction $canUnmerge(): boolean {\n  const selection = $getSelection();\n  if (\n    ($isRangeSelection(selection) && !selection.isCollapsed()) ||\n    ($isTableSelection(selection) && !selection.anchor.is(selection.focus)) ||\n    (!$isRangeSelection(selection) && !$isTableSelection(selection))\n  ) {\n    return false;\n  }\n  const [cell] = $getNodeTriplet(selection.anchor);\n  return cell.__colSpan > 1 || cell.__rowSpan > 1;\n}\n\nfunction $selectLastDescendant(node: ElementNode): void {\n  const lastDescendant = node.getLastDescendant();\n  if ($isTextNode(lastDescendant)) {\n    lastDescendant.select();\n  } else if ($isElementNode(lastDescendant)) {\n    lastDescendant.selectEnd();\n  } else if (lastDescendant !== null) {\n    lastDescendant.selectNext();\n  }\n}\n\nfunction currentCellBackgroundColor(editor: LexicalEditor): null | string {\n  return editor.getEditorState().read(() => {\n    const selection = $getSelection();\n    if ($isRangeSelection(selection) || $isTableSelection(selection)) {\n      const [cell] = $getNodeTriplet(selection.anchor);\n      if ($isTableCellNode(cell)) {\n        return cell.getBackgroundColor();\n      }\n    }\n    return null;\n  });\n}\n\ntype TableCellActionMenuProps = Readonly<{\n  contextRef: { current: null | HTMLElement };\n  onClose: () => void;\n  setIsMenuOpen: (isOpen: boolean) => void;\n  showColorPickerModal: (title: string, showModal: (onClose: () => void) => JSX.Element) => void;\n  tableCellNode: TableCellNode;\n  cellMerge: boolean;\n}>;\n\nfunction TableActionMenu({\n  onClose,\n  tableCellNode: _tableCellNode,\n  setIsMenuOpen,\n  contextRef,\n  cellMerge,\n  showColorPickerModal,\n}: TableCellActionMenuProps) {\n  const [editor] = useLexicalComposerContext();\n  const dropDownRef = useRef<HTMLDivElement | null>(null);\n  const [tableCellNode, updateTableCellNode] = useState(_tableCellNode);\n  const [selectionCounts, updateSelectionCounts] = useState({\n    columns: 1,\n    rows: 1,\n  });\n  const [canMergeCells, setCanMergeCells] = useState(false);\n  const [canUnmergeCell, setCanUnmergeCell] = useState(false);\n  const [backgroundColor, setBackgroundColor] = useState(\n    () => currentCellBackgroundColor(editor) || \"\"\n  );\n\n  useEffect(() => {\n    return editor.registerMutationListener(\n      TableCellNode,\n      (nodeMutations) => {\n        const nodeUpdated = nodeMutations.get(tableCellNode.getKey()) === \"updated\";\n\n        if (nodeUpdated) {\n          editor.getEditorState().read(() => {\n            updateTableCellNode(tableCellNode.getLatest());\n          });\n          setBackgroundColor(currentCellBackgroundColor(editor) || \"\");\n        }\n      },\n      { skipInitialization: true }\n    );\n  }, [editor, tableCellNode]);\n\n  useEffect(() => {\n    editor.getEditorState().read(() => {\n      const selection = $getSelection();\n      // Merge cells\n      if ($isTableSelection(selection)) {\n        const currentSelectionCounts = computeSelectionCount(selection);\n        updateSelectionCounts(computeSelectionCount(selection));\n        setCanMergeCells(currentSelectionCounts.columns > 1 || currentSelectionCounts.rows > 1);\n      }\n      // Unmerge cell\n      setCanUnmergeCell($canUnmerge());\n    });\n  }, [editor]);\n\n  useEffect(() => {\n    const menuButtonElement = contextRef.current;\n    const dropDownElement = dropDownRef.current;\n    const rootElement = editor.getRootElement();\n\n    if (menuButtonElement != null && dropDownElement != null && rootElement != null) {\n      const rootEleRect = rootElement.getBoundingClientRect();\n      const menuButtonRect = menuButtonElement.getBoundingClientRect();\n      dropDownElement.style.opacity = \"1\";\n      const dropDownElementRect = dropDownElement.getBoundingClientRect();\n      const margin = 5;\n      let leftPosition = menuButtonRect.right + margin;\n      if (\n        leftPosition + dropDownElementRect.width > window.innerWidth ||\n        leftPosition + dropDownElementRect.width > rootEleRect.right\n      ) {\n        const position = menuButtonRect.left - dropDownElementRect.width - margin;\n        leftPosition = (position < 0 ? margin : position) + window.pageXOffset;\n      }\n      dropDownElement.style.left = `${leftPosition + window.pageXOffset}px`;\n\n      let topPosition = menuButtonRect.top;\n      if (topPosition + dropDownElementRect.height > window.innerHeight) {\n        const position = menuButtonRect.bottom - dropDownElementRect.height;\n        topPosition = position < 0 ? margin : position;\n      }\n      dropDownElement.style.top = `${topPosition}px`;\n    }\n  }, [contextRef, dropDownRef, editor]);\n\n  useEffect(() => {\n    function handleClickOutside(event: MouseEvent) {\n      if (\n        dropDownRef.current != null &&\n        contextRef.current != null &&\n        isDOMNode(event.target) &&\n        !dropDownRef.current.contains(event.target) &&\n        !contextRef.current.contains(event.target)\n      ) {\n        setIsMenuOpen(false);\n      }\n    }\n\n    window.addEventListener(\"click\", handleClickOutside);\n\n    return () => window.removeEventListener(\"click\", handleClickOutside);\n  }, [setIsMenuOpen, contextRef]);\n\n  const clearTableSelection = useCallback(() => {\n    editor.update(() => {\n      if (tableCellNode.isAttached()) {\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n        const tableElement = getTableElement(tableNode, editor.getElementByKey(tableNode.getKey()));\n\n        if (tableElement === null) {\n          throw new Error(\"TableActionMenu: Expected to find tableElement in DOM\");\n        }\n\n        const tableObserver = getTableObserverFromTableElement(tableElement);\n        if (tableObserver !== null) {\n          tableObserver.$clearHighlight();\n        }\n\n        tableNode.markDirty();\n        updateTableCellNode(tableCellNode.getLatest());\n      }\n      $setSelection(null);\n    });\n  }, [editor, tableCellNode]);\n\n  const mergeTableCellsAtSelection = () => {\n    editor.update(() => {\n      const selection = $getSelection();\n      if (!$isTableSelection(selection)) {\n        return;\n      }\n\n      const nodes = selection.getNodes();\n      const tableCells = nodes.filter($isTableCellNode);\n      const targetCell = $mergeCells(tableCells);\n\n      if (targetCell) {\n        $selectLastDescendant(targetCell);\n        onClose();\n      }\n    });\n  };\n\n  const unmergeTableCellsAtSelection = () => {\n    editor.update(() => {\n      $unmergeCell();\n    });\n  };\n\n  const insertTableRowAtSelection = useCallback(\n    (shouldInsertAfter: boolean) => {\n      editor.update(() => {\n        for (let i = 0; i < selectionCounts.rows; i++) {\n          $insertTableRowAtSelection(shouldInsertAfter);\n        }\n        onClose();\n      });\n    },\n    [editor, onClose, selectionCounts.rows]\n  );\n\n  const insertTableColumnAtSelection = useCallback(\n    (shouldInsertAfter: boolean) => {\n      editor.update(() => {\n        for (let i = 0; i < selectionCounts.columns; i++) {\n          $insertTableColumnAtSelection(shouldInsertAfter);\n        }\n        onClose();\n      });\n    },\n    [editor, onClose, selectionCounts.columns]\n  );\n\n  const deleteTableRowAtSelection = useCallback(() => {\n    editor.update(() => {\n      $deleteTableRowAtSelection();\n      onClose();\n    });\n  }, [editor, onClose]);\n\n  const deleteTableAtSelection = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n      tableNode.remove();\n\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const deleteTableColumnAtSelection = useCallback(() => {\n    editor.update(() => {\n      $deleteTableColumnAtSelection();\n      onClose();\n    });\n  }, [editor, onClose]);\n\n  const toggleTableRowIsHeader = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n      const tableRowIndex = $getTableRowIndexFromTableCellNode(tableCellNode);\n\n      const [gridMap] = $computeTableMapSkipCellCheck(tableNode, null, null);\n\n      const rowCells = new Set<TableCellNode>();\n\n      const newStyle = tableCellNode.getHeaderStyles() ^ TableCellHeaderStates.ROW;\n\n      for (let col = 0; col < gridMap[tableRowIndex].length; col++) {\n        const mapCell = gridMap[tableRowIndex][col];\n\n        if (!mapCell?.cell) {\n          continue;\n        }\n\n        if (!rowCells.has(mapCell.cell)) {\n          rowCells.add(mapCell.cell);\n          mapCell.cell.setHeaderStyles(newStyle, TableCellHeaderStates.ROW);\n        }\n      }\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const toggleTableColumnIsHeader = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n      const tableColumnIndex = $getTableColumnIndexFromTableCellNode(tableCellNode);\n\n      const [gridMap] = $computeTableMapSkipCellCheck(tableNode, null, null);\n\n      const columnCells = new Set<TableCellNode>();\n      const newStyle = tableCellNode.getHeaderStyles() ^ TableCellHeaderStates.COLUMN;\n\n      for (let row = 0; row < gridMap.length; row++) {\n        const mapCell = gridMap[row][tableColumnIndex];\n\n        if (!mapCell?.cell) {\n          continue;\n        }\n\n        if (!columnCells.has(mapCell.cell)) {\n          columnCells.add(mapCell.cell);\n          mapCell.cell.setHeaderStyles(newStyle, TableCellHeaderStates.COLUMN);\n        }\n      }\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const toggleRowStriping = useCallback(() => {\n    editor.update(() => {\n      if (tableCellNode.isAttached()) {\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n        if (tableNode) {\n          tableNode.setRowStriping(!tableNode.getRowStriping());\n        }\n      }\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const toggleFirstRowFreeze = useCallback(() => {\n    editor.update(() => {\n      if (tableCellNode.isAttached()) {\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n        if (tableNode) {\n          tableNode.setFrozenRows(tableNode.getFrozenRows() === 0 ? 1 : 0);\n        }\n      }\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const toggleFirstColumnFreeze = useCallback(() => {\n    editor.update(() => {\n      if (tableCellNode.isAttached()) {\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n        if (tableNode) {\n          tableNode.setFrozenColumns(tableNode.getFrozenColumns() === 0 ? 1 : 0);\n        }\n      }\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const handleCellBackgroundColor = useCallback(\n    (value: string) => {\n      editor.update(() => {\n        const selection = $getSelection();\n        if ($isRangeSelection(selection) || $isTableSelection(selection)) {\n          const [cell] = $getNodeTriplet(selection.anchor);\n          if ($isTableCellNode(cell)) {\n            cell.setBackgroundColor(value);\n          }\n\n          if ($isTableSelection(selection)) {\n            const nodes = selection.getNodes();\n\n            for (let i = 0; i < nodes.length; i++) {\n              const node = nodes[i];\n              if ($isTableCellNode(node)) {\n                node.setBackgroundColor(value);\n              }\n            }\n          }\n        }\n      });\n    },\n    [editor]\n  );\n\n  const formatVerticalAlign = (value: string) => {\n    editor.update(() => {\n      const selection = $getSelection();\n      if ($isRangeSelection(selection) || $isTableSelection(selection)) {\n        const [cell] = $getNodeTriplet(selection.anchor);\n        if ($isTableCellNode(cell)) {\n          cell.setVerticalAlign(value);\n        }\n\n        if ($isTableSelection(selection)) {\n          const nodes = selection.getNodes();\n\n          for (let i = 0; i < nodes.length; i++) {\n            const node = nodes[i];\n            if ($isTableCellNode(node)) {\n              node.setVerticalAlign(value);\n            }\n          }\n        }\n      }\n    });\n  };\n\n  let mergeCellButton: null | JSX.Element = null;\n  if (cellMerge) {\n    if (canMergeCells) {\n      mergeCellButton = (\n        <button\n          type=\"button\"\n          className=\"item\"\n          onClick={() => mergeTableCellsAtSelection()}\n          data-test-id=\"table-merge-cells\"\n        >\n          <span className=\"text\">Merge cells</span>\n        </button>\n      );\n    } else if (canUnmergeCell) {\n      mergeCellButton = (\n        <button\n          type=\"button\"\n          className=\"item\"\n          onClick={() => unmergeTableCellsAtSelection()}\n          data-test-id=\"table-unmerge-cells\"\n        >\n          <span className=\"text\">Unmerge cells</span>\n        </button>\n      );\n    }\n  }\n\n  return createPortal(\n    <div\n      className=\"_dropdown\"\n      ref={dropDownRef}\n      onClick={(e) => {\n        e.stopPropagation();\n      }}\n    >\n      {mergeCellButton}\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() =>\n          showColorPickerModal(\"Cell background color\", () => (\n            <ColorPicker color={backgroundColor} onChange={handleCellBackgroundColor} />\n          ))\n        }\n        data-test-id=\"table-background-color\"\n      >\n        <span className=\"text\">Background color</span>\n      </button>\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() => toggleRowStriping()}\n        data-test-id=\"table-row-striping\"\n      >\n        <span className=\"text\">Toggle Row Striping</span>\n      </button>\n      <DropDown\n        buttonLabel=\"Vertical Align\"\n        buttonClassName=\"item\"\n        buttonAriaLabel=\"Formatting options for vertical alignment\"\n      >\n        <DropDownItem\n          onClick={() => {\n            formatVerticalAlign(\"top\");\n          }}\n          className=\"item wide\"\n        >\n          <div className=\"icon-text-container\">\n            <i className=\"icon vertical-top\" />\n            <span className=\"text\">Top Align</span>\n          </div>\n        </DropDownItem>\n        <DropDownItem\n          onClick={() => {\n            formatVerticalAlign(\"middle\");\n          }}\n          className=\"item wide\"\n        >\n          <div className=\"icon-text-container\">\n            <i className=\"icon vertical-middle\" />\n            <span className=\"text\">Middle Align</span>\n          </div>\n        </DropDownItem>\n        <DropDownItem\n          onClick={() => {\n            formatVerticalAlign(\"bottom\");\n          }}\n          className=\"item wide\"\n        >\n          <div className=\"icon-text-container\">\n            <i className=\"icon vertical-bottom\" />\n            <span className=\"text\">Bottom Align</span>\n          </div>\n        </DropDownItem>\n      </DropDown>\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() => toggleFirstRowFreeze()}\n        data-test-id=\"table-freeze-first-row\"\n      >\n        <span className=\"text\">Toggle First Row Freeze</span>\n      </button>\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() => toggleFirstColumnFreeze()}\n        data-test-id=\"table-freeze-first-column\"\n      >\n        <span className=\"text\">Toggle First Column Freeze</span>\n      </button>\n      <hr />\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() => insertTableRowAtSelection(false)}\n        data-test-id=\"table-insert-row-above\"\n      >\n        <span className=\"text\">\n          Insert {selectionCounts.rows === 1 ? \"row\" : `${selectionCounts.rows} rows`} above\n        </span>\n      </button>\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() => insertTableRowAtSelection(true)}\n        data-test-id=\"table-insert-row-below\"\n      >\n        <span className=\"text\">\n          Insert {selectionCounts.rows === 1 ? \"row\" : `${selectionCounts.rows} rows`} below\n        </span>\n      </button>\n      <hr />\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() => insertTableColumnAtSelection(false)}\n        data-test-id=\"table-insert-column-before\"\n      >\n        <span className=\"text\">\n          Insert {selectionCounts.columns === 1 ? \"column\" : `${selectionCounts.columns} columns`}{\" \"}\n          left\n        </span>\n      </button>\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() => insertTableColumnAtSelection(true)}\n        data-test-id=\"table-insert-column-after\"\n      >\n        <span className=\"text\">\n          Insert {selectionCounts.columns === 1 ? \"column\" : `${selectionCounts.columns} columns`}{\" \"}\n          right\n        </span>\n      </button>\n      <hr />\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() => deleteTableColumnAtSelection()}\n        data-test-id=\"table-delete-columns\"\n      >\n        <span className=\"text\">Delete column</span>\n      </button>\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() => deleteTableRowAtSelection()}\n        data-test-id=\"table-delete-rows\"\n      >\n        <span className=\"text\">Delete row</span>\n      </button>\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() => deleteTableAtSelection()}\n        data-test-id=\"table-delete\"\n      >\n        <span className=\"text\">Delete table</span>\n      </button>\n      <hr />\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() => toggleTableRowIsHeader()}\n        data-test-id=\"table-row-header\"\n      >\n        <span className=\"text\">\n          {(tableCellNode.__headerState & TableCellHeaderStates.ROW) === TableCellHeaderStates.ROW\n            ? \"Remove\"\n            : \"Add\"}{\" \"}\n          row header\n        </span>\n      </button>\n      <button\n        type=\"button\"\n        className=\"item\"\n        onClick={() => toggleTableColumnIsHeader()}\n        data-test-id=\"table-column-header\"\n      >\n        <span className=\"text\">\n          {(tableCellNode.__headerState & TableCellHeaderStates.COLUMN) ===\n          TableCellHeaderStates.COLUMN\n            ? \"Remove\"\n            : \"Add\"}{\" \"}\n          column header\n        </span>\n      </button>\n    </div>,\n    document.body\n  );\n}\n\nfunction TableCellActionMenuContainer({\n  anchorElem,\n  cellMerge,\n}: {\n  anchorElem: HTMLElement;\n  cellMerge: boolean;\n}): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n\n  const menuButtonRef = useRef<HTMLDivElement | null>(null);\n  const menuRootRef = useRef<HTMLButtonElement | null>(null);\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n\n  const [tableCellNode, setTableMenuCellNode] = useState<TableCellNode | null>(null);\n\n  const [colorPickerModal, showColorPickerModal] = useModal();\n\n  const checkTableCellOverflow = useCallback((tableCellParentNodeDOM: HTMLElement): boolean => {\n    const scrollableContainer = tableCellParentNodeDOM.closest(\n      \".PlaygroundEditorTheme__tableScrollableWrapper\"\n    );\n    if (scrollableContainer) {\n      const containerRect = (scrollableContainer as HTMLElement).getBoundingClientRect();\n      const cellRect = tableCellParentNodeDOM.getBoundingClientRect();\n\n      // Calculate where the action button would be positioned (5px from right edge of cell)\n      // Also account for the button width and table cell padding (8px)\n      const actionButtonRight = cellRect.right - 5;\n      const actionButtonLeft = actionButtonRight - 28; // 20px width + 8px padding\n\n      // Only hide if the action button would overflow the container\n      if (actionButtonRight > containerRect.right || actionButtonLeft < containerRect.left) {\n        return true;\n      }\n    }\n    return false;\n  }, []);\n\n  const $moveMenu = useCallback(() => {\n    const menu = menuButtonRef.current;\n    const selection = $getSelection();\n    const nativeSelection = getDOMSelection(editor._window);\n    const activeElement = document.activeElement;\n    function disable() {\n      if (menu) {\n        menu.classList.remove(\"table-cell-action-button-container--active\");\n        menu.classList.add(\"table-cell-action-button-container--inactive\");\n      }\n      setTableMenuCellNode(null);\n    }\n\n    if (selection == null || menu == null) {\n      return disable();\n    }\n\n    const rootElement = editor.getRootElement();\n    let tableObserver: TableObserver | null = null;\n    let tableCellParentNodeDOM: HTMLElement | null = null;\n\n    if (\n      $isRangeSelection(selection) &&\n      rootElement !== null &&\n      nativeSelection !== null &&\n      rootElement.contains(nativeSelection.anchorNode)\n    ) {\n      const tableCellNodeFromSelection = $getTableCellNodeFromLexicalNode(\n        selection.anchor.getNode()\n      );\n\n      if (tableCellNodeFromSelection == null) {\n        return disable();\n      }\n\n      tableCellParentNodeDOM = editor.getElementByKey(tableCellNodeFromSelection.getKey());\n\n      if (tableCellParentNodeDOM == null || !tableCellNodeFromSelection.isAttached()) {\n        return disable();\n      }\n\n      if (checkTableCellOverflow(tableCellParentNodeDOM)) {\n        return disable();\n      }\n\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNodeFromSelection);\n      const tableElement = getTableElement(tableNode, editor.getElementByKey(tableNode.getKey()));\n\n      if (tableElement === null) {\n        throw new Error(\"TableActionMenu: Expected to find tableElement in DOM\");\n      }\n\n      tableObserver = getTableObserverFromTableElement(tableElement);\n      setTableMenuCellNode(tableCellNodeFromSelection);\n    } else if ($isTableSelection(selection)) {\n      const anchorNode = $getTableCellNodeFromLexicalNode(selection.anchor.getNode());\n      if (!$isTableCellNode(anchorNode)) {\n        throw new Error(\"TableSelection anchorNode must be a TableCellNode\");\n      }\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(anchorNode);\n      const tableElement = getTableElement(tableNode, editor.getElementByKey(tableNode.getKey()));\n      if (tableElement === null) {\n        throw new Error(\"TableActionMenu: Expected to find tableElement in DOM\");\n      }\n      tableObserver = getTableObserverFromTableElement(tableElement);\n      tableCellParentNodeDOM = editor.getElementByKey(anchorNode.getKey());\n\n      if (tableCellParentNodeDOM === null) {\n        return disable();\n      }\n\n      if (checkTableCellOverflow(tableCellParentNodeDOM)) {\n        return disable();\n      }\n    } else if (!activeElement) {\n      return disable();\n    }\n    if (tableObserver === null || tableCellParentNodeDOM === null) {\n      return disable();\n    }\n    const enabled = !tableObserver || !tableObserver.isSelecting;\n    menu.classList.toggle(\"table-cell-action-button-container--active\", enabled);\n    menu.classList.toggle(\"table-cell-action-button-container--inactive\", !enabled);\n    if (enabled) {\n      const tableCellRect = tableCellParentNodeDOM.getBoundingClientRect();\n      const anchorRect = anchorElem.getBoundingClientRect();\n      const top = tableCellRect.top - anchorRect.top;\n      const left = tableCellRect.right - anchorRect.left;\n      menu.style.transform = `translate(${left}px, ${top}px)`;\n    }\n  }, [editor, anchorElem, checkTableCellOverflow]);\n\n  useEffect(() => {\n    // We call the $moveMenu callback every time the selection changes,\n    // once up front, and once after each pointerUp\n    let timeoutId: ReturnType<typeof setTimeout> | undefined = undefined;\n    const callback = () => {\n      timeoutId = undefined;\n      editor.getEditorState().read($moveMenu);\n    };\n    const delayedCallback = () => {\n      if (timeoutId === undefined) {\n        timeoutId = setTimeout(callback, 0);\n      }\n      return false;\n    };\n    return mergeRegister(\n      editor.registerUpdateListener(delayedCallback),\n      editor.registerCommand(SELECTION_CHANGE_COMMAND, delayedCallback, COMMAND_PRIORITY_CRITICAL),\n      editor.registerRootListener((rootElement, prevRootElement) => {\n        if (prevRootElement) {\n          prevRootElement.removeEventListener(\"pointerup\", delayedCallback);\n        }\n        if (rootElement) {\n          rootElement.addEventListener(\"pointerup\", delayedCallback);\n          delayedCallback();\n        }\n      }),\n      () => clearTimeout(timeoutId)\n    );\n  });\n\n  const prevTableCellDOM = useRef(tableCellNode);\n\n  useEffect(() => {\n    if (prevTableCellDOM.current !== tableCellNode) {\n      setIsMenuOpen(false);\n    }\n\n    prevTableCellDOM.current = tableCellNode;\n  }, [prevTableCellDOM, tableCellNode]);\n\n  return (\n    <div className=\"table-cell-action-button-container\" ref={menuButtonRef}>\n      {tableCellNode != null && (\n        <>\n          <button\n            type=\"button\"\n            className=\"table-cell-action-button chevron-down\"\n            onClick={(e) => {\n              e.stopPropagation();\n              setIsMenuOpen(!isMenuOpen);\n            }}\n            ref={menuRootRef}\n          >\n            <i className=\"chevron-down\" />\n          </button>\n          {colorPickerModal}\n          {isMenuOpen && (\n            <TableActionMenu\n              contextRef={menuRootRef}\n              setIsMenuOpen={setIsMenuOpen}\n              onClose={() => setIsMenuOpen(false)}\n              tableCellNode={tableCellNode}\n              cellMerge={cellMerge}\n              showColorPickerModal={showColorPickerModal}\n            />\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default function TableActionMenuPlugin({\n  anchorElem = document.body,\n  cellMerge = false,\n}: {\n  anchorElem?: HTMLElement;\n  cellMerge?: boolean;\n}): null | ReactPortal {\n  const isEditable = useLexicalEditable();\n  return createPortal(\n    isEditable ? (\n      <TableCellActionMenuContainer anchorElem={anchorElem} cellMerge={cellMerge} />\n    ) : null,\n    anchorElem\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport { isDOMNode } from \"lexical\";\nimport * as React from \"react\";\nimport { ReactNode, useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { createPortal } from \"react-dom\";\n\nimport { focusNearestDescendant, isKeyboardInput } from \"../utils/focusUtils\";\n\ntype DropDownContextType = {\n  registerItem: (ref: React.RefObject<null | HTMLButtonElement>) => void;\n};\n\nconst DropDownContext = React.createContext<DropDownContextType | null>(null);\n\nconst dropDownPadding = 4;\n\nexport function DropDownItem({\n  children,\n  className,\n  onClick,\n  title,\n}: {\n  children: React.ReactNode;\n  className: string;\n  onClick: (event: React.MouseEvent<HTMLButtonElement>) => void;\n  title?: string;\n}) {\n  const ref = useRef<null | HTMLButtonElement>(null);\n\n  const dropDownContext = React.useContext(DropDownContext);\n\n  if (dropDownContext === null) {\n    throw new Error(\"DropDownItem must be used within a DropDown\");\n  }\n\n  const { registerItem } = dropDownContext;\n\n  useEffect(() => {\n    if (ref && ref.current) {\n      registerItem(ref);\n    }\n  }, [ref, registerItem]);\n\n  return (\n    <button className={className} onClick={onClick} ref={ref} title={title} type=\"button\">\n      {children}\n    </button>\n  );\n}\n\nfunction DropDownItems({\n  children,\n  dropDownRef,\n  onClose,\n  autofocus,\n}: {\n  children: React.ReactNode;\n  dropDownRef: React.RefObject<HTMLDivElement | null>;\n  onClose: () => void;\n  autofocus: boolean;\n}) {\n  const [items, setItems] = useState<React.RefObject<null | HTMLButtonElement>[]>();\n  const [highlightedItem, setHighlightedItem] =\n    useState<React.RefObject<null | HTMLButtonElement>>();\n\n  const registerItem = useCallback(\n    (itemRef: React.RefObject<null | HTMLButtonElement>) => {\n      setItems((prev) => (prev ? [...prev, itemRef] : [itemRef]));\n    },\n    [setItems]\n  );\n\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLDivElement>) => {\n    const key = event.key;\n    if (key === \"Escape\") {\n      onClose();\n    }\n    if (!items) {\n      return;\n    }\n\n    if ([\"Escape\", \"ArrowUp\", \"ArrowDown\", \"Tab\"].includes(key)) {\n      event.preventDefault();\n    }\n\n    if (key === \"Escape\" || key === \"Tab\") {\n      onClose();\n    } else if (key === \"ArrowUp\") {\n      setHighlightedItem((prev) => {\n        if (!prev) {\n          return items[0];\n        }\n        const index = items.indexOf(prev) - 1;\n        return items[index === -1 ? items.length - 1 : index];\n      });\n    } else if (key === \"ArrowDown\") {\n      setHighlightedItem((prev) => {\n        if (!prev) {\n          return items[0];\n        }\n        return items[items.indexOf(prev) + 1];\n      });\n    }\n  };\n\n  const contextValue = useMemo(\n    () => ({\n      registerItem,\n    }),\n    [registerItem]\n  );\n\n  useEffect(() => {\n    if (items && !highlightedItem) {\n      setHighlightedItem(items[0]);\n    }\n\n    if (highlightedItem && highlightedItem.current) {\n      highlightedItem.current.focus();\n    }\n  }, [items, highlightedItem]);\n\n  useEffect(() => {\n    if (autofocus && dropDownRef.current) {\n      focusNearestDescendant(dropDownRef.current);\n    }\n  }, [autofocus, dropDownRef]);\n\n  return (\n    <DropDownContext.Provider value={contextValue}>\n      <div className=\"_dropdown\" ref={dropDownRef} onKeyDown={handleKeyDown}>\n        {children}\n      </div>\n    </DropDownContext.Provider>\n  );\n}\n\nexport default function DropDown({\n  disabled = false,\n  buttonLabel,\n  buttonAriaLabel,\n  buttonClassName,\n  buttonIconClassName,\n  children,\n  stopCloseOnClickSelf,\n}: {\n  disabled?: boolean;\n  buttonAriaLabel?: string;\n  buttonClassName: string;\n  buttonIconClassName?: string;\n  buttonLabel?: string;\n  children: ReactNode;\n  stopCloseOnClickSelf?: boolean;\n}): JSX.Element {\n  const dropDownRef = useRef<HTMLDivElement>(null);\n  const buttonRef = useRef<HTMLButtonElement>(null);\n  const [showDropDown, setShowDropDown] = useState(false);\n  const [shouldAutofocus, setShouldAutofocus] = useState(false);\n\n  const handleClose = () => {\n    setShowDropDown(false);\n    if (buttonRef && buttonRef.current) {\n      buttonRef.current.focus();\n    }\n  };\n\n  useEffect(() => {\n    const button = buttonRef.current;\n    const dropDown = dropDownRef.current;\n\n    if (showDropDown && button !== null && dropDown !== null) {\n      const { top, left } = button.getBoundingClientRect();\n      dropDown.style.top = `${top + button.offsetHeight + dropDownPadding}px`;\n      dropDown.style.left = `${Math.min(left, window.innerWidth - dropDown.offsetWidth - 20)}px`;\n    }\n  }, [dropDownRef, buttonRef, showDropDown]);\n\n  useEffect(() => {\n    const button = buttonRef.current;\n\n    if (button !== null && showDropDown) {\n      const handle = (event: PointerEvent) => {\n        const target = event.target;\n        if (!isDOMNode(target)) {\n          return;\n        }\n\n        const targetIsDropDownItem = dropDownRef.current && dropDownRef.current.contains(target);\n        if (stopCloseOnClickSelf && targetIsDropDownItem) {\n          return;\n        }\n\n        if (!button.contains(target)) {\n          setShowDropDown(false);\n\n          if (targetIsDropDownItem && isKeyboardInput(event)) {\n            button.focus();\n          }\n        }\n      };\n      document.addEventListener(\"click\", handle);\n\n      return () => {\n        document.removeEventListener(\"click\", handle);\n      };\n    }\n  }, [dropDownRef, buttonRef, showDropDown, stopCloseOnClickSelf]);\n\n  useEffect(() => {\n    const handleButtonPositionUpdate = () => {\n      if (showDropDown) {\n        const button = buttonRef.current;\n        const dropDown = dropDownRef.current;\n        if (button !== null && dropDown !== null) {\n          const { top } = button.getBoundingClientRect();\n          const newPosition = top + button.offsetHeight + dropDownPadding;\n          if (newPosition !== dropDown.getBoundingClientRect().top) {\n            dropDown.style.top = `${newPosition}px`;\n          }\n        }\n      }\n    };\n\n    document.addEventListener(\"scroll\", handleButtonPositionUpdate);\n\n    return () => {\n      document.removeEventListener(\"scroll\", handleButtonPositionUpdate);\n    };\n  }, [buttonRef, dropDownRef, showDropDown]);\n\n  const handleOnClick = (e: React.MouseEvent) => {\n    setShowDropDown(!showDropDown);\n    setShouldAutofocus(isKeyboardInput(e));\n  };\n\n  return (\n    <>\n      <button\n        type=\"button\"\n        disabled={disabled}\n        aria-label={buttonAriaLabel || buttonLabel}\n        className={buttonClassName}\n        onClick={handleOnClick}\n        ref={buttonRef}\n      >\n        {buttonIconClassName && <span className={buttonIconClassName} />}\n        {buttonLabel && <span className=\"text dropdown-button-text\">{buttonLabel}</span>}\n        <i className=\"chevron-down\" />\n      </button>\n\n      {showDropDown &&\n        createPortal(\n          <DropDownItems\n            dropDownRef={dropDownRef}\n            onClose={handleClose}\n            autofocus={shouldAutofocus}\n          >\n            {children}\n          </DropDownItems>,\n          document.body\n        )}\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nexport const findFirstFocusableDescendant = (startElement: HTMLElement): HTMLElement | null => {\n  const focusableSelector =\n    \"button, a[href], input, select, textarea, details, summary [tabindex], [contenteditable]\";\n\n  const focusableDescendants = startElement.querySelector(focusableSelector) as HTMLElement;\n\n  return focusableDescendants;\n};\n\nexport const focusNearestDescendant = (startElement: HTMLElement): HTMLElement | null => {\n  const el = findFirstFocusableDescendant(startElement);\n  el?.focus();\n  return el;\n};\n\nexport const isKeyboardInput = (event: MouseEvent | PointerEvent | React.MouseEvent): boolean => {\n  if (\"pointerId\" in event && \"pointerType\" in event) {\n    return event.pointerId === -1 && event.pointerType === \"\";\n  }\n\n  return event?.detail === 0;\n};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport { useCallback, useMemo, useState } from \"react\";\nimport * as React from \"react\";\nimport Modal from \"../ui/Modal\";\n\nexport default function useModal(): [\n  JSX.Element | null,\n  (title: string, showModal: (onClose: () => void) => JSX.Element) => void,\n] {\n  const [modalContent, setModalContent] = useState<null | {\n    closeOnClickOutside: boolean;\n    content: JSX.Element;\n    title: string;\n  }>(null);\n\n  const onClose = useCallback(() => {\n    setModalContent(null);\n  }, []);\n\n  const modal = useMemo(() => {\n    if (modalContent === null) {\n      return null;\n    }\n    const { title, content, closeOnClickOutside } = modalContent;\n    return (\n      <Modal onClose={onClose} title={title} closeOnClickOutside={closeOnClickOutside}>\n        {content}\n      </Modal>\n    );\n  }, [modalContent, onClose]);\n\n  const showModal = useCallback(\n    (\n      title: string,\n\n      getContent: (onClose: () => void) => JSX.Element,\n      closeOnClickOutside = false\n    ) => {\n      setModalContent({\n        closeOnClickOutside,\n        content: getContent(onClose),\n        title,\n      });\n    },\n    [onClose]\n  );\n\n  return [modal, showModal];\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport \"./Modal.css\";\n\nimport { isDOMNode } from \"lexical\";\nimport * as React from \"react\";\nimport { ReactNode, useEffect, useRef } from \"react\";\nimport { createPortal } from \"react-dom\";\n\nfunction PortalImpl({\n  onClose,\n  children,\n  title,\n  closeOnClickOutside,\n}: {\n  children: ReactNode;\n  closeOnClickOutside: boolean;\n  onClose: () => void;\n  title: string;\n}) {\n  const modalRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (modalRef.current !== null) {\n      modalRef.current.focus();\n    }\n  }, []);\n\n  useEffect(() => {\n    let modalOverlayElement: HTMLElement | null = null;\n    const handler = (event: KeyboardEvent) => {\n      if (event.key === \"Escape\") {\n        onClose();\n      }\n    };\n    const clickOutsideHandler = (event: MouseEvent) => {\n      const target = event.target;\n      if (\n        modalRef.current !== null &&\n        isDOMNode(target) &&\n        !modalRef.current.contains(target) &&\n        closeOnClickOutside\n      ) {\n        onClose();\n      }\n    };\n    const modelElement = modalRef.current;\n    if (modelElement !== null) {\n      modalOverlayElement = modelElement.parentElement;\n      if (modalOverlayElement !== null) {\n        modalOverlayElement.addEventListener(\"click\", clickOutsideHandler);\n      }\n    }\n\n    window.addEventListener(\"keydown\", handler);\n\n    return () => {\n      window.removeEventListener(\"keydown\", handler);\n      if (modalOverlayElement !== null) {\n        modalOverlayElement?.removeEventListener(\"click\", clickOutsideHandler);\n      }\n    };\n  }, [closeOnClickOutside, onClose]);\n\n  return (\n    <div className=\"Modal__overlay\" role=\"dialog\">\n      <div className=\"Modal__modal\" tabIndex={-1} ref={modalRef}>\n        <h2 className=\"Modal__title\">{title}</h2>\n        <button\n          className=\"Modal__closeButton\"\n          aria-label=\"Close modal\"\n          type=\"button\"\n          onClick={onClose}\n        >\n          X\n        </button>\n        <div className=\"Modal__content\">{children}</div>\n      </div>\n    </div>\n  );\n}\n\nexport default function Modal({\n  onClose,\n  children,\n  title,\n  closeOnClickOutside = false,\n}: {\n  children: ReactNode;\n  closeOnClickOutside?: boolean;\n  onClose: () => void;\n  title: string;\n}): JSX.Element {\n  return createPortal(\n    <PortalImpl onClose={onClose} title={title} closeOnClickOutside={closeOnClickOutside}>\n      {children}\n    </PortalImpl>,\n    document.body\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport \"./ColorPicker.css\";\n\nimport { calculateZoomLevel } from \"@lexical/utils\";\nimport { useMemo, useRef, useState } from \"react\";\nimport * as React from \"react\";\n\nimport TextInput from \"./TextInput\";\nimport { isKeyboardInput } from \"../utils/focusUtils\";\n\nlet skipAddingToHistoryStack = false;\n\ninterface ColorPickerProps {\n  color: string;\n  onChange?: (value: string, skipHistoryStack: boolean, skipRefocus: boolean) => void;\n}\n\nexport function parseAllowedColor(input: string) {\n  return /^rgb\\(\\d+, \\d+, \\d+\\)$/.test(input) ? input : \"\";\n}\n\nconst basicColors = [\n  \"#d0021b\",\n  \"#f5a623\",\n  \"#f8e71c\",\n  \"#8b572a\",\n  \"#7ed321\",\n  \"#417505\",\n  \"#bd10e0\",\n  \"#9013fe\",\n  \"#4a90e2\",\n  \"#50e3c2\",\n  \"#b8e986\",\n  \"#000000\",\n  \"#4a4a4a\",\n  \"#9b9b9b\",\n  \"#ffffff\",\n];\n\nconst WIDTH = 214;\nconst HEIGHT = 150;\n\nexport default function ColorPicker({ color, onChange }: Readonly<ColorPickerProps>): JSX.Element {\n  const [selfColor, setSelfColor] = useState(transformColor(\"hex\", color));\n  const [inputColor, setInputColor] = useState(transformColor(\"hex\", color).hex);\n  const innerDivRef = useRef(null);\n\n  const saturationPosition = useMemo(\n    () => ({\n      x: (selfColor.hsv.s / 100) * WIDTH,\n      y: ((100 - selfColor.hsv.v) / 100) * HEIGHT,\n    }),\n    [selfColor.hsv.s, selfColor.hsv.v]\n  );\n\n  const huePosition = useMemo(\n    () => ({\n      x: (selfColor.hsv.h / 360) * WIDTH,\n    }),\n    [selfColor.hsv]\n  );\n\n  const emitOnChange = (newColor: string, skipRefocus: boolean = false) => {\n    // Check if the dropdown is actually active\n    if (innerDivRef.current !== null && onChange) {\n      onChange(newColor, skipAddingToHistoryStack, skipRefocus);\n    }\n  };\n\n  const onSetHex = (hex: string) => {\n    setInputColor(hex);\n    if (/^#[0-9A-Fa-f]{6}$/i.test(hex)) {\n      const newColor = transformColor(\"hex\", hex);\n      setSelfColor(newColor);\n      emitOnChange(newColor.hex);\n    }\n  };\n\n  const onMoveSaturation = ({ x, y }: Position) => {\n    const newHsv = {\n      ...selfColor.hsv,\n      s: (x / WIDTH) * 100,\n      v: 100 - (y / HEIGHT) * 100,\n    };\n    const newColor = transformColor(\"hsv\", newHsv);\n    setSelfColor(newColor);\n    setInputColor(newColor.hex);\n    emitOnChange(newColor.hex);\n  };\n\n  const onMoveHue = ({ x }: Position) => {\n    const newHsv = { ...selfColor.hsv, h: (x / WIDTH) * 360 };\n    const newColor = transformColor(\"hsv\", newHsv);\n\n    setSelfColor(newColor);\n    setInputColor(newColor.hex);\n    emitOnChange(newColor.hex);\n  };\n\n  const onBasicColorClick = (e: React.MouseEvent, basicColor: string) => {\n    const newColor = transformColor(\"hex\", basicColor);\n\n    setSelfColor(newColor);\n    setInputColor(newColor.hex);\n    emitOnChange(newColor.hex, isKeyboardInput(e));\n  };\n\n  return (\n    <div className=\"color-picker-wrapper\" style={{ width: WIDTH }} ref={innerDivRef}>\n      <TextInput label=\"Hex\" onChange={onSetHex} value={inputColor} />\n      <div className=\"color-picker-basic-color\">\n        {basicColors.map((basicColor) => (\n          <button\n            className={basicColor === selfColor.hex ? \"active\" : \"\"}\n            key={basicColor}\n            style={{ backgroundColor: basicColor }}\n            onClick={(e) => onBasicColorClick(e, basicColor)}\n          />\n        ))}\n      </div>\n      <MoveWrapper\n        className=\"color-picker-saturation\"\n        style={{ backgroundColor: `hsl(${selfColor.hsv.h}, 100%, 50%)` }}\n        onChange={onMoveSaturation}\n      >\n        <div\n          className=\"color-picker-saturation_cursor\"\n          style={{\n            backgroundColor: selfColor.hex,\n            left: saturationPosition.x,\n            top: saturationPosition.y,\n          }}\n        />\n      </MoveWrapper>\n      <MoveWrapper className=\"color-picker-hue\" onChange={onMoveHue}>\n        <div\n          className=\"color-picker-hue_cursor\"\n          style={{\n            backgroundColor: `hsl(${selfColor.hsv.h}, 100%, 50%)`,\n            left: huePosition.x,\n          }}\n        />\n      </MoveWrapper>\n      <div className=\"color-picker-color\" style={{ backgroundColor: selfColor.hex }} />\n    </div>\n  );\n}\n\nexport interface Position {\n  x: number;\n  y: number;\n}\n\ninterface MoveWrapperProps {\n  className?: string;\n  style?: React.CSSProperties;\n  onChange: (position: Position) => void;\n  children: JSX.Element;\n}\n\nfunction MoveWrapper({ className, style, onChange, children }: MoveWrapperProps) {\n  const divRef = useRef<HTMLDivElement>(null);\n  const draggedRef = useRef(false);\n\n  const move = (e: React.MouseEvent | MouseEvent): void => {\n    if (divRef.current) {\n      const { current: div } = divRef;\n      const { width, height, left, top } = div.getBoundingClientRect();\n      const zoom = calculateZoomLevel(div);\n      const x = clamp(e.clientX / zoom - left, width, 0);\n      const y = clamp(e.clientY / zoom - top, height, 0);\n\n      onChange({ x, y });\n    }\n  };\n\n  const onMouseDown = (e: React.MouseEvent): void => {\n    if (e.button !== 0) {\n      return;\n    }\n\n    move(e);\n\n    const onMouseMove = (_e: MouseEvent): void => {\n      draggedRef.current = true;\n      skipAddingToHistoryStack = true;\n      move(_e);\n    };\n\n    const onMouseUp = (_e: MouseEvent): void => {\n      if (draggedRef.current) {\n        skipAddingToHistoryStack = false;\n      }\n\n      document.removeEventListener(\"mousemove\", onMouseMove, false);\n      document.removeEventListener(\"mouseup\", onMouseUp, false);\n\n      move(_e);\n      draggedRef.current = false;\n    };\n\n    document.addEventListener(\"mousemove\", onMouseMove, false);\n    document.addEventListener(\"mouseup\", onMouseUp, false);\n  };\n\n  return (\n    <div ref={divRef} className={className} style={style} onMouseDown={onMouseDown}>\n      {children}\n    </div>\n  );\n}\n\nfunction clamp(value: number, max: number, min: number) {\n  return value > max ? max : value < min ? min : value;\n}\n\ninterface RGB {\n  b: number;\n  g: number;\n  r: number;\n}\ninterface HSV {\n  h: number;\n  s: number;\n  v: number;\n}\ninterface Color {\n  hex: string;\n  hsv: HSV;\n  rgb: RGB;\n}\n\nexport function toHex(value: string): string {\n  if (!value.startsWith(\"#\")) {\n    const ctx = document.createElement(\"canvas\").getContext(\"2d\");\n\n    if (!ctx) {\n      throw new Error(\"2d context not supported or canvas already initialized\");\n    }\n\n    ctx.fillStyle = value;\n\n    return ctx.fillStyle;\n  } else if (value.length === 4 || value.length === 5) {\n    value = value\n      .split(\"\")\n      .map((v, i) => (i ? v + v : \"#\"))\n      .join(\"\");\n\n    return value;\n  } else if (value.length === 7 || value.length === 9) {\n    return value;\n  }\n\n  return \"#000000\";\n}\n\nfunction hex2rgb(hex: string): RGB {\n  const rbgArr = (\n    hex\n      .replace(/^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i, (m, r, g, b) => \"#\" + r + r + g + g + b + b)\n      .substring(1)\n      .match(/.{2}/g) || []\n  ).map((x) => parseInt(x, 16));\n\n  return {\n    b: rbgArr[2],\n    g: rbgArr[1],\n    r: rbgArr[0],\n  };\n}\n\nfunction rgb2hsv({ r, g, b }: RGB): HSV {\n  r /= 255;\n  g /= 255;\n  b /= 255;\n\n  const max = Math.max(r, g, b);\n  const d = max - Math.min(r, g, b);\n\n  const h = d\n    ? (max === r ? (g - b) / d + (g < b ? 6 : 0) : max === g ? 2 + (b - r) / d : 4 + (r - g) / d) *\n      60\n    : 0;\n  const s = max ? (d / max) * 100 : 0;\n  const v = max * 100;\n\n  return { h, s, v };\n}\n\nfunction hsv2rgb({ h, s, v }: HSV): RGB {\n  s /= 100;\n  v /= 100;\n\n  const i = ~~(h / 60);\n  const f = h / 60 - i;\n  const p = v * (1 - s);\n  const q = v * (1 - s * f);\n  const t = v * (1 - s * (1 - f));\n  const index = i % 6;\n\n  const r = Math.round([v, q, p, p, t, v][index] * 255);\n  const g = Math.round([t, v, v, q, p, p][index] * 255);\n  const b = Math.round([p, p, t, v, v, q][index] * 255);\n\n  return { b, g, r };\n}\n\nfunction rgb2hex({ b, g, r }: RGB): string {\n  return \"#\" + [r, g, b].map((x) => x.toString(16).padStart(2, \"0\")).join(\"\");\n}\n\nfunction transformColor<M extends keyof Color, C extends Color[M]>(format: M, color: C): Color {\n  let hex: Color[\"hex\"] = toHex(\"#121212\");\n  let rgb: Color[\"rgb\"] = hex2rgb(hex);\n  let hsv: Color[\"hsv\"] = rgb2hsv(rgb);\n\n  if (format === \"hex\") {\n    const value = color as Color[\"hex\"];\n\n    hex = toHex(value);\n    rgb = hex2rgb(hex);\n    hsv = rgb2hsv(rgb);\n  } else if (format === \"rgb\") {\n    const value = color as Color[\"rgb\"];\n\n    rgb = value;\n    hex = rgb2hex(rgb);\n    hsv = rgb2hsv(rgb);\n  } else if (format === \"hsv\") {\n    const value = color as Color[\"hsv\"];\n\n    hsv = value;\n    rgb = hsv2rgb(hsv);\n    hex = rgb2hex(rgb);\n  }\n\n  return { hex, hsv, rgb };\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport type { TableCellNode, TableDOMCell, TableMapType } from \"@lexical/table\";\nimport type { LexicalEditor, NodeKey } from \"lexical\";\nimport type { JSX } from \"react\";\n\nimport \"./index.css\";\n\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { useLexicalEditable } from \"@lexical/react/useLexicalEditable\";\nimport {\n  $computeTableMapSkipCellCheck,\n  $getTableNodeFromLexicalNodeOrThrow,\n  $getTableRowIndexFromTableCellNode,\n  $isTableCellNode,\n  $isTableRowNode,\n  getDOMCellFromTarget,\n  getTableElement,\n  TableNode,\n} from \"@lexical/table\";\nimport { calculateZoomLevel, mergeRegister } from \"@lexical/utils\";\nimport { $getNearestNodeFromDOMNode, isHTMLElement, SKIP_SCROLL_INTO_VIEW_TAG } from \"lexical\";\nimport * as React from \"react\";\nimport {\n  CSSProperties,\n  PointerEventHandler,\n  ReactPortal,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport { createPortal } from \"react-dom\";\n\ntype PointerPosition = {\n  x: number;\n  y: number;\n};\n\ntype PointerDraggingDirection = \"right\" | \"bottom\";\n\nconst MIN_ROW_HEIGHT = 33;\nconst MIN_COLUMN_WIDTH = 92;\nconst ACTIVE_RESIZER_COLOR = \"#76b6ff\";\n\nfunction TableCellResizer({ editor }: { editor: LexicalEditor }): JSX.Element {\n  const targetRef = useRef<HTMLElement | null>(null);\n  const resizerRef = useRef<HTMLDivElement | null>(null);\n  const tableRectRef = useRef<ClientRect | null>(null);\n  const [hasTable, setHasTable] = useState(false);\n\n  const pointerStartPosRef = useRef<PointerPosition | null>(null);\n  const [pointerCurrentPos, updatePointerCurrentPos] = useState<PointerPosition | null>(null);\n\n  const [activeCell, updateActiveCell] = useState<TableDOMCell | null>(null);\n  const [draggingDirection, updateDraggingDirection] = useState<PointerDraggingDirection | null>(\n    null\n  );\n  const [hoveredDirection, updateHoveredDirection] = useState<PointerDraggingDirection | null>(\n    null\n  );\n\n  const resetState = useCallback(() => {\n    updateActiveCell(null);\n    targetRef.current = null;\n    updateDraggingDirection(null);\n    updateHoveredDirection(null);\n    pointerStartPosRef.current = null;\n    tableRectRef.current = null;\n  }, []);\n\n  useEffect(() => {\n    const tableKeys = new Set<NodeKey>();\n    return mergeRegister(\n      editor.registerMutationListener(TableNode, (nodeMutations) => {\n        for (const [nodeKey, mutation] of nodeMutations) {\n          if (mutation === \"destroyed\") {\n            tableKeys.delete(nodeKey);\n          } else {\n            tableKeys.add(nodeKey);\n          }\n        }\n        setHasTable(tableKeys.size > 0);\n      }),\n      editor.registerNodeTransform(TableNode, (tableNode) => {\n        if (tableNode.getColWidths()) {\n          return tableNode;\n        }\n\n        const numColumns = tableNode.getColumnCount();\n        const columnWidth = MIN_COLUMN_WIDTH;\n\n        tableNode.setColWidths(Array(numColumns).fill(columnWidth));\n        return tableNode;\n      })\n    );\n  }, [editor]);\n\n  useEffect(() => {\n    if (!hasTable) {\n      return;\n    }\n\n    const onPointerMove = (event: PointerEvent) => {\n      const target = event.target;\n      if (!isHTMLElement(target)) {\n        return;\n      }\n\n      if (draggingDirection) {\n        event.preventDefault();\n        event.stopPropagation();\n        updatePointerCurrentPos({\n          x: event.clientX,\n          y: event.clientY,\n        });\n        return;\n      }\n      if (resizerRef.current && resizerRef.current.contains(target)) {\n        return;\n      }\n\n      if (targetRef.current !== target) {\n        targetRef.current = target;\n        const cell = getDOMCellFromTarget(target);\n\n        if (cell && activeCell !== cell) {\n          editor.getEditorState().read(\n            () => {\n              const tableCellNode = $getNearestNodeFromDOMNode(cell.elem);\n              if (!tableCellNode) {\n                throw new Error(\"TableCellResizer: Table cell node not found.\");\n              }\n\n              const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n              const tableElement = getTableElement(\n                tableNode,\n                editor.getElementByKey(tableNode.getKey())\n              );\n\n              if (!tableElement) {\n                throw new Error(\"TableCellResizer: Table element not found.\");\n              }\n\n              targetRef.current = target;\n              tableRectRef.current = tableElement.getBoundingClientRect();\n              updateActiveCell(cell);\n            },\n            { editor }\n          );\n        } else if (cell == null) {\n          resetState();\n        }\n      }\n    };\n\n    const onPointerDown = (event: PointerEvent) => {\n      const isTouchEvent = event.pointerType === \"touch\";\n      if (isTouchEvent) {\n        onPointerMove(event);\n      }\n    };\n\n    const resizerContainer = resizerRef.current;\n    resizerContainer?.addEventListener(\"pointermove\", onPointerMove, {\n      capture: true,\n    });\n\n    const removeRootListener = editor.registerRootListener((rootElement, prevRootElement) => {\n      prevRootElement?.removeEventListener(\"pointermove\", onPointerMove);\n      prevRootElement?.removeEventListener(\"pointerdown\", onPointerDown);\n      rootElement?.addEventListener(\"pointermove\", onPointerMove);\n      rootElement?.addEventListener(\"pointerdown\", onPointerDown);\n    });\n\n    return () => {\n      removeRootListener();\n      resizerContainer?.removeEventListener(\"pointermove\", onPointerMove);\n    };\n  }, [activeCell, draggingDirection, editor, resetState, hasTable]);\n\n  const isHeightChanging = (direction: PointerDraggingDirection) => {\n    if (direction === \"bottom\") {\n      return true;\n    }\n    return false;\n  };\n\n  const updateRowHeight = useCallback(\n    (heightChange: number) => {\n      if (!activeCell) {\n        throw new Error(\"TableCellResizer: Expected active cell.\");\n      }\n\n      editor.update(\n        () => {\n          const tableCellNode = $getNearestNodeFromDOMNode(activeCell.elem);\n          if (!$isTableCellNode(tableCellNode)) {\n            throw new Error(\"TableCellResizer: Table cell node not found.\");\n          }\n\n          const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n          const baseRowIndex = $getTableRowIndexFromTableCellNode(tableCellNode);\n          const tableRows = tableNode.getChildren();\n\n          // Determine if this is a full row merge by checking colspan\n          const isFullRowMerge = tableCellNode.getColSpan() === tableNode.getColumnCount();\n\n          // For full row merges, apply to first row. For partial merges, apply to last row\n          const tableRowIndex = isFullRowMerge\n            ? baseRowIndex\n            : baseRowIndex + tableCellNode.getRowSpan() - 1;\n\n          if (tableRowIndex >= tableRows.length || tableRowIndex < 0) {\n            throw new Error(\"Expected table cell to be inside of table row.\");\n          }\n\n          const tableRow = tableRows[tableRowIndex];\n\n          if (!$isTableRowNode(tableRow)) {\n            throw new Error(\"Expected table row\");\n          }\n\n          let height = tableRow.getHeight();\n          if (height === undefined) {\n            const rowCells = tableRow.getChildren<TableCellNode>();\n            height = Math.min(\n              ...rowCells.map((cell) => getCellNodeHeight(cell, editor) ?? Infinity)\n            );\n          }\n\n          const newHeight = Math.max(height + heightChange, MIN_ROW_HEIGHT);\n          tableRow.setHeight(newHeight);\n        },\n        { tag: SKIP_SCROLL_INTO_VIEW_TAG }\n      );\n    },\n    [activeCell, editor]\n  );\n\n  const getCellNodeHeight = (\n    cell: TableCellNode,\n    activeEditor: LexicalEditor\n  ): number | undefined => {\n    const domCellNode = activeEditor.getElementByKey(cell.getKey());\n    return domCellNode?.clientHeight;\n  };\n\n  const getCellColumnIndex = (tableCellNode: TableCellNode, tableMap: TableMapType) => {\n    for (let row = 0; row < tableMap.length; row++) {\n      for (let column = 0; column < tableMap[row].length; column++) {\n        if (tableMap[row][column].cell === tableCellNode) {\n          return column;\n        }\n      }\n    }\n  };\n\n  const updateColumnWidth = useCallback(\n    (widthChange: number) => {\n      if (!activeCell) {\n        throw new Error(\"TableCellResizer: Expected active cell.\");\n      }\n      editor.update(\n        () => {\n          const tableCellNode = $getNearestNodeFromDOMNode(activeCell.elem);\n          if (!$isTableCellNode(tableCellNode)) {\n            throw new Error(\"TableCellResizer: Table cell node not found.\");\n          }\n\n          const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n          const [tableMap] = $computeTableMapSkipCellCheck(tableNode, null, null);\n          const columnIndex = getCellColumnIndex(tableCellNode, tableMap);\n          if (columnIndex === undefined) {\n            throw new Error(\"TableCellResizer: Table column not found.\");\n          }\n\n          const colWidths = tableNode.getColWidths();\n          if (!colWidths) {\n            return;\n          }\n          const width = colWidths[columnIndex];\n          if (width === undefined) {\n            return;\n          }\n          const newColWidths = [...colWidths];\n          const newWidth = Math.max(width + widthChange, MIN_COLUMN_WIDTH);\n          newColWidths[columnIndex] = newWidth;\n          tableNode.setColWidths(newColWidths);\n        },\n        { tag: SKIP_SCROLL_INTO_VIEW_TAG }\n      );\n    },\n    [activeCell, editor]\n  );\n\n  const pointerUpHandler = useCallback(\n    (direction: PointerDraggingDirection) => {\n      const handler = (event: PointerEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        if (!activeCell) {\n          throw new Error(\"TableCellResizer: Expected active cell.\");\n        }\n\n        if (pointerStartPosRef.current) {\n          const { x, y } = pointerStartPosRef.current;\n\n          if (activeCell === null) {\n            return;\n          }\n          const zoom = calculateZoomLevel(event.target as Element);\n\n          if (isHeightChanging(direction)) {\n            const heightChange = (event.clientY - y) / zoom;\n            updateRowHeight(heightChange);\n          } else {\n            const widthChange = (event.clientX - x) / zoom;\n            updateColumnWidth(widthChange);\n          }\n\n          resetState();\n          document.removeEventListener(\"pointerup\", handler);\n        }\n      };\n      return handler;\n    },\n    [activeCell, resetState, updateColumnWidth, updateRowHeight]\n  );\n\n  const toggleResize = useCallback(\n    (direction: PointerDraggingDirection): PointerEventHandler<HTMLDivElement> =>\n      (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        if (!activeCell) {\n          throw new Error(\"TableCellResizer: Expected active cell.\");\n        }\n\n        pointerStartPosRef.current = {\n          x: event.clientX,\n          y: event.clientY,\n        };\n        updatePointerCurrentPos(pointerStartPosRef.current);\n        updateDraggingDirection(direction);\n\n        document.addEventListener(\"pointerup\", pointerUpHandler(direction));\n      },\n    [activeCell, pointerUpHandler]\n  );\n\n  const getResizers = useCallback(() => {\n    if (activeCell) {\n      const { height, width, top, left } = activeCell.elem.getBoundingClientRect();\n      const zoom = calculateZoomLevel(activeCell.elem);\n      const zoneWidth = 16; // Pixel width of the zone where you can drag the edge\n      const styles: Record<string, CSSProperties> = {\n        bottom: {\n          backgroundColor: \"none\",\n          cursor: \"row-resize\",\n          height: `${zoneWidth}px`,\n          left: `${window.scrollX + left}px`,\n          top: `${window.scrollY + top + height - zoneWidth / 2}px`,\n          width: `${width}px`,\n        },\n        right: {\n          backgroundColor: \"none\",\n          cursor: \"col-resize\",\n          height: `${height}px`,\n          left: `${window.scrollX + left + width - zoneWidth / 2}px`,\n          top: `${window.scrollY + top}px`,\n          width: `${zoneWidth}px`,\n        },\n      };\n\n      const tableRect = tableRectRef.current;\n\n      if (draggingDirection && pointerCurrentPos && tableRect) {\n        if (isHeightChanging(draggingDirection)) {\n          styles[draggingDirection].left = `${window.scrollX + tableRect.left}px`;\n          styles[draggingDirection].top = `${window.scrollY + pointerCurrentPos.y / zoom}px`;\n          styles[draggingDirection].height = \"3px\";\n          styles[draggingDirection].width = `${tableRect.width}px`;\n        } else {\n          styles[draggingDirection].top = `${window.scrollY + tableRect.top}px`;\n          styles[draggingDirection].left = `${window.scrollX + pointerCurrentPos.x / zoom}px`;\n          styles[draggingDirection].width = \"3px\";\n          styles[draggingDirection].height = `${tableRect.height}px`;\n        }\n\n        styles[draggingDirection].backgroundColor = \"#adf\";\n        styles[draggingDirection].mixBlendMode = \"unset\";\n      } else if (!draggingDirection && hoveredDirection === \"right\") {\n        const halfZoneWidth = zoneWidth / 2;\n        const highlightWidth = 2;\n        const highlightStart = halfZoneWidth - highlightWidth / 2;\n        styles.right.background = `linear-gradient(90deg, transparent ${highlightStart}px, ${ACTIVE_RESIZER_COLOR} ${highlightStart}px, ${ACTIVE_RESIZER_COLOR} ${\n          highlightStart + highlightWidth\n        }px, transparent ${highlightStart + highlightWidth}px)`;\n        styles.right.mixBlendMode = \"unset\";\n        if (tableRect) {\n          styles.right.top = `${window.scrollY + tableRect.top}px`;\n          styles.right.height = `${tableRect.height}px`;\n        }\n      }\n\n      return styles;\n    }\n\n    return {\n      bottom: null,\n      left: null,\n      right: null,\n      top: null,\n    };\n  }, [activeCell, draggingDirection, hoveredDirection, pointerCurrentPos]);\n\n  const handlePointerEnter = useCallback(\n    (direction: PointerDraggingDirection): PointerEventHandler<HTMLDivElement> =>\n      () => {\n        if (!draggingDirection) {\n          updateHoveredDirection(direction);\n        }\n      },\n    [draggingDirection]\n  );\n\n  const handlePointerLeave = useCallback(() => {\n    if (!draggingDirection) {\n      updateHoveredDirection(null);\n    }\n  }, [draggingDirection]);\n\n  const resizerStyles = getResizers();\n\n  return (\n    <div ref={resizerRef}>\n      {activeCell != null && (\n        <>\n          <div\n            className=\"TableCellResizer__resizer TableCellResizer__ui\"\n            style={resizerStyles.right || undefined}\n            onPointerEnter={handlePointerEnter(\"right\")}\n            onPointerLeave={handlePointerLeave}\n            onPointerDown={toggleResize(\"right\")}\n          />\n          <div\n            className=\"TableCellResizer__resizer TableCellResizer__ui\"\n            style={resizerStyles.bottom || undefined}\n            onPointerDown={toggleResize(\"bottom\")}\n          />\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default function TableCellResizerPlugin(): null | ReactPortal {\n  const [editor] = useLexicalComposerContext();\n  const isEditable = useLexicalEditable();\n\n  return useMemo(\n    () => (isEditable ? createPortal(<TableCellResizer editor={editor} />, document.body) : null),\n    [editor, isEditable]\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport { $isLinkNode, TOGGLE_LINK_COMMAND } from \"@lexical/link\";\nimport { $isListNode, ListNode } from \"@lexical/list\";\nimport { $isHeadingNode } from \"@lexical/rich-text\";\nimport {\n  $getSelectionStyleValueForProperty,\n  $isParentElementRTL,\n  $patchStyleText,\n} from \"@lexical/selection\";\nimport { $isTableNode, $isTableSelection } from \"@lexical/table\";\nimport {\n  $findMatchingParent,\n  $getNearestNodeOfType,\n  $isEditorIsNestedEditor,\n  IS_APPLE,\n  mergeRegister,\n} from \"@lexical/utils\";\nimport {\n  $addUpdateTag,\n  $getSelection,\n  $isElementNode,\n  $isNodeSelection,\n  $isRangeSelection,\n  $isRootOrShadowRoot,\n  CAN_REDO_COMMAND,\n  CAN_UNDO_COMMAND,\n  COMMAND_PRIORITY_CRITICAL,\n  CommandPayloadType,\n  ElementFormatType,\n  FORMAT_ELEMENT_COMMAND,\n  FORMAT_TEXT_COMMAND,\n  HISTORIC_TAG,\n  INDENT_CONTENT_COMMAND,\n  LexicalCommand,\n  LexicalEditor,\n  LexicalNode,\n  OUTDENT_CONTENT_COMMAND,\n  REDO_COMMAND,\n  SELECTION_CHANGE_COMMAND,\n  SKIP_DOM_SELECTION_TAG,\n  SKIP_SELECTION_FOCUS_TAG,\n  TextFormatType,\n  UNDO_COMMAND,\n} from \"lexical\";\nimport { Dispatch, useCallback, useEffect, useState } from \"react\";\n\nimport { blockTypeToBlockName, useToolbarState } from \"../../context/ToolbarContext\";\nimport useModal from \"../../hooks/useModal\";\nimport DropDown, { DropDownItem } from \"../../ui/DropDown\";\nimport DropdownColorPicker from \"../../ui/DropdownColorPicker\";\nimport { isKeyboardInput } from \"../../utils/focusUtils\";\nimport { getSelectedNode } from \"../../utils/getSelectedNode\";\nimport { sanitizeUrl } from \"../../utils/url\";\nimport { InsertImageDialog } from \"../ImagesPlugin\";\nimport InsertLayoutDialog from \"../LayoutPlugin/InsertLayoutDialog\";\nimport { InsertTableDialog } from \"../TablePlugin\";\nimport FontSize, { parseFontSizeForToolbar } from \"./fontSize\";\nimport {\n  clearFormatting,\n  formatBulletList,\n  formatHeading,\n  formatNumberedList,\n  formatParagraph,\n  formatQuote,\n} from \"./utils\";\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst rootTypeToRootName = {\n  root: \"Root\",\n  table: \"Table\",\n};\n\nconst FONT_FAMILY_OPTIONS: [string, string][] = [\n  [\"Arial\", \"Arial\"],\n  [\"Courier New\", \"Courier New\"],\n  [\"Georgia\", \"Georgia\"],\n  [\"Times New Roman\", \"Times New Roman\"],\n  [\"Trebuchet MS\", \"Trebuchet MS\"],\n  [\"Verdana\", \"Verdana\"],\n];\n\nconst FONT_SIZE_OPTIONS: [string, string][] = [\n  [\"10px\", \"10px\"],\n  [\"11px\", \"11px\"],\n  [\"12px\", \"12px\"],\n  [\"13px\", \"13px\"],\n  [\"14px\", \"14px\"],\n  [\"15px\", \"15px\"],\n  [\"16px\", \"16px\"],\n  [\"17px\", \"17px\"],\n  [\"18px\", \"18px\"],\n  [\"19px\", \"19px\"],\n  [\"20px\", \"20px\"],\n];\n\nconst ELEMENT_FORMAT_OPTIONS: {\n  [key in Exclude<ElementFormatType, \"\">]: {\n    icon: string;\n    iconRTL: string;\n    name: string;\n  };\n} = {\n  center: {\n    icon: \"center-align\",\n    iconRTL: \"center-align\",\n    name: \"Center Align\",\n  },\n  end: {\n    icon: \"right-align\",\n    iconRTL: \"left-align\",\n    name: \"End Align\",\n  },\n  justify: {\n    icon: \"justify-align\",\n    iconRTL: \"justify-align\",\n    name: \"Justify Align\",\n  },\n  left: {\n    icon: \"left-align\",\n    iconRTL: \"left-align\",\n    name: \"Left Align\",\n  },\n  right: {\n    icon: \"right-align\",\n    iconRTL: \"right-align\",\n    name: \"Right Align\",\n  },\n  start: {\n    icon: \"left-align\",\n    iconRTL: \"right-align\",\n    name: \"Start Align\",\n  },\n};\n\nfunction dropDownActiveClass(active: boolean) {\n  if (active) {\n    return \"active dropdown-item-active\";\n  } else {\n    return \"\";\n  }\n}\n\nfunction BlockFormatDropDown({\n  editor,\n  blockType,\n  disabled = false,\n}: {\n  blockType: keyof typeof blockTypeToBlockName;\n  rootType: keyof typeof rootTypeToRootName;\n  editor: LexicalEditor;\n  disabled?: boolean;\n}): JSX.Element {\n  return (\n    <DropDown\n      disabled={disabled}\n      buttonClassName=\"toolbar-item block-controls\"\n      buttonIconClassName={\"icon block-type \" + blockType}\n      buttonLabel={blockTypeToBlockName[blockType]}\n      buttonAriaLabel=\"Formatting options for text style\"\n    >\n      <DropDownItem\n        className={\"item wide \" + dropDownActiveClass(blockType === \"paragraph\")}\n        onClick={() => formatParagraph(editor)}\n      >\n        <div className=\"icon-text-container\">\n          <i className=\"icon paragraph\" />\n          <span className=\"text\">Normal</span>\n        </div>\n      </DropDownItem>\n      <DropDownItem\n        className={\"item wide \" + dropDownActiveClass(blockType === \"h1\")}\n        onClick={() => formatHeading(editor, blockType, \"h1\")}\n      >\n        <div className=\"icon-text-container\">\n          <i className=\"icon h1\" />\n          <span className=\"text\">Heading 1</span>\n        </div>\n      </DropDownItem>\n      <DropDownItem\n        className={\"item wide \" + dropDownActiveClass(blockType === \"h2\")}\n        onClick={() => formatHeading(editor, blockType, \"h2\")}\n      >\n        <div className=\"icon-text-container\">\n          <i className=\"icon h2\" />\n          <span className=\"text\">Heading 2</span>\n        </div>\n      </DropDownItem>\n      <DropDownItem\n        className={\"item wide \" + dropDownActiveClass(blockType === \"h3\")}\n        onClick={() => formatHeading(editor, blockType, \"h3\")}\n      >\n        <div className=\"icon-text-container\">\n          <i className=\"icon h3\" />\n          <span className=\"text\">Heading 3</span>\n        </div>\n      </DropDownItem>\n      <DropDownItem\n        className={\"item wide \" + dropDownActiveClass(blockType === \"number\")}\n        onClick={() => formatNumberedList(editor, blockType)}\n      >\n        <div className=\"icon-text-container\">\n          <i className=\"icon numbered-list\" />\n          <span className=\"text\">Numbered List</span>\n        </div>\n      </DropDownItem>\n      <DropDownItem\n        className={\"item wide \" + dropDownActiveClass(blockType === \"bullet\")}\n        onClick={() => formatBulletList(editor, blockType)}\n      >\n        <div className=\"icon-text-container\">\n          <i className=\"icon bullet-list\" />\n          <span className=\"text\">Bullet List</span>\n        </div>\n      </DropDownItem>\n\n      <DropDownItem\n        className={\"item wide \" + dropDownActiveClass(blockType === \"quote\")}\n        onClick={() => formatQuote(editor, blockType)}\n      >\n        <div className=\"icon-text-container\">\n          <i className=\"icon quote\" />\n          <span className=\"text\">Quote</span>\n        </div>\n      </DropDownItem>\n    </DropDown>\n  );\n}\n\nfunction Divider(): JSX.Element {\n  return <div className=\"divider\" />;\n}\n\nfunction FontDropDown({\n  editor,\n  value,\n  style,\n  disabled = false,\n}: {\n  editor: LexicalEditor;\n  value: string;\n  style: string;\n  disabled?: boolean;\n}): JSX.Element {\n  const handleClick = useCallback(\n    (option: string) => {\n      editor.update(() => {\n        $addUpdateTag(SKIP_SELECTION_FOCUS_TAG);\n        const selection = $getSelection();\n        if (selection !== null) {\n          $patchStyleText(selection, {\n            [style]: option,\n          });\n        }\n      });\n    },\n    [editor, style]\n  );\n\n  const buttonAriaLabel =\n    style === \"font-family\"\n      ? \"Formatting options for font family\"\n      : \"Formatting options for font size\";\n\n  return (\n    <DropDown\n      disabled={disabled}\n      buttonClassName={\"toolbar-item \" + style}\n      buttonLabel={value}\n      buttonIconClassName={style === \"font-family\" ? \"icon block-type font-family\" : \"\"}\n      buttonAriaLabel={buttonAriaLabel}\n    >\n      {(style === \"font-family\" ? FONT_FAMILY_OPTIONS : FONT_SIZE_OPTIONS).map(([option, text]) => (\n        <DropDownItem\n          className={`item ${dropDownActiveClass(value === option)} ${\n            style === \"font-size\" ? \"fontsize-item\" : \"\"\n          }`}\n          onClick={() => handleClick(option)}\n          key={option}\n        >\n          <span className=\"text\">{text}</span>\n        </DropDownItem>\n      ))}\n    </DropDown>\n  );\n}\n\nfunction ElementFormatDropdown({\n  editor,\n  value,\n  isRTL,\n  disabled = false,\n}: {\n  editor: LexicalEditor;\n  value: ElementFormatType;\n  isRTL: boolean;\n  disabled: boolean;\n}) {\n  const formatOption = ELEMENT_FORMAT_OPTIONS[value || \"left\"];\n\n  return (\n    <DropDown\n      disabled={disabled}\n      buttonLabel={formatOption.name}\n      buttonIconClassName={`icon ${isRTL ? formatOption.iconRTL : formatOption.icon}`}\n      buttonClassName=\"toolbar-item spaced alignment\"\n      buttonAriaLabel=\"Formatting options for text alignment\"\n    >\n      <DropDownItem\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_ELEMENT_COMMAND, \"left\");\n        }}\n        className=\"item wide\"\n      >\n        <div className=\"icon-text-container\">\n          <i className=\"icon left-align\" />\n          <span className=\"text\">Left Align</span>\n        </div>\n      </DropDownItem>\n      <DropDownItem\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_ELEMENT_COMMAND, \"center\");\n        }}\n        className=\"item wide\"\n      >\n        <div className=\"icon-text-container\">\n          <i className=\"icon center-align\" />\n          <span className=\"text\">Center Align</span>\n        </div>\n      </DropDownItem>\n      <DropDownItem\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_ELEMENT_COMMAND, \"right\");\n        }}\n        className=\"item wide\"\n      >\n        <div className=\"icon-text-container\">\n          <i className=\"icon right-align\" />\n          <span className=\"text\">Right Align</span>\n        </div>\n      </DropDownItem>\n      <DropDownItem\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_ELEMENT_COMMAND, \"justify\");\n        }}\n        className=\"item wide\"\n      >\n        <div className=\"icon-text-container\">\n          <i className=\"icon justify-align\" />\n          <span className=\"text\">Justify Align</span>\n        </div>\n      </DropDownItem>\n      <DropDownItem\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_ELEMENT_COMMAND, \"start\");\n        }}\n        className=\"item wide\"\n      >\n        <i\n          className={`icon ${\n            isRTL ? ELEMENT_FORMAT_OPTIONS.start.iconRTL : ELEMENT_FORMAT_OPTIONS.start.icon\n          }`}\n        />\n        <span className=\"text\">Start Align</span>\n      </DropDownItem>\n      <DropDownItem\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_ELEMENT_COMMAND, \"end\");\n        }}\n        className=\"item wide\"\n      >\n        <i\n          className={`icon ${\n            isRTL ? ELEMENT_FORMAT_OPTIONS.end.iconRTL : ELEMENT_FORMAT_OPTIONS.end.icon\n          }`}\n        />\n        <span className=\"text\">End Align</span>\n      </DropDownItem>\n      <Divider />\n      <DropDownItem\n        onClick={() => {\n          editor.dispatchCommand(OUTDENT_CONTENT_COMMAND, undefined);\n        }}\n        className=\"item wide\"\n      >\n        <div className=\"icon-text-container\">\n          <i className={\"icon \" + (isRTL ? \"indent\" : \"outdent\")} />\n          <span className=\"text\">Outdent</span>\n        </div>\n      </DropDownItem>\n      <DropDownItem\n        onClick={() => {\n          editor.dispatchCommand(INDENT_CONTENT_COMMAND, undefined);\n        }}\n        className=\"item wide\"\n      >\n        <div className=\"icon-text-container\">\n          <i className={\"icon \" + (isRTL ? \"outdent\" : \"indent\")} />\n          <span className=\"text\">Indent</span>\n        </div>\n      </DropDownItem>\n    </DropDown>\n  );\n}\n\nfunction $findTopLevelElement(node: LexicalNode) {\n  let topLevelElement =\n    node.getKey() === \"root\"\n      ? node\n      : $findMatchingParent(node, (e) => {\n          const parent = e.getParent();\n          return parent !== null && $isRootOrShadowRoot(parent);\n        });\n\n  if (topLevelElement === null) {\n    topLevelElement = node.getTopLevelElementOrThrow();\n  }\n  return topLevelElement;\n}\n\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\n\nexport default function ToolbarPlugin({\n  setIsLinkEditMode,\n  onUpload,\n}: {\n  setIsLinkEditMode: Dispatch<boolean>;\n  onUpload?: (file: File) => Promise<string | undefined>;\n}): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  const [activeEditor, setActiveEditor] = useState(editor);\n  const [modal, showModal] = useModal();\n  const [isEditable, setIsEditable] = useState(() => editor.isEditable());\n  const { toolbarState, updateToolbarState } = useToolbarState();\n\n  const dispatchToolbarCommand = <T extends LexicalCommand<unknown>>(\n    command: T,\n    payload: CommandPayloadType<T> | undefined = undefined,\n    skipRefocus: boolean = false\n  ) => {\n    activeEditor.update(() => {\n      if (skipRefocus) {\n        $addUpdateTag(SKIP_DOM_SELECTION_TAG);\n      }\n\n      // Re-assert on Type so that payload can have a default param\n      activeEditor.dispatchCommand(command, payload as CommandPayloadType<T>);\n    });\n  };\n\n  const dispatchFormatTextCommand = (payload: TextFormatType, skipRefocus: boolean = false) =>\n    dispatchToolbarCommand(FORMAT_TEXT_COMMAND, payload, skipRefocus);\n\n  const $handleHeadingNode = useCallback(\n    (selectedElement: LexicalNode) => {\n      const type = $isHeadingNode(selectedElement)\n        ? selectedElement.getTag()\n        : selectedElement.getType();\n\n      if (type in blockTypeToBlockName) {\n        updateToolbarState(\"blockType\", type as keyof typeof blockTypeToBlockName);\n      }\n    },\n    [updateToolbarState]\n  );\n\n  const $updateToolbar = useCallback(() => {\n    const selection = $getSelection();\n    if ($isRangeSelection(selection)) {\n      if (activeEditor !== editor && $isEditorIsNestedEditor(activeEditor)) {\n        const rootElement = activeEditor.getRootElement();\n        updateToolbarState(\n          \"isImageCaption\",\n          !!rootElement?.parentElement?.classList.contains(\"image-caption-container\")\n        );\n      } else {\n        updateToolbarState(\"isImageCaption\", false);\n      }\n\n      const anchorNode = selection.anchor.getNode();\n      const element = $findTopLevelElement(anchorNode);\n      const elementKey = element.getKey();\n      const elementDOM = activeEditor.getElementByKey(elementKey);\n\n      updateToolbarState(\"isRTL\", $isParentElementRTL(selection));\n\n      // Update links\n      const node = getSelectedNode(selection);\n      const parent = node.getParent();\n      const isLink = $isLinkNode(parent) || $isLinkNode(node);\n      updateToolbarState(\"isLink\", isLink);\n\n      const tableNode = $findMatchingParent(node, $isTableNode);\n      if ($isTableNode(tableNode)) {\n        updateToolbarState(\"rootType\", \"table\");\n      } else {\n        updateToolbarState(\"rootType\", \"root\");\n      }\n\n      if (elementDOM !== null) {\n        if ($isListNode(element)) {\n          const parentList = $getNearestNodeOfType<ListNode>(anchorNode, ListNode);\n          const type = parentList ? parentList.getListType() : element.getListType();\n\n          updateToolbarState(\"blockType\", type);\n        } else {\n          $handleHeadingNode(element);\n        }\n      }\n\n      // Handle buttons\n      updateToolbarState(\n        \"fontColor\",\n        $getSelectionStyleValueForProperty(selection, \"color\", \"#000\")\n      );\n      updateToolbarState(\n        \"bgColor\",\n        $getSelectionStyleValueForProperty(selection, \"background-color\", \"#fff\")\n      );\n      updateToolbarState(\n        \"fontFamily\",\n        $getSelectionStyleValueForProperty(selection, \"font-family\", \"Arial\")\n      );\n      let matchingParent;\n      if ($isLinkNode(parent)) {\n        // If node is a link, we need to fetch the parent paragraph node to set format\n        matchingParent = $findMatchingParent(\n          node,\n          (parentNode) => $isElementNode(parentNode) && !parentNode.isInline()\n        );\n      }\n\n      // If matchingParent is a valid node, pass it's format type\n      updateToolbarState(\n        \"elementFormat\",\n        $isElementNode(matchingParent)\n          ? matchingParent.getFormatType()\n          : $isElementNode(node)\n            ? node.getFormatType()\n            : parent?.getFormatType() || \"left\"\n      );\n    }\n    if ($isRangeSelection(selection) || $isTableSelection(selection)) {\n      // Update text format\n      updateToolbarState(\"isBold\", selection.hasFormat(\"bold\"));\n      updateToolbarState(\"isItalic\", selection.hasFormat(\"italic\"));\n      updateToolbarState(\"isUnderline\", selection.hasFormat(\"underline\"));\n      updateToolbarState(\"isStrikethrough\", selection.hasFormat(\"strikethrough\"));\n      updateToolbarState(\"isSubscript\", selection.hasFormat(\"subscript\"));\n      updateToolbarState(\"isSuperscript\", selection.hasFormat(\"superscript\"));\n      updateToolbarState(\"isHighlight\", selection.hasFormat(\"highlight\"));\n      updateToolbarState(\"isCode\", selection.hasFormat(\"code\"));\n      updateToolbarState(\n        \"fontSize\",\n        $getSelectionStyleValueForProperty(selection, \"font-size\", \"15px\")\n      );\n      updateToolbarState(\"isLowercase\", selection.hasFormat(\"lowercase\"));\n      updateToolbarState(\"isUppercase\", selection.hasFormat(\"uppercase\"));\n      updateToolbarState(\"isCapitalize\", selection.hasFormat(\"capitalize\"));\n    }\n    if ($isNodeSelection(selection)) {\n      const nodes = selection.getNodes();\n      for (const selectedNode of nodes) {\n        const parentList = $getNearestNodeOfType<ListNode>(selectedNode, ListNode);\n        if (parentList) {\n          const type = parentList.getListType();\n          updateToolbarState(\"blockType\", type);\n        } else {\n          const selectedElement = $findTopLevelElement(selectedNode);\n          $handleHeadingNode(selectedElement);\n          // Update elementFormat for node selection (e.g., images)\n          if ($isElementNode(selectedElement)) {\n            updateToolbarState(\"elementFormat\", selectedElement.getFormatType());\n          }\n        }\n      }\n    }\n  }, [activeEditor, editor, updateToolbarState, $handleHeadingNode]);\n\n  useEffect(() => {\n    return editor.registerCommand(\n      SELECTION_CHANGE_COMMAND,\n      (_payload, newEditor) => {\n        setActiveEditor(newEditor);\n        $updateToolbar();\n        return false;\n      },\n      COMMAND_PRIORITY_CRITICAL\n    );\n  }, [editor, $updateToolbar, setActiveEditor]);\n\n  useEffect(() => {\n    activeEditor.getEditorState().read(\n      () => {\n        $updateToolbar();\n      },\n      { editor: activeEditor }\n    );\n  }, [activeEditor, $updateToolbar]);\n\n  useEffect(() => {\n    return mergeRegister(\n      editor.registerEditableListener((editable) => {\n        setIsEditable(editable);\n      }),\n      activeEditor.registerUpdateListener(({ editorState }) => {\n        editorState.read(\n          () => {\n            $updateToolbar();\n          },\n          { editor: activeEditor }\n        );\n      }),\n      activeEditor.registerCommand<boolean>(\n        CAN_UNDO_COMMAND,\n        (payload) => {\n          updateToolbarState(\"canUndo\", payload);\n          return false;\n        },\n        COMMAND_PRIORITY_CRITICAL\n      ),\n      activeEditor.registerCommand<boolean>(\n        CAN_REDO_COMMAND,\n        (payload) => {\n          updateToolbarState(\"canRedo\", payload);\n          return false;\n        },\n        COMMAND_PRIORITY_CRITICAL\n      )\n    );\n  }, [$updateToolbar, activeEditor, editor, updateToolbarState]);\n\n  const applyStyleText = useCallback(\n    (styles: Record<string, string>, skipHistoryStack?: boolean, skipRefocus: boolean = false) => {\n      activeEditor.update(\n        () => {\n          if (skipRefocus) {\n            $addUpdateTag(SKIP_DOM_SELECTION_TAG);\n          }\n          const selection = $getSelection();\n          if (selection !== null) {\n            $patchStyleText(selection, styles);\n          }\n        },\n        skipHistoryStack ? { tag: HISTORIC_TAG } : {}\n      );\n    },\n    [activeEditor]\n  );\n\n  const onFontColorSelect = useCallback(\n    (value: string, skipHistoryStack: boolean, skipRefocus: boolean) => {\n      applyStyleText({ color: value }, skipHistoryStack, skipRefocus);\n    },\n    [applyStyleText]\n  );\n\n  const onBgColorSelect = useCallback(\n    (value: string, skipHistoryStack: boolean, skipRefocus: boolean) => {\n      applyStyleText({ \"background-color\": value }, skipHistoryStack, skipRefocus);\n    },\n    [applyStyleText]\n  );\n\n  const insertLink = useCallback(() => {\n    if (!toolbarState.isLink) {\n      setIsLinkEditMode(true);\n      activeEditor.dispatchCommand(TOGGLE_LINK_COMMAND, sanitizeUrl(\"https://\"));\n    } else {\n      setIsLinkEditMode(false);\n      activeEditor.dispatchCommand(TOGGLE_LINK_COMMAND, null);\n    }\n  }, [activeEditor, setIsLinkEditMode, toolbarState.isLink]);\n\n  const canViewerSeeInsertDropdown = !toolbarState.isImageCaption;\n  const canViewerSeeInsertCodeButton = !toolbarState.isImageCaption;\n\n  return (\n    <div className=\"toolbar\">\n      <button\n        disabled={!toolbarState.canUndo || !isEditable}\n        onClick={(e) => dispatchToolbarCommand(UNDO_COMMAND, undefined, isKeyboardInput(e))}\n        title={IS_APPLE ? \"Undo (⌘Z)\" : \"Undo (Ctrl+Z)\"}\n        type=\"button\"\n        className=\"toolbar-item spaced\"\n        aria-label=\"Undo\"\n      >\n        <i className=\"format undo\" />\n      </button>\n      <button\n        disabled={!toolbarState.canRedo || !isEditable}\n        onClick={(e) => dispatchToolbarCommand(REDO_COMMAND, undefined, isKeyboardInput(e))}\n        title={IS_APPLE ? \"Redo (⇧⌘Z)\" : \"Redo (Ctrl+Y)\"}\n        type=\"button\"\n        className=\"toolbar-item\"\n        aria-label=\"Redo\"\n      >\n        <i className=\"format redo\" />\n      </button>\n      <Divider />\n      {toolbarState.blockType in blockTypeToBlockName && activeEditor === editor && (\n        <>\n          <BlockFormatDropDown\n            disabled={!isEditable}\n            blockType={toolbarState.blockType}\n            rootType={toolbarState.rootType}\n            editor={activeEditor}\n          />\n          <Divider />\n        </>\n      )}\n\n      <>\n        <FontDropDown\n          disabled={!isEditable}\n          style={\"font-family\"}\n          value={toolbarState.fontFamily}\n          editor={activeEditor}\n        />\n        <Divider />\n        <FontSize\n          selectionFontSize={parseFontSizeForToolbar(toolbarState.fontSize).slice(0, -2)}\n          editor={activeEditor}\n          disabled={!isEditable}\n        />\n        <Divider />\n        <button\n          disabled={!isEditable}\n          onClick={(e) => dispatchFormatTextCommand(\"bold\", isKeyboardInput(e))}\n          className={\"toolbar-item spaced \" + (toolbarState.isBold ? \"active\" : \"\")}\n          type=\"button\"\n        >\n          <i className=\"format bold\" />\n        </button>\n        <button\n          disabled={!isEditable}\n          onClick={(e) => dispatchFormatTextCommand(\"italic\", isKeyboardInput(e))}\n          className={\"toolbar-item spaced \" + (toolbarState.isItalic ? \"active\" : \"\")}\n          type=\"button\"\n        >\n          <i className=\"format italic\" />\n        </button>\n        <button\n          disabled={!isEditable}\n          onClick={(e) => dispatchFormatTextCommand(\"underline\", isKeyboardInput(e))}\n          className={\"toolbar-item spaced \" + (toolbarState.isUnderline ? \"active\" : \"\")}\n          type=\"button\"\n        >\n          <i className=\"format underline\" />\n        </button>\n        {canViewerSeeInsertCodeButton && (\n          <button\n            disabled={!isEditable}\n            onClick={(e) => dispatchFormatTextCommand(\"code\", isKeyboardInput(e))}\n            className={\"toolbar-item spaced \" + (toolbarState.isCode ? \"active\" : \"\")}\n            type=\"button\"\n          >\n            <i className=\"format code\" />\n          </button>\n        )}\n        <button\n          disabled={!isEditable}\n          onClick={insertLink}\n          className={\"toolbar-item spaced \" + (toolbarState.isLink ? \"active\" : \"\")}\n          aria-label=\"Insert link\"\n          type=\"button\"\n        >\n          <i className=\"format link\" />\n        </button>\n        <DropdownColorPicker\n          disabled={!isEditable}\n          buttonClassName=\"toolbar-item color-picker\"\n          buttonAriaLabel=\"Formatting text color\"\n          buttonIconClassName=\"icon font-color\"\n          color={toolbarState.fontColor}\n          onChange={onFontColorSelect}\n          title=\"text color\"\n        />\n        <DropdownColorPicker\n          disabled={!isEditable}\n          buttonClassName=\"toolbar-item color-picker\"\n          buttonAriaLabel=\"Formatting background color\"\n          buttonIconClassName=\"icon bg-color\"\n          color={toolbarState.bgColor}\n          onChange={onBgColorSelect}\n          title=\"bg color\"\n        />\n        <DropDown\n          disabled={!isEditable}\n          buttonClassName=\"toolbar-item spaced\"\n          buttonLabel=\"\"\n          buttonAriaLabel=\"Formatting options for additional text styles\"\n          buttonIconClassName=\"icon dropdown-more\"\n        >\n          <DropDownItem\n            onClick={(e) => dispatchFormatTextCommand(\"lowercase\", isKeyboardInput(e))}\n            className={\"item wide \" + dropDownActiveClass(toolbarState.isLowercase)}\n            title=\"Lowercase\"\n            aria-label=\"Format text to lowercase\"\n          >\n            <div className=\"icon-text-container\">\n              <i className=\"icon lowercase\" />\n              <span className=\"text\">Lowercase</span>\n            </div>\n          </DropDownItem>\n          <DropDownItem\n            onClick={(e) => dispatchFormatTextCommand(\"uppercase\", isKeyboardInput(e))}\n            className={\"item wide \" + dropDownActiveClass(toolbarState.isUppercase)}\n          >\n            <div className=\"icon-text-container\">\n              <i className=\"icon uppercase\" />\n              <span className=\"text\">Uppercase</span>\n            </div>\n          </DropDownItem>\n          <DropDownItem\n            onClick={(e) => dispatchFormatTextCommand(\"capitalize\", isKeyboardInput(e))}\n            className={\"item wide \" + dropDownActiveClass(toolbarState.isCapitalize)}\n            title=\"Capitalize\"\n            aria-label=\"Format text to capitalize\"\n          >\n            <div className=\"icon-text-container\">\n              <i className=\"icon capitalize\" />\n              <span className=\"text\">Capitalize</span>\n            </div>\n          </DropDownItem>\n          <DropDownItem\n            onClick={(e) => dispatchFormatTextCommand(\"strikethrough\", isKeyboardInput(e))}\n            className={\"item wide \" + dropDownActiveClass(toolbarState.isStrikethrough)}\n            title=\"Strikethrough\"\n            aria-label=\"Format text with a strikethrough\"\n          >\n            <div className=\"icon-text-container\">\n              <i className=\"icon strikethrough\" />\n              <span className=\"text\">Strikethrough</span>\n            </div>\n          </DropDownItem>\n          <DropDownItem\n            onClick={(e) => dispatchFormatTextCommand(\"subscript\", isKeyboardInput(e))}\n            className={\"item wide \" + dropDownActiveClass(toolbarState.isSubscript)}\n            title=\"Subscript\"\n            aria-label=\"Format text with a subscript\"\n          >\n            <div className=\"icon-text-container\">\n              <i className=\"icon subscript\" />\n              <span className=\"text\">Subscript</span>\n            </div>\n          </DropDownItem>\n          <DropDownItem\n            onClick={(e) => dispatchFormatTextCommand(\"superscript\", isKeyboardInput(e))}\n            className={\"item wide \" + dropDownActiveClass(toolbarState.isSuperscript)}\n            title=\"Superscript\"\n            aria-label=\"Format text with a superscript\"\n          >\n            <div className=\"icon-text-container\">\n              <i className=\"icon superscript\" />\n              <span className=\"text\">Superscript</span>\n            </div>\n          </DropDownItem>\n          <DropDownItem\n            onClick={(e) => dispatchFormatTextCommand(\"highlight\", isKeyboardInput(e))}\n            className={\"item wide \" + dropDownActiveClass(toolbarState.isHighlight)}\n            title=\"Highlight\"\n            aria-label=\"Format text with a highlight\"\n          >\n            <div className=\"icon-text-container\">\n              <i className=\"icon highlight\" />\n              <span className=\"text\">Highlight</span>\n            </div>\n          </DropDownItem>\n          <DropDownItem\n            onClick={(e) => clearFormatting(activeEditor, isKeyboardInput(e))}\n            className=\"item wide\"\n            title=\"Clear text formatting\"\n            aria-label=\"Clear all text formatting\"\n          >\n            <div className=\"icon-text-container\">\n              <i className=\"icon clear\" />\n              <span className=\"text\">Clear Formatting</span>\n            </div>\n          </DropDownItem>\n        </DropDown>\n        {canViewerSeeInsertDropdown && (\n          <>\n            <Divider />\n            <DropDown\n              disabled={!isEditable}\n              buttonClassName=\"toolbar-item spaced\"\n              buttonLabel=\"Insert\"\n              buttonAriaLabel=\"Insert specialized editor node\"\n              buttonIconClassName=\"icon plus\"\n            >\n              <DropDownItem\n                onClick={() => {\n                  showModal(\"Insert Image\", (onClose) => (\n                    <InsertImageDialog\n                      activeEditor={activeEditor}\n                      onClose={onClose}\n                      onUpload={onUpload}\n                    />\n                  ));\n                }}\n                className=\"item\"\n              >\n                <i className=\"icon image\" />\n                <span className=\"text\">Image</span>\n              </DropDownItem>\n              <DropDownItem\n                onClick={() => {\n                  showModal(\"Insert Table\", (onClose) => (\n                    <InsertTableDialog activeEditor={activeEditor} onClose={onClose} />\n                  ));\n                }}\n                className=\"item\"\n              >\n                <i className=\"icon table\" />\n                <span className=\"text\">Table</span>\n              </DropDownItem>\n              <DropDownItem\n                onClick={() => {\n                  showModal(\"Insert Columns Layout\", (onClose) => (\n                    <InsertLayoutDialog activeEditor={activeEditor} onClose={onClose} />\n                  ));\n                }}\n                className=\"item\"\n              >\n                <i className=\"icon columns\" />\n                <span className=\"text\">Columns Layout</span>\n              </DropDownItem>\n            </DropDown>\n          </>\n        )}\n      </>\n      <Divider />\n      <ElementFormatDropdown\n        disabled={!isEditable}\n        value={toolbarState.elementFormat}\n        editor={activeEditor}\n        isRTL={toolbarState.isRTL}\n      />\n\n      {modal}\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport * as React from \"react\";\n\nimport ColorPicker from \"./ColorPicker\";\nimport DropDown from \"./DropDown\";\n\ntype Props = {\n  disabled?: boolean;\n  buttonAriaLabel?: string;\n  buttonClassName: string;\n  buttonIconClassName?: string;\n  buttonLabel?: string;\n  title?: string;\n  stopCloseOnClickSelf?: boolean;\n  color: string;\n  onChange?: (color: string, skipHistoryStack: boolean, skipRefocus: boolean) => void;\n};\n\nexport default function DropdownColorPicker({\n  disabled = false,\n  stopCloseOnClickSelf = true,\n  color,\n  onChange,\n  ...rest\n}: Props) {\n  return (\n    <DropDown {...rest} disabled={disabled} stopCloseOnClickSelf={stopCloseOnClickSelf}>\n      <ColorPicker color={color} onChange={onChange} />\n    </DropDown>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport { LexicalEditor } from \"lexical\";\nimport * as React from \"react\";\nimport { useState } from \"react\";\n\nimport Button from \"../../ui/Button\";\nimport DropDown, { DropDownItem } from \"../../ui/DropDown\";\nimport { INSERT_LAYOUT_COMMAND } from \"./LayoutPlugin\";\n\nconst LAYOUTS = [\n  { label: \"2 columns (equal width)\", value: \"1fr 1fr\" },\n  { label: \"2 columns (25% - 75%)\", value: \"1fr 3fr\" },\n  { label: \"3 columns (equal width)\", value: \"1fr 1fr 1fr\" },\n  { label: \"3 columns (25% - 50% - 25%)\", value: \"1fr 2fr 1fr\" },\n  { label: \"4 columns (equal width)\", value: \"1fr 1fr 1fr 1fr\" },\n];\n\nexport default function InsertLayoutDialog({\n  activeEditor,\n  onClose,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  const [layout, setLayout] = useState(LAYOUTS[0].value);\n  const buttonLabel = LAYOUTS.find((item) => item.value === layout)?.label;\n\n  const onClick = () => {\n    activeEditor.dispatchCommand(INSERT_LAYOUT_COMMAND, layout);\n    onClose();\n  };\n\n  return (\n    <>\n      <DropDown buttonClassName=\"toolbar-item dialog-dropdown\" buttonLabel={buttonLabel}>\n        {LAYOUTS.map(({ label, value }) => (\n          <DropDownItem key={value} className=\"item\" onClick={() => setLayout(value)}>\n            <span className=\"text\">{label}</span>\n          </DropDownItem>\n        ))}\n      </DropDown>\n      <Button onClick={onClick}>Insert</Button>\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { ElementNode, LexicalCommand, LexicalNode, NodeKey } from \"lexical\";\n\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { $findMatchingParent, $insertNodeToNearestRoot, mergeRegister } from \"@lexical/utils\";\nimport {\n  $createParagraphNode,\n  $getNodeByKey,\n  $getSelection,\n  $isRangeSelection,\n  COMMAND_PRIORITY_EDITOR,\n  COMMAND_PRIORITY_LOW,\n  createCommand,\n  KEY_ARROW_DOWN_COMMAND,\n  KEY_ARROW_LEFT_COMMAND,\n  KEY_ARROW_RIGHT_COMMAND,\n  KEY_ARROW_UP_COMMAND,\n} from \"lexical\";\nimport { useEffect } from \"react\";\n\nimport {\n  $createLayoutContainerNode,\n  $isLayoutContainerNode,\n  LayoutContainerNode,\n} from \"../../nodes/LayoutContainerNode\";\nimport {\n  $createLayoutItemNode,\n  $isLayoutItemNode,\n  LayoutItemNode,\n} from \"../../nodes/LayoutItemNode\";\n\nexport const INSERT_LAYOUT_COMMAND: LexicalCommand<string> = createCommand<string>();\n\nexport const UPDATE_LAYOUT_COMMAND: LexicalCommand<{\n  template: string;\n  nodeKey: NodeKey;\n}> = createCommand<{ template: string; nodeKey: NodeKey }>();\n\nexport function LayoutPlugin(): null {\n  const [editor] = useLexicalComposerContext();\n  useEffect(() => {\n    if (!editor.hasNodes([LayoutContainerNode, LayoutItemNode])) {\n      throw new Error(\n        \"LayoutPlugin: LayoutContainerNode, or LayoutItemNode not registered on editor\"\n      );\n    }\n\n    const $onEscape = (before: boolean) => {\n      const selection = $getSelection();\n      if (\n        $isRangeSelection(selection) &&\n        selection.isCollapsed() &&\n        selection.anchor.offset === 0\n      ) {\n        const container = $findMatchingParent(selection.anchor.getNode(), $isLayoutContainerNode);\n\n        if ($isLayoutContainerNode(container)) {\n          const parent = container.getParent<ElementNode>();\n          const child =\n            parent &&\n            (before ? parent.getFirstChild<LexicalNode>() : parent?.getLastChild<LexicalNode>());\n          const descendant = before\n            ? container.getFirstDescendant<LexicalNode>()?.getKey()\n            : container.getLastDescendant<LexicalNode>()?.getKey();\n\n          if (parent !== null && child === container && selection.anchor.key === descendant) {\n            if (before) {\n              container.insertBefore($createParagraphNode());\n            } else {\n              container.insertAfter($createParagraphNode());\n            }\n          }\n        }\n      }\n\n      return false;\n    };\n\n    const $fillLayoutItemIfEmpty = (node: LayoutItemNode) => {\n      if (node.isEmpty()) {\n        node.append($createParagraphNode());\n      }\n    };\n\n    const $removeIsolatedLayoutItem = (node: LayoutItemNode): boolean => {\n      const parent = node.getParent<ElementNode>();\n      if (!$isLayoutContainerNode(parent)) {\n        const children = node.getChildren<LexicalNode>();\n        for (const child of children) {\n          node.insertBefore(child);\n        }\n        node.remove();\n        return true;\n      }\n      return false;\n    };\n\n    return mergeRegister(\n      // When layout is the last child pressing down/right arrow will insert paragraph\n      // below it to allow adding more content. It's similar what $insertBlockNode\n      // (mainly for decorators), except it'll always be possible to continue adding\n      // new content even if trailing paragraph is accidentally deleted\n      editor.registerCommand(KEY_ARROW_DOWN_COMMAND, () => $onEscape(false), COMMAND_PRIORITY_LOW),\n      editor.registerCommand(KEY_ARROW_RIGHT_COMMAND, () => $onEscape(false), COMMAND_PRIORITY_LOW),\n      // When layout is the first child pressing up/left arrow will insert paragraph\n      // above it to allow adding more content. It's similar what $insertBlockNode\n      // (mainly for decorators), except it'll always be possible to continue adding\n      // new content even if leading paragraph is accidentally deleted\n      editor.registerCommand(KEY_ARROW_UP_COMMAND, () => $onEscape(true), COMMAND_PRIORITY_LOW),\n      editor.registerCommand(KEY_ARROW_LEFT_COMMAND, () => $onEscape(true), COMMAND_PRIORITY_LOW),\n      editor.registerCommand(\n        INSERT_LAYOUT_COMMAND,\n        (template) => {\n          editor.update(() => {\n            const container = $createLayoutContainerNode(template);\n            const itemsCount = getItemsCountFromTemplate(template);\n\n            for (let i = 0; i < itemsCount; i++) {\n              container.append($createLayoutItemNode().append($createParagraphNode()));\n            }\n\n            $insertNodeToNearestRoot(container);\n            container.selectStart();\n          });\n\n          return true;\n        },\n        COMMAND_PRIORITY_EDITOR\n      ),\n      editor.registerCommand(\n        UPDATE_LAYOUT_COMMAND,\n        ({ template, nodeKey }) => {\n          editor.update(() => {\n            const container = $getNodeByKey<LexicalNode>(nodeKey);\n\n            if (!$isLayoutContainerNode(container)) {\n              return;\n            }\n\n            const itemsCount = getItemsCountFromTemplate(template);\n            const prevItemsCount = getItemsCountFromTemplate(container.getTemplateColumns());\n\n            // Add or remove extra columns if new template does not match existing one\n            if (itemsCount > prevItemsCount) {\n              for (let i = prevItemsCount; i < itemsCount; i++) {\n                container.append($createLayoutItemNode().append($createParagraphNode()));\n              }\n            } else if (itemsCount < prevItemsCount) {\n              for (let i = prevItemsCount - 1; i >= itemsCount; i--) {\n                const layoutItem = container.getChildAtIndex<LexicalNode>(i);\n\n                if ($isLayoutItemNode(layoutItem)) {\n                  layoutItem.remove();\n                }\n              }\n            }\n\n            container.setTemplateColumns(template);\n          });\n\n          return true;\n        },\n        COMMAND_PRIORITY_EDITOR\n      ),\n\n      editor.registerNodeTransform(LayoutItemNode, (node) => {\n        // Structure enforcing transformers for each node type. In case nesting structure is not\n        // \"Container > Item\" it'll unwrap nodes and convert it back\n        // to regular content.\n        const isRemoved = $removeIsolatedLayoutItem(node);\n\n        if (!isRemoved) {\n          // Layout item should always have a child. this function will listen\n          // for any empty layout item and fill it with a paragraph node\n          $fillLayoutItemIfEmpty(node);\n        }\n      }),\n      editor.registerNodeTransform(LayoutContainerNode, (node) => {\n        const children = node.getChildren<LexicalNode>();\n        if (!children.every($isLayoutItemNode)) {\n          for (const child of children) {\n            node.insertBefore(child);\n          }\n          node.remove();\n        }\n      })\n    );\n  }, [editor]);\n\n  return null;\n}\n\nfunction getItemsCountFromTemplate(template: string): number {\n  return template.trim().split(/\\s+/).length;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  DOMConversionMap,\n  DOMConversionOutput,\n  DOMExportOutput,\n  EditorConfig,\n  LexicalNode,\n  LexicalUpdateJSON,\n  NodeKey,\n  SerializedElementNode,\n  Spread,\n} from \"lexical\";\n\nimport { addClassNamesToElement } from \"@lexical/utils\";\nimport { ElementNode } from \"lexical\";\n\nexport type SerializedLayoutContainerNode = Spread<\n  {\n    templateColumns: string;\n  },\n  SerializedElementNode\n>;\n\nfunction $convertLayoutContainerElement(domNode: HTMLElement): DOMConversionOutput | null {\n  const styleAttributes = window.getComputedStyle(domNode);\n  const templateColumns = styleAttributes.getPropertyValue(\"grid-template-columns\");\n  if (templateColumns) {\n    const node = $createLayoutContainerNode(templateColumns);\n    return { node };\n  }\n  return null;\n}\n\nexport class LayoutContainerNode extends ElementNode {\n  __templateColumns: string;\n\n  constructor(templateColumns: string, key?: NodeKey) {\n    super(key);\n    this.__templateColumns = templateColumns;\n  }\n\n  static getType(): string {\n    return \"layout-container\";\n  }\n\n  static clone(node: LayoutContainerNode): LayoutContainerNode {\n    return new LayoutContainerNode(node.__templateColumns, node.__key);\n  }\n\n  createDOM(config: EditorConfig): HTMLElement {\n    const dom = document.createElement(\"div\");\n    dom.style.gridTemplateColumns = this.__templateColumns;\n    if (typeof config.theme.layoutContainer === \"string\") {\n      addClassNamesToElement(dom, config.theme.layoutContainer);\n    }\n    return dom;\n  }\n\n  exportDOM(): DOMExportOutput {\n    const element = document.createElement(\"div\");\n    element.style.gridTemplateColumns = this.__templateColumns;\n    element.setAttribute(\"data-lexical-layout-container\", \"true\");\n    return { element };\n  }\n\n  updateDOM(prevNode: this, dom: HTMLElement): boolean {\n    if (prevNode.__templateColumns !== this.__templateColumns) {\n      dom.style.gridTemplateColumns = this.__templateColumns;\n    }\n    return false;\n  }\n\n  static importDOM(): DOMConversionMap | null {\n    return {\n      div: (domNode: HTMLElement) => {\n        if (!domNode.hasAttribute(\"data-lexical-layout-container\")) {\n          return null;\n        }\n        return {\n          conversion: $convertLayoutContainerElement,\n          priority: 2,\n        };\n      },\n    };\n  }\n\n  static importJSON(json: SerializedLayoutContainerNode): LayoutContainerNode {\n    return $createLayoutContainerNode().updateFromJSON(json);\n  }\n\n  updateFromJSON(serializedNode: LexicalUpdateJSON<SerializedLayoutContainerNode>): this {\n    return super.updateFromJSON(serializedNode).setTemplateColumns(serializedNode.templateColumns);\n  }\n\n  isShadowRoot(): boolean {\n    return true;\n  }\n\n  canBeEmpty(): boolean {\n    return false;\n  }\n\n  exportJSON(): SerializedLayoutContainerNode {\n    return {\n      ...super.exportJSON(),\n      templateColumns: this.__templateColumns,\n    };\n  }\n\n  getTemplateColumns(): string {\n    return this.getLatest().__templateColumns;\n  }\n\n  setTemplateColumns(templateColumns: string): this {\n    const self = this.getWritable();\n    self.__templateColumns = templateColumns;\n    return self;\n  }\n}\n\nexport function $createLayoutContainerNode(templateColumns: string = \"\"): LayoutContainerNode {\n  return new LayoutContainerNode(templateColumns);\n}\n\nexport function $isLayoutContainerNode(\n  node: LexicalNode | null | undefined\n): node is LayoutContainerNode {\n  return node instanceof LayoutContainerNode;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  DOMConversionMap,\n  DOMConversionOutput,\n  EditorConfig,\n  LexicalNode,\n  SerializedElementNode,\n} from \"lexical\";\n\nimport { addClassNamesToElement } from \"@lexical/utils\";\nimport { $isParagraphNode, ElementNode } from \"lexical\";\n\nexport type SerializedLayoutItemNode = SerializedElementNode;\n\nfunction $convertLayoutItemElement(): DOMConversionOutput | null {\n  return { node: $createLayoutItemNode() };\n}\n\nexport function $isEmptyLayoutItemNode(node: LexicalNode): boolean {\n  if (!$isLayoutItemNode(node) || node.getChildrenSize() !== 1) {\n    return false;\n  }\n  const firstChild = node.getFirstChild();\n  return $isParagraphNode(firstChild) && firstChild.isEmpty();\n}\n\nexport class LayoutItemNode extends ElementNode {\n  static getType(): string {\n    return \"layout-item\";\n  }\n\n  static clone(node: LayoutItemNode): LayoutItemNode {\n    return new LayoutItemNode(node.__key);\n  }\n\n  createDOM(config: EditorConfig): HTMLElement {\n    const dom = document.createElement(\"div\");\n    dom.setAttribute(\"data-lexical-layout-item\", \"true\");\n    if (typeof config.theme.layoutItem === \"string\") {\n      addClassNamesToElement(dom, config.theme.layoutItem);\n    }\n    return dom;\n  }\n\n  updateDOM(): boolean {\n    return false;\n  }\n\n  collapseAtStart(): boolean {\n    const parent = this.getParentOrThrow();\n    if (this.is(parent.getFirstChild()) && parent.getChildren().every($isEmptyLayoutItemNode)) {\n      parent.remove();\n      return true;\n    }\n    return false;\n  }\n\n  static importDOM(): DOMConversionMap | null {\n    return {\n      div: (domNode: HTMLElement) => {\n        if (!domNode.hasAttribute(\"data-lexical-layout-item\")) {\n          return null;\n        }\n        return {\n          conversion: $convertLayoutItemElement,\n          priority: 2,\n        };\n      },\n    };\n  }\n\n  static importJSON(serializedNode: SerializedLayoutItemNode): LayoutItemNode {\n    return $createLayoutItemNode().updateFromJSON(serializedNode);\n  }\n\n  isShadowRoot(): boolean {\n    return true;\n  }\n}\n\nexport function $createLayoutItemNode(): LayoutItemNode {\n  return new LayoutItemNode();\n}\n\nexport function $isLayoutItemNode(node: LexicalNode | null | undefined): node is LayoutItemNode {\n  return node instanceof LayoutItemNode;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { JSX } from \"react\";\n\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { INSERT_TABLE_COMMAND, TableCellNode, TableNode, TableRowNode } from \"@lexical/table\";\nimport { EditorThemeClasses, Klass, LexicalEditor, LexicalNode } from \"lexical\";\nimport { createContext, useContext, useEffect, useMemo, useState } from \"react\";\n\nimport Button from \"../ui/Button\";\nimport { DialogActions } from \"../ui/Dialog\";\nimport TextInput from \"../ui/TextInput\";\n\nexport type InsertTableCommandPayload = Readonly<{\n  columns: string;\n  rows: string;\n  includeHeaders?: boolean;\n}>;\n\nexport type CellContextShape = {\n  cellEditorConfig: null | CellEditorConfig;\n  cellEditorPlugins: null | JSX.Element | Array<JSX.Element>;\n  set: (\n    cellEditorConfig: null | CellEditorConfig,\n    cellEditorPlugins: null | JSX.Element | Array<JSX.Element>\n  ) => void;\n};\n\nexport type CellEditorConfig = Readonly<{\n  namespace: string;\n  nodes?: ReadonlyArray<Klass<LexicalNode>>;\n  onError: (error: Error, editor: LexicalEditor) => void;\n  readOnly?: boolean;\n  theme?: EditorThemeClasses;\n}>;\n\nexport const CellContext = createContext<CellContextShape>({\n  cellEditorConfig: null,\n  cellEditorPlugins: null,\n  set: () => {\n    // Empty\n  },\n});\n\nexport function TableContext({ children }: { children: JSX.Element }) {\n  const [contextValue, setContextValue] = useState<{\n    cellEditorConfig: null | CellEditorConfig;\n    cellEditorPlugins: null | JSX.Element | Array<JSX.Element>;\n  }>({\n    cellEditorConfig: null,\n    cellEditorPlugins: null,\n  });\n  return (\n    <CellContext.Provider\n      value={useMemo(\n        () => ({\n          cellEditorConfig: contextValue.cellEditorConfig,\n          cellEditorPlugins: contextValue.cellEditorPlugins,\n          set: (cellEditorConfig, cellEditorPlugins) => {\n            setContextValue({ cellEditorConfig, cellEditorPlugins });\n          },\n        }),\n        [contextValue.cellEditorConfig, contextValue.cellEditorPlugins]\n      )}\n    >\n      {children}\n    </CellContext.Provider>\n  );\n}\n\nexport function InsertTableDialog({\n  activeEditor,\n  onClose,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  const [rows, setRows] = useState(\"5\");\n  const [columns, setColumns] = useState(\"5\");\n  const [isDisabled, setIsDisabled] = useState(true);\n\n  useEffect(() => {\n    const row = Number(rows);\n    const column = Number(columns);\n    if (row && row > 0 && row <= 500 && column && column > 0 && column <= 50) {\n      setIsDisabled(false);\n    } else {\n      setIsDisabled(true);\n    }\n  }, [rows, columns]);\n\n  const onClick = () => {\n    activeEditor.dispatchCommand(INSERT_TABLE_COMMAND, {\n      columns,\n      rows,\n    });\n\n    onClose();\n  };\n\n  return (\n    <>\n      <TextInput\n        placeholder={\"# of rows (1-500)\"}\n        label=\"Rows\"\n        onChange={setRows}\n        value={rows}\n        data-test-id=\"table-modal-rows\"\n        type=\"number\"\n      />\n      <TextInput\n        placeholder={\"# of columns (1-50)\"}\n        label=\"Columns\"\n        onChange={setColumns}\n        value={columns}\n        data-test-id=\"table-modal-columns\"\n        type=\"number\"\n      />\n      <DialogActions data-test-id=\"table-model-confirm-insert\">\n        <Button disabled={isDisabled} onClick={onClick}>\n          Confirm\n        </Button>\n      </DialogActions>\n    </>\n  );\n}\n\nexport function TablePlugin({\n  cellEditorConfig,\n  children,\n}: {\n  cellEditorConfig: CellEditorConfig;\n  children: JSX.Element | Array<JSX.Element>;\n}): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n  const cellContext = useContext(CellContext);\n  useEffect(() => {\n    if (!editor.hasNodes([TableNode, TableRowNode, TableCellNode])) {\n      throw new Error(\n        \"TablePlugin: TableNode, TableRowNode, or TableCellNode is not registered on editor\"\n      );\n    }\n  }, [editor]);\n  useEffect(() => {\n    cellContext.set(cellEditorConfig, children);\n  }, [cellContext, cellEditorConfig, children]);\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport \"./fontSize.css\";\n\nimport { LexicalEditor } from \"lexical\";\nimport * as React from \"react\";\n\nimport { MAX_ALLOWED_FONT_SIZE, MIN_ALLOWED_FONT_SIZE } from \"../../context/ToolbarContext\";\nimport { isKeyboardInput } from \"../../utils/focusUtils\";\nimport { updateFontSize, updateFontSizeInSelection, UpdateFontSizeType } from \"./utils\";\n\nfunction parseFontSize(input: string): [number, string] | null {\n  const match = input.match(/^(\\d+(?:\\.\\d+)?)(px|pt)$/);\n  return match ? [Number(match[1]), match[2]] : null;\n}\n\nfunction normalizeToPx(fontSize: number, unit: string): number {\n  return unit === \"pt\" ? Math.round((fontSize * 4) / 3) : fontSize;\n}\n\nfunction isValidFontSize(fontSizePx: number): boolean {\n  return fontSizePx >= MIN_ALLOWED_FONT_SIZE && fontSizePx <= MAX_ALLOWED_FONT_SIZE;\n}\n\nexport function parseFontSizeForToolbar(input: string): string {\n  const parsed = parseFontSize(input);\n  if (!parsed) {\n    return \"\";\n  }\n\n  const [fontSize, unit] = parsed;\n  const fontSizePx = normalizeToPx(fontSize, unit);\n  return `${fontSizePx}px`;\n}\n\nexport function parseAllowedFontSize(input: string): string {\n  const parsed = parseFontSize(input);\n  if (!parsed) {\n    return \"\";\n  }\n\n  const [fontSize, unit] = parsed;\n  const fontSizePx = normalizeToPx(fontSize, unit);\n  return isValidFontSize(fontSizePx) ? input : \"\";\n}\n\nexport default function FontSize({\n  selectionFontSize,\n  disabled,\n  editor,\n}: {\n  selectionFontSize: string;\n  disabled: boolean;\n  editor: LexicalEditor;\n}) {\n  const [inputValue, setInputValue] = React.useState<string>(selectionFontSize);\n  const [inputChangeFlag, setInputChangeFlag] = React.useState<boolean>(false);\n  const [isMouseMode, setIsMouseMode] = React.useState(false);\n\n  const handleKeyPress = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    const inputValueNumber = Number(inputValue);\n\n    if (e.key === \"Tab\") {\n      return;\n    }\n    if ([\"e\", \"E\", \"+\", \"-\"].includes(e.key) || isNaN(inputValueNumber)) {\n      e.preventDefault();\n      setInputValue(\"\");\n      return;\n    }\n    setInputChangeFlag(true);\n    if (e.key === \"Enter\" || e.key === \"Escape\") {\n      e.preventDefault();\n\n      updateFontSizeByInputValue(inputValueNumber, !isMouseMode);\n    }\n  };\n\n  const handleInputBlur = () => {\n    setIsMouseMode(false);\n\n    if (inputValue !== \"\" && inputChangeFlag) {\n      const inputValueNumber = Number(inputValue);\n      updateFontSizeByInputValue(inputValueNumber);\n    }\n  };\n\n  const handleClick = () => {\n    setIsMouseMode(true);\n  };\n\n  const updateFontSizeByInputValue = (inputValueNumber: number, skipRefocus: boolean = false) => {\n    let updatedFontSize = inputValueNumber;\n    if (inputValueNumber > MAX_ALLOWED_FONT_SIZE) {\n      updatedFontSize = MAX_ALLOWED_FONT_SIZE;\n    } else if (inputValueNumber < MIN_ALLOWED_FONT_SIZE) {\n      updatedFontSize = MIN_ALLOWED_FONT_SIZE;\n    }\n\n    setInputValue(String(updatedFontSize));\n    updateFontSizeInSelection(editor, String(updatedFontSize) + \"px\", null, skipRefocus);\n    setInputChangeFlag(false);\n  };\n\n  React.useEffect(() => {\n    setInputValue(selectionFontSize);\n  }, [selectionFontSize]);\n\n  return (\n    <>\n      <button\n        type=\"button\"\n        disabled={\n          disabled || (selectionFontSize !== \"\" && Number(inputValue) <= MIN_ALLOWED_FONT_SIZE)\n        }\n        onClick={(e) => {\n          updateFontSize(editor, UpdateFontSizeType.decrement, inputValue, isKeyboardInput(e));\n        }}\n        className=\"toolbar-item font-decrement\"\n        aria-label=\"Decrease font size\"\n      >\n        <i className=\"format minus-icon\" />\n      </button>\n\n      <input\n        type=\"number\"\n        title=\"Font size\"\n        value={inputValue}\n        disabled={disabled}\n        className=\"toolbar-item font-size-input\"\n        min={MIN_ALLOWED_FONT_SIZE}\n        max={MAX_ALLOWED_FONT_SIZE}\n        onChange={(e) => setInputValue(e.target.value)}\n        onClick={handleClick}\n        onKeyDown={handleKeyPress}\n        onBlur={handleInputBlur}\n      />\n\n      <button\n        type=\"button\"\n        disabled={\n          disabled || (selectionFontSize !== \"\" && Number(inputValue) >= MAX_ALLOWED_FONT_SIZE)\n        }\n        onClick={(e) => {\n          updateFontSize(editor, UpdateFontSizeType.increment, inputValue, isKeyboardInput(e));\n        }}\n        className=\"toolbar-item font-increment\"\n        aria-label=\"Increase font size\"\n      >\n        <i className=\"format add-icon\" />\n      </button>\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nconst mod = await (process.env.NODE_ENV !== 'production' ? import('./LexicalCode.dev.mjs') : import('./LexicalCode.prod.mjs'));\nexport const $createCodeHighlightNode = mod.$createCodeHighlightNode;\nexport const $createCodeNode = mod.$createCodeNode;\nexport const $getCodeLineDirection = mod.$getCodeLineDirection;\nexport const $getEndOfCodeInLine = mod.$getEndOfCodeInLine;\nexport const $getFirstCodeNodeOfLine = mod.$getFirstCodeNodeOfLine;\nexport const $getLastCodeNodeOfLine = mod.$getLastCodeNodeOfLine;\nexport const $getStartOfCodeInLine = mod.$getStartOfCodeInLine;\nexport const $isCodeHighlightNode = mod.$isCodeHighlightNode;\nexport const $isCodeNode = mod.$isCodeNode;\nexport const CODE_LANGUAGE_FRIENDLY_NAME_MAP = mod.CODE_LANGUAGE_FRIENDLY_NAME_MAP;\nexport const CODE_LANGUAGE_MAP = mod.CODE_LANGUAGE_MAP;\nexport const CodeExtension = mod.CodeExtension;\nexport const CodeHighlightNode = mod.CodeHighlightNode;\nexport const CodeNode = mod.CodeNode;\nexport const DEFAULT_CODE_LANGUAGE = mod.DEFAULT_CODE_LANGUAGE;\nexport const PrismTokenizer = mod.PrismTokenizer;\nexport const getCodeLanguageOptions = mod.getCodeLanguageOptions;\nexport const getCodeLanguages = mod.getCodeLanguages;\nexport const getCodeThemeOptions = mod.getCodeThemeOptions;\nexport const getDefaultCodeLanguage = mod.getDefaultCodeLanguage;\nexport const getEndOfCodeInLine = mod.getEndOfCodeInLine;\nexport const getFirstCodeNodeOfLine = mod.getFirstCodeNodeOfLine;\nexport const getLanguageFriendlyName = mod.getLanguageFriendlyName;\nexport const getLastCodeNodeOfLine = mod.getLastCodeNodeOfLine;\nexport const getStartOfCodeInLine = mod.getStartOfCodeInLine;\nexport const normalizeCodeLang = mod.normalizeCodeLang;\nexport const normalizeCodeLanguage = mod.normalizeCodeLanguage;\nexport const registerCodeHighlighting = mod.registerCodeHighlighting;","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport { $createCodeNode } from \"@lexical/code\";\nimport {\n  INSERT_CHECK_LIST_COMMAND,\n  INSERT_ORDERED_LIST_COMMAND,\n  INSERT_UNORDERED_LIST_COMMAND,\n} from \"@lexical/list\";\nimport { $isDecoratorBlockNode } from \"@lexical/react/LexicalDecoratorBlockNode\";\nimport {\n  $createHeadingNode,\n  $createQuoteNode,\n  $isHeadingNode,\n  $isQuoteNode,\n  HeadingTagType,\n} from \"@lexical/rich-text\";\nimport { $patchStyleText, $setBlocksType } from \"@lexical/selection\";\nimport { $isTableSelection } from \"@lexical/table\";\nimport { $getNearestBlockElementAncestorOrThrow } from \"@lexical/utils\";\nimport {\n  $addUpdateTag,\n  $createParagraphNode,\n  $getSelection,\n  $isRangeSelection,\n  $isTextNode,\n  LexicalEditor,\n  SKIP_DOM_SELECTION_TAG,\n  SKIP_SELECTION_FOCUS_TAG,\n} from \"lexical\";\n\nimport {\n  DEFAULT_FONT_SIZE,\n  MAX_ALLOWED_FONT_SIZE,\n  MIN_ALLOWED_FONT_SIZE,\n} from \"../../context/ToolbarContext\";\n\nexport enum UpdateFontSizeType {\n  increment = 1,\n  decrement,\n}\n\n/**\n * Calculates the new font size based on the update type.\n * @param currentFontSize - The current font size\n * @param updateType - The type of change, either increment or decrement\n * @returns the next font size\n */\nexport const calculateNextFontSize = (\n  currentFontSize: number,\n  updateType: UpdateFontSizeType | null\n) => {\n  if (!updateType) {\n    return currentFontSize;\n  }\n\n  let updatedFontSize: number = currentFontSize;\n  switch (updateType) {\n    case UpdateFontSizeType.decrement:\n      switch (true) {\n        case currentFontSize > MAX_ALLOWED_FONT_SIZE:\n          updatedFontSize = MAX_ALLOWED_FONT_SIZE;\n          break;\n        case currentFontSize >= 48:\n          updatedFontSize -= 12;\n          break;\n        case currentFontSize >= 24:\n          updatedFontSize -= 4;\n          break;\n        case currentFontSize >= 14:\n          updatedFontSize -= 2;\n          break;\n        case currentFontSize >= 9:\n          updatedFontSize -= 1;\n          break;\n        default:\n          updatedFontSize = MIN_ALLOWED_FONT_SIZE;\n          break;\n      }\n      break;\n\n    case UpdateFontSizeType.increment:\n      switch (true) {\n        case currentFontSize < MIN_ALLOWED_FONT_SIZE:\n          updatedFontSize = MIN_ALLOWED_FONT_SIZE;\n          break;\n        case currentFontSize < 12:\n          updatedFontSize += 1;\n          break;\n        case currentFontSize < 20:\n          updatedFontSize += 2;\n          break;\n        case currentFontSize < 36:\n          updatedFontSize += 4;\n          break;\n        case currentFontSize <= 60:\n          updatedFontSize += 12;\n          break;\n        default:\n          updatedFontSize = MAX_ALLOWED_FONT_SIZE;\n          break;\n      }\n      break;\n\n    default:\n      break;\n  }\n  return updatedFontSize;\n};\n\n/**\n * Patches the selection with the updated font size.\n */\nexport const updateFontSizeInSelection = (\n  editor: LexicalEditor,\n  newFontSize: string | null,\n  updateType: UpdateFontSizeType | null,\n  skipRefocus: boolean\n) => {\n  const getNextFontSize = (prevFontSize: string | null): string => {\n    if (!prevFontSize) {\n      prevFontSize = `${DEFAULT_FONT_SIZE}px`;\n    }\n    prevFontSize = prevFontSize.slice(0, -2);\n    const nextFontSize = calculateNextFontSize(Number(prevFontSize), updateType);\n    return `${nextFontSize}px`;\n  };\n\n  editor.update(() => {\n    if (skipRefocus) {\n      $addUpdateTag(SKIP_DOM_SELECTION_TAG);\n    }\n    if (editor.isEditable()) {\n      const selection = $getSelection();\n      if (selection !== null) {\n        $patchStyleText(selection, {\n          \"font-size\": newFontSize || getNextFontSize,\n        });\n      }\n    }\n  });\n};\n\nexport const updateFontSize = (\n  editor: LexicalEditor,\n  updateType: UpdateFontSizeType,\n  inputValue: string,\n  skipRefocus: boolean = false\n) => {\n  if (inputValue !== \"\") {\n    const nextFontSize = calculateNextFontSize(Number(inputValue), updateType);\n    updateFontSizeInSelection(editor, String(nextFontSize) + \"px\", null, skipRefocus);\n  } else {\n    updateFontSizeInSelection(editor, null, updateType, skipRefocus);\n  }\n};\n\nexport const formatParagraph = (editor: LexicalEditor) => {\n  editor.update(() => {\n    $addUpdateTag(SKIP_SELECTION_FOCUS_TAG);\n    const selection = $getSelection();\n    $setBlocksType(selection, () => $createParagraphNode());\n  });\n};\n\nexport const formatHeading = (\n  editor: LexicalEditor,\n  blockType: string,\n  headingSize: HeadingTagType\n) => {\n  if (blockType !== headingSize) {\n    editor.update(() => {\n      $addUpdateTag(SKIP_SELECTION_FOCUS_TAG);\n      const selection = $getSelection();\n      $setBlocksType(selection, () => $createHeadingNode(headingSize));\n    });\n  }\n};\n\nexport const formatBulletList = (editor: LexicalEditor, blockType: string) => {\n  if (blockType !== \"bullet\") {\n    editor.update(() => {\n      $addUpdateTag(SKIP_SELECTION_FOCUS_TAG);\n      editor.dispatchCommand(INSERT_UNORDERED_LIST_COMMAND, undefined);\n    });\n  } else {\n    formatParagraph(editor);\n  }\n};\n\nexport const formatCheckList = (editor: LexicalEditor, blockType: string) => {\n  if (blockType !== \"check\") {\n    editor.update(() => {\n      $addUpdateTag(SKIP_SELECTION_FOCUS_TAG);\n      editor.dispatchCommand(INSERT_CHECK_LIST_COMMAND, undefined);\n    });\n  } else {\n    formatParagraph(editor);\n  }\n};\n\nexport const formatNumberedList = (editor: LexicalEditor, blockType: string) => {\n  if (blockType !== \"number\") {\n    editor.update(() => {\n      $addUpdateTag(SKIP_SELECTION_FOCUS_TAG);\n      editor.dispatchCommand(INSERT_ORDERED_LIST_COMMAND, undefined);\n    });\n  } else {\n    formatParagraph(editor);\n  }\n};\n\nexport const formatQuote = (editor: LexicalEditor, blockType: string) => {\n  if (blockType !== \"quote\") {\n    editor.update(() => {\n      $addUpdateTag(SKIP_SELECTION_FOCUS_TAG);\n      const selection = $getSelection();\n      $setBlocksType(selection, () => $createQuoteNode());\n    });\n  }\n};\n\nexport const formatCode = (editor: LexicalEditor, blockType: string) => {\n  if (blockType !== \"code\") {\n    editor.update(() => {\n      $addUpdateTag(SKIP_SELECTION_FOCUS_TAG);\n      let selection = $getSelection();\n      if (!selection) {\n        return;\n      }\n      if (!$isRangeSelection(selection) || selection.isCollapsed()) {\n        $setBlocksType(selection, () => $createCodeNode());\n      } else {\n        const textContent = selection.getTextContent();\n        const codeNode = $createCodeNode();\n        selection.insertNodes([codeNode]);\n        selection = $getSelection();\n        if ($isRangeSelection(selection)) {\n          selection.insertRawText(textContent);\n        }\n      }\n    });\n  }\n};\n\nexport const clearFormatting = (editor: LexicalEditor, skipRefocus: boolean = false) => {\n  editor.update(() => {\n    if (skipRefocus) {\n      $addUpdateTag(SKIP_DOM_SELECTION_TAG);\n    }\n    const selection = $getSelection();\n    if ($isRangeSelection(selection) || $isTableSelection(selection)) {\n      const anchor = selection.anchor;\n      const focus = selection.focus;\n      const nodes = selection.getNodes();\n      const extractedNodes = selection.extract();\n\n      if (anchor.key === focus.key && anchor.offset === focus.offset) {\n        return;\n      }\n\n      nodes.forEach((node, idx) => {\n        // We split the first and last node by the selection\n        // So that we don't format unselected text inside those nodes\n        if ($isTextNode(node)) {\n          // Use a separate variable to ensure TS does not lose the refinement\n          let textNode = node;\n          if (idx === 0 && anchor.offset !== 0) {\n            textNode = textNode.splitText(anchor.offset)[1] || textNode;\n          }\n          if (idx === nodes.length - 1) {\n            textNode = textNode.splitText(focus.offset)[0] || textNode;\n          }\n          /**\n           * If the selected text has one format applied\n           * selecting a portion of the text, could\n           * clear the format to the wrong portion of the text.\n           *\n           * The cleared text is based on the length of the selected text.\n           */\n          // We need this in case the selected text only has one format\n          const extractedTextNode = extractedNodes[0];\n          if (nodes.length === 1 && $isTextNode(extractedTextNode)) {\n            textNode = extractedTextNode;\n          }\n\n          if (textNode.__style !== \"\") {\n            textNode.setStyle(\"\");\n          }\n          if (textNode.__format !== 0) {\n            textNode.setFormat(0);\n          }\n          const nearestBlockElement = $getNearestBlockElementAncestorOrThrow(textNode);\n          if (nearestBlockElement.__format !== 0) {\n            nearestBlockElement.setFormat(\"\");\n          }\n          if (nearestBlockElement.__indent !== 0) {\n            nearestBlockElement.setIndent(0);\n          }\n          node = textNode;\n        } else if ($isHeadingNode(node) || $isQuoteNode(node)) {\n          node.replace($createParagraphNode(), true);\n        } else if ($isDecoratorBlockNode(node)) {\n          node.setFormat(\"\");\n        }\n      });\n    }\n  });\n};\n","import \"./LoadingLayer.css\";\n\nexport default function LoadingLayer() {\n  return (\n    <div className=\"loading-overlay\">\n      <div className=\"loading-content\">\n        <div className=\"spinner\"></div>\n        <p className=\"loading-text\">Loading...</p>\n      </div>\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { Klass, LexicalNode } from \"lexical\";\n\nimport { AutoLinkNode, LinkNode } from \"@lexical/link\";\nimport { ListItemNode, ListNode } from \"@lexical/list\";\nimport { MarkNode } from \"@lexical/mark\";\nimport { OverflowNode } from \"@lexical/overflow\";\nimport { HeadingNode, QuoteNode } from \"@lexical/rich-text\";\nimport { TableCellNode, TableNode, TableRowNode } from \"@lexical/table\";\n\nimport { ImageNode } from \"./ImageNode\";\nimport { KeywordNode } from \"./KeywordNode\";\nimport { LayoutContainerNode } from \"./LayoutContainerNode\";\nimport { LayoutItemNode } from \"./LayoutItemNode\";\n\nconst PlaygroundNodes: Array<Klass<LexicalNode>> = [\n  HeadingNode,\n  ListNode,\n  ListItemNode,\n  QuoteNode,\n  TableNode,\n  TableCellNode,\n  TableRowNode,\n  AutoLinkNode,\n  LinkNode,\n  OverflowNode,\n  ImageNode,\n  KeywordNode,\n  MarkNode,\n  LayoutContainerNode,\n  LayoutItemNode,\n];\n\nexport default PlaygroundNodes;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nconst mod = await (process.env.NODE_ENV !== 'production' ? import('./LexicalMark.dev.mjs') : import('./LexicalMark.prod.mjs'));\nexport const $createMarkNode = mod.$createMarkNode;\nexport const $getMarkIDs = mod.$getMarkIDs;\nexport const $isMarkNode = mod.$isMarkNode;\nexport const $unwrapMarkNode = mod.$unwrapMarkNode;\nexport const $wrapSelectionInMarkNode = mod.$wrapSelectionInMarkNode;\nexport const MarkExtension = mod.MarkExtension;\nexport const MarkNode = mod.MarkNode;","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nconst mod = await (process.env.NODE_ENV !== 'production' ? import('./LexicalOverflow.dev.mjs') : import('./LexicalOverflow.prod.mjs'));\nexport const $createOverflowNode = mod.$createOverflowNode;\nexport const $isOverflowNode = mod.$isOverflowNode;\nexport const OverflowExtension = mod.OverflowExtension;\nexport const OverflowNode = mod.OverflowNode;","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { EditorThemeClasses } from \"lexical\";\n\nimport \"./PlaygroundEditorTheme.css\";\n\nconst theme: EditorThemeClasses = {\n  autocomplete: \"PlaygroundEditorTheme__autocomplete\",\n  blockCursor: \"PlaygroundEditorTheme__blockCursor\",\n  characterLimit: \"PlaygroundEditorTheme__characterLimit\",\n  code: \"PlaygroundEditorTheme__code\",\n  codeHighlight: {\n    atrule: \"PlaygroundEditorTheme__tokenAttr\",\n    attr: \"PlaygroundEditorTheme__tokenAttr\",\n    boolean: \"PlaygroundEditorTheme__tokenProperty\",\n    builtin: \"PlaygroundEditorTheme__tokenSelector\",\n    cdata: \"PlaygroundEditorTheme__tokenComment\",\n    char: \"PlaygroundEditorTheme__tokenSelector\",\n    class: \"PlaygroundEditorTheme__tokenFunction\",\n    \"class-name\": \"PlaygroundEditorTheme__tokenFunction\",\n    comment: \"PlaygroundEditorTheme__tokenComment\",\n    constant: \"PlaygroundEditorTheme__tokenProperty\",\n    deleted: \"PlaygroundEditorTheme__tokenDeleted\",\n    doctype: \"PlaygroundEditorTheme__tokenComment\",\n    entity: \"PlaygroundEditorTheme__tokenOperator\",\n    function: \"PlaygroundEditorTheme__tokenFunction\",\n    important: \"PlaygroundEditorTheme__tokenVariable\",\n    inserted: \"PlaygroundEditorTheme__tokenInserted\",\n    keyword: \"PlaygroundEditorTheme__tokenAttr\",\n    namespace: \"PlaygroundEditorTheme__tokenVariable\",\n    number: \"PlaygroundEditorTheme__tokenProperty\",\n    operator: \"PlaygroundEditorTheme__tokenOperator\",\n    prolog: \"PlaygroundEditorTheme__tokenComment\",\n    property: \"PlaygroundEditorTheme__tokenProperty\",\n    punctuation: \"PlaygroundEditorTheme__tokenPunctuation\",\n    regex: \"PlaygroundEditorTheme__tokenVariable\",\n    selector: \"PlaygroundEditorTheme__tokenSelector\",\n    string: \"PlaygroundEditorTheme__tokenSelector\",\n    symbol: \"PlaygroundEditorTheme__tokenProperty\",\n    tag: \"PlaygroundEditorTheme__tokenProperty\",\n    unchanged: \"PlaygroundEditorTheme__tokenUnchanged\",\n    url: \"PlaygroundEditorTheme__tokenOperator\",\n    variable: \"PlaygroundEditorTheme__tokenVariable\",\n  },\n  embedBlock: {\n    base: \"PlaygroundEditorTheme__embedBlock\",\n    focus: \"PlaygroundEditorTheme__embedBlockFocus\",\n  },\n  hashtag: \"PlaygroundEditorTheme__hashtag\",\n  heading: {\n    h1: \"PlaygroundEditorTheme__h1\",\n    h2: \"PlaygroundEditorTheme__h2\",\n    h3: \"PlaygroundEditorTheme__h3\",\n    h4: \"PlaygroundEditorTheme__h4\",\n    h5: \"PlaygroundEditorTheme__h5\",\n    h6: \"PlaygroundEditorTheme__h6\",\n  },\n  hr: \"PlaygroundEditorTheme__hr\",\n  hrSelected: \"PlaygroundEditorTheme__hrSelected\",\n  image: \"editor-image\",\n  indent: \"PlaygroundEditorTheme__indent\",\n  layoutContainer: \"PlaygroundEditorTheme__layoutContainer\",\n  layoutItem: \"PlaygroundEditorTheme__layoutItem\",\n  link: \"PlaygroundEditorTheme__link\",\n  list: {\n    checklist: \"PlaygroundEditorTheme__checklist\",\n    listitem: \"PlaygroundEditorTheme__listItem\",\n    listitemChecked: \"PlaygroundEditorTheme__listItemChecked\",\n    listitemUnchecked: \"PlaygroundEditorTheme__listItemUnchecked\",\n    nested: {\n      listitem: \"PlaygroundEditorTheme__nestedListItem\",\n    },\n    olDepth: [\n      \"PlaygroundEditorTheme__ol1\",\n      \"PlaygroundEditorTheme__ol2\",\n      \"PlaygroundEditorTheme__ol3\",\n      \"PlaygroundEditorTheme__ol4\",\n      \"PlaygroundEditorTheme__ol5\",\n    ],\n    ul: \"PlaygroundEditorTheme__ul\",\n  },\n  mark: \"PlaygroundEditorTheme__mark\",\n  markOverlap: \"PlaygroundEditorTheme__markOverlap\",\n  paragraph: \"PlaygroundEditorTheme__paragraph\",\n  quote: \"PlaygroundEditorTheme__quote\",\n  specialText: \"PlaygroundEditorTheme__specialText\",\n  tab: \"PlaygroundEditorTheme__tabNode\",\n  table: \"PlaygroundEditorTheme__table\",\n  tableAddColumns: \"PlaygroundEditorTheme__tableAddColumns\",\n  tableAddRows: \"PlaygroundEditorTheme__tableAddRows\",\n  tableAlignment: {\n    center: \"PlaygroundEditorTheme__tableAlignmentCenter\",\n    right: \"PlaygroundEditorTheme__tableAlignmentRight\",\n  },\n  tableCell: \"PlaygroundEditorTheme__tableCell\",\n  tableCellActionButton: \"PlaygroundEditorTheme__tableCellActionButton\",\n  tableCellActionButtonContainer: \"PlaygroundEditorTheme__tableCellActionButtonContainer\",\n  tableCellHeader: \"PlaygroundEditorTheme__tableCellHeader\",\n  tableCellResizer: \"PlaygroundEditorTheme__tableCellResizer\",\n  tableCellSelected: \"PlaygroundEditorTheme__tableCellSelected\",\n  tableFrozenColumn: \"PlaygroundEditorTheme__tableFrozenColumn\",\n  tableFrozenRow: \"PlaygroundEditorTheme__tableFrozenRow\",\n  tableRowStriping: \"PlaygroundEditorTheme__tableRowStriping\",\n  tableScrollableWrapper: \"PlaygroundEditorTheme__tableScrollableWrapper\",\n  tableSelected: \"PlaygroundEditorTheme__tableSelected\",\n  tableSelection: \"PlaygroundEditorTheme__tableSelection\",\n  text: {\n    bold: \"PlaygroundEditorTheme__textBold\",\n    capitalize: \"PlaygroundEditorTheme__textCapitalize\",\n    code: \"PlaygroundEditorTheme__textCode\",\n    highlight: \"PlaygroundEditorTheme__textHighlight\",\n    italic: \"PlaygroundEditorTheme__textItalic\",\n    lowercase: \"PlaygroundEditorTheme__textLowercase\",\n    strikethrough: \"PlaygroundEditorTheme__textStrikethrough\",\n    subscript: \"PlaygroundEditorTheme__textSubscript\",\n    superscript: \"PlaygroundEditorTheme__textSuperscript\",\n    underline: \"PlaygroundEditorTheme__textUnderline\",\n    underlineStrikethrough: \"PlaygroundEditorTheme__textUnderlineStrikethrough\",\n    uppercase: \"PlaygroundEditorTheme__textUppercase\",\n  },\n};\n\nexport default theme;\n"],"mappings":"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","names":["createContext","useCallback","useContext","useMemo","useState","jsx","Context","createContext","useState","useCallback","useMemo","jsx","useContext","useState","useLexicalComposerContext","COMMAND_PRIORITY_LOW","DRAGOVER_COMMAND","DROP_COMMAND","useEffect","useEffect","useState","jsx","jsx","jsx","jsx","jsxs","jsx","jsxs","useState","useEffect","useLexicalComposerContext","useEffect","DRAGOVER_COMMAND","COMMAND_PRIORITY_LOW","DROP_COMMAND","$isAutoLinkNode","$isLinkNode","TOGGLE_LINK_COMMAND","useLexicalComposerContext","$findMatchingParent","mergeRegister","$getSelection","$isNodeSelection","COMMAND_PRIORITY_HIGH","COMMAND_PRIORITY_LOW","useCallback","useEffect","useRef","useState","Fragment","jsx","jsxs","useRef","useState","useCallback","$getSelection","$findMatchingParent","$isLinkNode","$isNodeSelection","useEffect","mergeRegister","COMMAND_PRIORITY_LOW","COMMAND_PRIORITY_HIGH","TOGGLE_LINK_COMMAND","$isAutoLinkNode","useLexicalComposerContext","useLexicalComposerContext","useEffect","useState","useLexicalComposerContext","useState","useEffect","useLexicalComposerContext","mergeRegister","$getSelection","$isRangeSelection","$setSelection","COMMAND_PRIORITY_CRITICAL","getDOMSelection","isDOMNode","SELECTION_CHANGE_COMMAND","useCallback","useEffect","useRef","useState","createPortal","React","useCallback","useEffect","useMemo","useRef","useState","createPortal","Fragment","jsx","jsxs","useRef","useEffect","useState","useCallback","useMemo","createPortal","useCallback","useMemo","useState","isDOMNode","useEffect","useRef","createPortal","jsx","jsxs","jsx","useState","useCallback","useMemo","useMemo","useRef","useState","jsx","jsxs","useState","useRef","useMemo","jsxs","jsx","Fragment","jsx","jsxs","$getSelection","$isRangeSelection","useLexicalComposerContext","useRef","useState","useEffect","isDOMNode","useCallback","$setSelection","createPortal","getDOMSelection","mergeRegister","SELECTION_CHANGE_COMMAND","COMMAND_PRIORITY_CRITICAL","useLexicalComposerContext","useLexicalEditable","$computeTableMapSkipCellCheck","$getTableNodeFromLexicalNodeOrThrow","$getTableRowIndexFromTableCellNode","$isTableCellNode","getTableElement","calculateZoomLevel","mergeRegister","isHTMLElement","useCallback","useEffect","useMemo","useRef","useState","createPortal","Fragment","jsx","jsxs","$isLinkNode","TOGGLE_LINK_COMMAND","$isHeadingNode","$patchStyleText","$isTableSelection","$findMatchingParent","mergeRegister","$addUpdateTag","$getSelection","$isElementNode","$isNodeSelection","$isRangeSelection","$isRootOrShadowRoot","COMMAND_PRIORITY_CRITICAL","SELECTION_CHANGE_COMMAND","SKIP_DOM_SELECTION_TAG","SKIP_SELECTION_FOCUS_TAG","useCallback","useEffect","useState","jsx","useState","useLexicalComposerContext","$findMatchingParent","mergeRegister","$createParagraphNode","$getSelection","$isRangeSelection","COMMAND_PRIORITY_EDITOR","COMMAND_PRIORITY_LOW","createCommand","useEffect","addClassNamesToElement","ElementNode","createCommand","Fragment","jsx","jsxs","useState","useLexicalComposerContext","TableCellNode","TableNode","createContext","useContext","useEffect","useMemo","useState","Fragment","jsx","jsxs","createContext","useState","useMemo","useEffect","React","$isTableSelection","$createParagraphNode","$getSelection","$isRangeSelection","$isTextNode","$getSelection","$createParagraphNode","$getSelection","$getSelection","$isRangeSelection","$isTableSelection","$isTextNode","$createParagraphNode","Fragment","jsx","jsxs","jsxs","Fragment","jsx","useLexicalComposerContext","Fragment","jsx","jsxs","jsxs","jsx","useCallback","$addUpdateTag","SKIP_SELECTION_FOCUS_TAG","$getSelection","$patchStyleText","$findMatchingParent","$isRootOrShadowRoot","useLexicalComposerContext","useState","SKIP_DOM_SELECTION_TAG","$isHeadingNode","$isRangeSelection","$isLinkNode","$isElementNode","$isTableSelection","$isNodeSelection","useEffect","SELECTION_CHANGE_COMMAND","COMMAND_PRIORITY_CRITICAL","mergeRegister","TOGGLE_LINK_COMMAND","Fragment","jsx","jsxs","Fragment","jsx","jsxs","useState","LinkNode","ListNode","mod","mod","TableCellNode","TableNode","TableRowNode","ListNode","TableNode","TableCellNode","TableRowNode","LinkNode","jsx"]}