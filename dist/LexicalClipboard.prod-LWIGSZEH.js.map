{"version":3,"sources":["../node_modules/@lexical/clipboard/LexicalClipboard.prod.mjs"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{$generateHtmlFromNodes as t,$generateNodesFromDOM as e}from\"@lexical/html\";import{$addNodeStyle as n,$sliceSelectedTextNodeContent as o}from\"@lexical/selection\";import{objectKlassEquals as r}from\"@lexical/utils\";import{$getSelection as i,$isRangeSelection as l,$createTabNode as s,SELECTION_INSERT_CLIPBOARD_NODES_COMMAND as c,$caretFromPoint as a,$isTextPointCaret as u,$getCaretRange as f,$getChildCaret as d,$getRoot as p,$isTextNode as g,$isElementNode as m,$parseSerializedNode as h,getDOMSelection as x,COPY_COMMAND as y,COMMAND_PRIORITY_CRITICAL as w,isSelectionWithinEditor as T,$getEditor as C}from\"lexical\";function v(t,...e){const n=new URL(\"https://lexical.dev/docs/error\"),o=new URLSearchParams;o.append(\"code\",t);for(const t of e)o.append(\"v\",t);throw n.search=o.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function D(e,n=i()){return null==n&&v(166),l(n)&&n.isCollapsed()||0===n.getNodes().length?\"\":t(e,n)}function S(t,e=i()){return null==e&&v(166),l(e)&&e.isCollapsed()||0===e.getNodes().length?null:JSON.stringify(E(t,e))}function N(t,e){const n=t.getData(\"text/plain\")||t.getData(\"text/uri-list\");null!=n&&e.insertRawText(n)}function R(t,n,o){const r=t.getData(\"application/x-lexical-editor\");if(r)try{const t=JSON.parse(r);if(t.namespace===o._config.namespace&&Array.isArray(t.nodes)){return A(o,L(t.nodes),n)}}catch(t){console.error(t)}const c=t.getData(\"text/html\"),a=t.getData(\"text/plain\");if(c&&a!==c)try{const t=(new DOMParser).parseFromString(function(t){if(window.trustedTypes&&window.trustedTypes.createPolicy){return window.trustedTypes.createPolicy(\"lexical\",{createHTML:t=>t}).createHTML(t)}return t}(c),\"text/html\");return A(o,e(o,t),n)}catch(t){console.error(t)}const u=a||t.getData(\"text/uri-list\");if(null!=u)if(l(n)){const t=u.split(/(\\r?\\n|\\t)/);\"\"===t[t.length-1]&&t.pop();for(let e=0;e<t.length;e++){const n=i();if(l(n)){const o=t[e];\"\\n\"===o||\"\\r\\n\"===o?n.insertParagraph():\"\\t\"===o?n.insertNodes([s()]):n.insertText(o)}}}else n.insertRawText(u)}function A(t,e,n){t.dispatchCommand(c,{nodes:e,selection:n})||(n.insertNodes(e),function(t){if(l(t)&&t.isCollapsed()){const e=t.anchor;let n=null;const o=a(e,\"previous\");if(o)if(u(o))n=o.origin;else{const t=f(o,d(p(),\"next\").getFlipped());for(const e of t){if(g(e.origin)){n=e.origin;break}if(m(e.origin)&&!e.origin.isInline())break}}if(n&&g(n)){const e=n.getFormat(),o=n.getStyle();t.format===e&&t.style===o||(t.format=e,t.style=o,t.dirty=!0)}}}(n))}function P(t,e,n,r=[]){let i=null===e||n.isSelected(e);const l=m(n)&&n.excludeFromCopy(\"html\");let s=n;null!==e&&g(s)&&(s=o(e,s,\"clone\"));const c=m(s)?s.getChildren():[],a=function(t){const e=t.exportJSON(),n=t.constructor;if(e.type!==n.getType()&&v(58,n.name),m(t)){const t=e.children;Array.isArray(t)||v(59,n.name)}return e}(s);g(s)&&0===s.getTextContentSize()&&(i=!1);for(let o=0;o<c.length;o++){const r=c[o],l=P(t,e,r,a.children);!i&&m(n)&&l&&n.extractWithChild(r,e,\"clone\")&&(i=!0)}if(i&&!l)r.push(a);else if(Array.isArray(a.children))for(let t=0;t<a.children.length;t++){const e=a.children[t];r.push(e)}return i}function E(t,e){const n=[],o=p().getChildren();for(let r=0;r<o.length;r++){P(t,e,o[r],n)}return{namespace:t._config.namespace,nodes:n}}function L(t){const e=[];for(let o=0;o<t.length;o++){const r=t[o],i=h(r);g(i)&&n(i),e.push(i)}return e}let b=null;async function F(t,e,n){if(null!==b)return!1;if(null!==e)return new Promise((o,r)=>{t.update(()=>{o(M(t,e,n))})});const o=t.getRootElement(),i=t._window||window,l=i.document,s=x(i);if(null===o||null===s)return!1;const c=l.createElement(\"span\");c.style.cssText=\"position: fixed; top: -1000px;\",c.append(l.createTextNode(\"#\")),o.append(c);const a=new Range;return a.setStart(c,0),a.setEnd(c,1),s.removeAllRanges(),s.addRange(a),new Promise((e,o)=>{const s=t.registerCommand(y,o=>(r(o,ClipboardEvent)&&(s(),null!==b&&(i.clearTimeout(b),b=null),e(M(t,o,n))),!0),w);b=i.setTimeout(()=>{s(),b=null,e(!1)},50),l.execCommand(\"copy\"),c.remove()})}function M(t,e,n){if(void 0===n){const e=x(t._window),o=i();if(!o||o.isCollapsed())return!1;if(!e)return!1;const r=e.anchorNode,l=e.focusNode;if(null!==r&&null!==l&&!T(t,r,l))return!1;n=_(o)}e.preventDefault();const o=e.clipboardData;return null!==o&&(J(o,n),!0)}const O=[[\"text/html\",D],[\"application/x-lexical-editor\",S]];function _(t=i()){const e={\"text/plain\":t?t.getTextContent():\"\"};if(t){const n=C();for(const[o,r]of O){const i=r(n,t);null!==i&&(e[o]=i)}}return e}function J(t,e){for(const[n]of O)void 0===e[n]&&t.setData(n,\"\");for(const n in e){const o=e[n];void 0!==o&&t.setData(n,o)}}export{E as $generateJSONFromSelectedNodes,L as $generateNodesFromSerializedNodes,_ as $getClipboardDataFromSelection,D as $getHtmlContent,S as $getLexicalContent,N as $insertDataTransferForPlainText,R as $insertDataTransferForRichText,A as $insertGeneratedNodes,F as copyToClipboard,J as setLexicalClipboardDataTransfer};\n"],"mappings":"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","names":["t","e","n","o","r","c","a","u","i","l","s"]}